{"version":3,"file":"3a1a7810-e71b70204c44cb709e85.js","mappings":"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","sources":["webpack://@react-babylonjs/docs/../../node_modules/@babylonjs/core/Engines/thinEngine.js"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-unused-vars */\nimport { EngineStore } from \"./engineStore.js\";\nimport { Effect } from \"../Materials/effect.js\";\nimport { _WarnImport } from \"../Misc/devTools.js\";\nimport { Observable } from \"../Misc/observable.js\";\nimport { DepthCullingState } from \"../States/depthCullingState.js\";\nimport { StencilState } from \"../States/stencilState.js\";\nimport { AlphaState } from \"../States/alphaCullingState.js\";\nimport { InternalTexture, InternalTextureSource } from \"../Materials/Textures/internalTexture.js\";\nimport { Logger } from \"../Misc/logger.js\";\nimport { IsDocumentAvailable, IsWindowObjectExist } from \"../Misc/domManagement.js\";\nimport { WebGLShaderProcessor } from \"./WebGL/webGLShaderProcessors.js\";\nimport { WebGL2ShaderProcessor } from \"./WebGL/webGL2ShaderProcessors.js\";\nimport { WebGLDataBuffer } from \"../Meshes/WebGL/webGLDataBuffer.js\";\nimport { WebGLPipelineContext } from \"./WebGL/webGLPipelineContext.js\";\nimport { PerformanceConfigurator } from \"./performanceConfigurator.js\";\nimport { WebGLHardwareTexture } from \"./WebGL/webGLHardwareTexture.js\";\nimport { DrawWrapper } from \"../Materials/drawWrapper.js\";\nimport { StencilStateComposer } from \"../States/stencilStateComposer.js\";\nimport { ShaderLanguage } from \"../Materials/shaderLanguage.js\";\nimport { PrecisionDate } from \"../Misc/precisionDate.js\";\n/**\n * Keeps track of all the buffer info used in engine.\n */\nclass BufferPointer {}\n/**\n * The base engine class (root of all engines)\n */\nexport class ThinEngine {\n  /**\n   * Returns the current npm package of the sdk\n   */\n  // Not mixed with Version for tooling purpose.\n  static get NpmPackage() {\n    return \"babylonjs@6.25.0\";\n  }\n  /**\n   * Returns the current version of the framework\n   */\n  static get Version() {\n    return \"6.25.0\";\n  }\n  /**\n   * Returns a string describing the current engine\n   */\n  get description() {\n    let description = this.name + this.webGLVersion;\n    if (this._caps.parallelShaderCompile) {\n      description += \" - Parallel shader compilation\";\n    }\n    return description;\n  }\n  /**\n   * Gets or sets the name of the engine\n   */\n  get name() {\n    return this._name;\n  }\n  set name(value) {\n    this._name = value;\n  }\n  /**\n   * Returns the version of the engine\n   */\n  get version() {\n    return this._webGLVersion;\n  }\n  get isDisposed() {\n    return this._isDisposed;\n  }\n  /**\n   * Gets or sets the relative url used to load shaders if using the engine in non-minified mode\n   */\n  static get ShadersRepository() {\n    return Effect.ShadersRepository;\n  }\n  static set ShadersRepository(value) {\n    Effect.ShadersRepository = value;\n  }\n  /**\n   * @internal\n   */\n  _getShaderProcessor(shaderLanguage) {\n    return this._shaderProcessor;\n  }\n  /**\n   * Gets or sets a boolean indicating if depth buffer should be reverse, going from far to near.\n   * This can provide greater z depth for distant objects.\n   */\n  get useReverseDepthBuffer() {\n    return this._useReverseDepthBuffer;\n  }\n  set useReverseDepthBuffer(useReverse) {\n    if (useReverse === this._useReverseDepthBuffer) {\n      return;\n    }\n    this._useReverseDepthBuffer = useReverse;\n    if (useReverse) {\n      this._depthCullingState.depthFunc = 518;\n    } else {\n      this._depthCullingState.depthFunc = 515;\n    }\n  }\n  /**\n   * Gets the current frame id\n   */\n  get frameId() {\n    return this._frameId;\n  }\n  /**\n   * Gets a boolean indicating that the engine supports uniform buffers\n   * @see https://doc.babylonjs.com/setup/support/webGL2#uniform-buffer-objets\n   */\n  get supportsUniformBuffers() {\n    return this.webGLVersion > 1 && !this.disableUniformBuffers;\n  }\n  /**\n   * Gets the options used for engine creation\n   * @returns EngineOptions object\n   */\n  getCreationOptions() {\n    return this._creationOptions;\n  }\n  /** @internal */\n  get _shouldUseHighPrecisionShader() {\n    return !!(this._caps.highPrecisionShaderSupported && this._highPrecisionShadersAllowed);\n  }\n  /**\n   * Gets a boolean indicating that only power of 2 textures are supported\n   * Please note that you can still use non power of 2 textures but in this case the engine will forcefully convert them\n   */\n  get needPOTTextures() {\n    return this._webGLVersion < 2 || this.forcePOTTextures;\n  }\n  /**\n   * Gets the list of current active render loop functions\n   * @returns an array with the current render loop functions\n   */\n  get activeRenderLoops() {\n    return this._activeRenderLoops;\n  }\n  /**\n   * Gets or sets a boolean indicating if resources should be retained to be able to handle context lost events\n   * @see https://doc.babylonjs.com/features/featuresDeepDive/scene/optimize_your_scene#handling-webgl-context-lost\n   */\n  get doNotHandleContextLost() {\n    return this._doNotHandleContextLost;\n  }\n  set doNotHandleContextLost(value) {\n    this._doNotHandleContextLost = value;\n  }\n  get _supportsHardwareTextureRescaling() {\n    return false;\n  }\n  /**\n   * sets the object from which width and height will be taken from when getting render width and height\n   * Will fallback to the gl object\n   * @param dimensions the framebuffer width and height that will be used.\n   */\n  set framebufferDimensionsObject(dimensions) {\n    this._framebufferDimensionsObject = dimensions;\n  }\n  /**\n   * Gets the current viewport\n   */\n  get currentViewport() {\n    return this._cachedViewport;\n  }\n  /**\n   * Gets the default empty texture\n   */\n  get emptyTexture() {\n    if (!this._emptyTexture) {\n      this._emptyTexture = this.createRawTexture(new Uint8Array(4), 1, 1, 5, false, false, 1);\n    }\n    return this._emptyTexture;\n  }\n  /**\n   * Gets the default empty 3D texture\n   */\n  get emptyTexture3D() {\n    if (!this._emptyTexture3D) {\n      this._emptyTexture3D = this.createRawTexture3D(new Uint8Array(4), 1, 1, 1, 5, false, false, 1);\n    }\n    return this._emptyTexture3D;\n  }\n  /**\n   * Gets the default empty 2D array texture\n   */\n  get emptyTexture2DArray() {\n    if (!this._emptyTexture2DArray) {\n      this._emptyTexture2DArray = this.createRawTexture2DArray(new Uint8Array(4), 1, 1, 1, 5, false, false, 1);\n    }\n    return this._emptyTexture2DArray;\n  }\n  /**\n   * Gets the default empty cube texture\n   */\n  get emptyCubeTexture() {\n    if (!this._emptyCubeTexture) {\n      const faceData = new Uint8Array(4);\n      const cubeData = [faceData, faceData, faceData, faceData, faceData, faceData];\n      this._emptyCubeTexture = this.createRawCubeTexture(cubeData, 1, 5, 0, false, false, 1);\n    }\n    return this._emptyCubeTexture;\n  }\n  /**\n   * Gets a boolean indicating if the engine runs in WebGPU or not.\n   */\n  get isWebGPU() {\n    return this._isWebGPU;\n  }\n  /**\n   * Gets the shader platform name used by the effects.\n   */\n  get shaderPlatformName() {\n    return this._shaderPlatformName;\n  }\n  /**\n   * Enables or disables the snapshot rendering mode\n   * Note that the WebGL engine does not support snapshot rendering so setting the value won't have any effect for this engine\n   */\n  get snapshotRendering() {\n    return false;\n  }\n  set snapshotRendering(activate) {\n    // WebGL engine does not support snapshot rendering\n  }\n  /**\n   * Gets or sets the snapshot rendering mode\n   */\n  get snapshotRenderingMode() {\n    return this._snapshotRenderingMode;\n  }\n  set snapshotRenderingMode(mode) {\n    this._snapshotRenderingMode = mode;\n  }\n  /**\n   * Creates a new snapshot at the next frame using the current snapshotRenderingMode\n   */\n  snapshotRenderingReset() {\n    this.snapshotRendering = false;\n  }\n  static _CreateCanvas(width, height) {\n    if (typeof document === \"undefined\") {\n      return new OffscreenCanvas(width, height);\n    }\n    const canvas = document.createElement(\"canvas\");\n    canvas.width = width;\n    canvas.height = height;\n    return canvas;\n  }\n  /**\n   * Create a canvas. This method is overridden by other engines\n   * @param width width\n   * @param height height\n   * @returns ICanvas interface\n   */\n  createCanvas(width, height) {\n    return ThinEngine._CreateCanvas(width, height);\n  }\n  /**\n   * Create an image to use with canvas\n   * @returns IImage interface\n   */\n  createCanvasImage() {\n    return document.createElement(\"img\");\n  }\n  /**\n   * Creates a new engine\n   * @param canvasOrContext defines the canvas or WebGL context to use for rendering. If you provide a WebGL context, Babylon.js will not hook events on the canvas (like pointers, keyboards, etc...) so no event observables will be available. This is mostly used when Babylon.js is used as a plugin on a system which already used the WebGL context\n   * @param antialias defines enable antialiasing (default: false)\n   * @param options defines further options to be sent to the getContext() function\n   * @param adaptToDeviceRatio defines whether to adapt to the device's viewport characteristics (default: false)\n   */\n  constructor(canvasOrContext, antialias, options, adaptToDeviceRatio) {\n    var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l;\n    /** @internal */\n    this._name = \"WebGL\";\n    this._isDisposed = false;\n    /**\n     * Gets or sets a boolean that indicates if textures must be forced to power of 2 size even if not required\n     */\n    this.forcePOTTextures = false;\n    /**\n     * Gets a boolean indicating if the engine is currently rendering in fullscreen mode\n     */\n    this.isFullscreen = false;\n    /**\n     * Gets or sets a boolean indicating if back faces must be culled. If false, front faces are culled instead (true by default)\n     * If non null, this takes precedence over the value from the material\n     */\n    this.cullBackFaces = null;\n    /**\n     * Gets or sets a boolean indicating if the engine must keep rendering even if the window is not in foreground\n     */\n    this.renderEvenInBackground = true;\n    /**\n     * Gets or sets a boolean indicating that cache can be kept between frames\n     */\n    this.preventCacheWipeBetweenFrames = false;\n    /** Gets or sets a boolean indicating if the engine should validate programs after compilation */\n    this.validateShaderPrograms = false;\n    this._useReverseDepthBuffer = false;\n    /**\n     * Indicates if the z range in NDC space is 0..1 (value: true) or -1..1 (value: false)\n     */\n    this.isNDCHalfZRange = false;\n    /**\n     * Indicates that the origin of the texture/framebuffer space is the bottom left corner. If false, the origin is top left\n     */\n    this.hasOriginBottomLeft = true;\n    /**\n     * Gets or sets a boolean indicating that uniform buffers must be disabled even if they are supported\n     */\n    this.disableUniformBuffers = false;\n    /**\n     * An event triggered when the engine is disposed.\n     */\n    this.onDisposeObservable = new Observable();\n    this._frameId = 0;\n    /** @internal */\n    this._uniformBuffers = new Array();\n    /** @internal */\n    this._storageBuffers = new Array();\n    /** @internal */\n    this._webGLVersion = 1.0;\n    this._windowIsBackground = false;\n    this._highPrecisionShadersAllowed = true;\n    /** @internal */\n    this._badOS = false;\n    /** @internal */\n    this._badDesktopOS = false;\n    this._renderingQueueLaunched = false;\n    this._activeRenderLoops = new Array();\n    // Lost context\n    /**\n     * Observable signaled when a context lost event is raised\n     */\n    this.onContextLostObservable = new Observable();\n    /**\n     * Observable signaled when a context restored event is raised\n     */\n    this.onContextRestoredObservable = new Observable();\n    this._contextWasLost = false;\n    /** @internal */\n    this._doNotHandleContextLost = false;\n    /**\n     * Gets or sets a boolean indicating that vertex array object must be disabled even if they are supported\n     */\n    this.disableVertexArrayObjects = false;\n    // States\n    /** @internal */\n    this._colorWrite = true;\n    /** @internal */\n    this._colorWriteChanged = true;\n    /** @internal */\n    this._depthCullingState = new DepthCullingState();\n    /** @internal */\n    this._stencilStateComposer = new StencilStateComposer();\n    /** @internal */\n    this._stencilState = new StencilState();\n    /** @internal */\n    this._alphaState = new AlphaState();\n    /** @internal */\n    this._alphaMode = 1;\n    /** @internal */\n    this._alphaEquation = 0;\n    // Cache\n    /** @internal */\n    this._internalTexturesCache = new Array();\n    /** @internal */\n    this._renderTargetWrapperCache = new Array();\n    /** @internal */\n    this._activeChannel = 0;\n    this._currentTextureChannel = -1;\n    /** @internal */\n    this._boundTexturesCache = {};\n    this._compiledEffects = {};\n    this._vertexAttribArraysEnabled = [];\n    this._uintIndicesCurrentlySet = false;\n    this._currentBoundBuffer = new Array();\n    /** @internal */\n    this._currentFramebuffer = null;\n    /** @internal */\n    this._dummyFramebuffer = null;\n    this._currentBufferPointers = new Array();\n    this._currentInstanceLocations = new Array();\n    this._currentInstanceBuffers = new Array();\n    this._vaoRecordInProgress = false;\n    this._mustWipeVertexAttributes = false;\n    this._nextFreeTextureSlots = new Array();\n    this._maxSimultaneousTextures = 0;\n    this._maxMSAASamplesOverride = null;\n    this._activeRequests = new Array();\n    /**\n     * If set to true zooming in and out in the browser will rescale the hardware-scaling correctly.\n     */\n    this.adaptToDeviceRatio = false;\n    /** @internal */\n    this._lastDevicePixelRatio = 1.0;\n    /** @internal */\n    this._transformTextureUrl = null;\n    /**\n     * Gets information about the current host\n     */\n    this.hostInformation = {\n      isMobile: false\n    };\n    /**\n     * Defines whether the engine has been created with the premultipliedAlpha option on or not.\n     */\n    this.premultipliedAlpha = true;\n    /**\n     * Observable event triggered before each texture is initialized\n     */\n    this.onBeforeTextureInitObservable = new Observable();\n    /** @internal */\n    this._isWebGPU = false;\n    this._snapshotRenderingMode = 0;\n    this._viewportCached = {\n      x: 0,\n      y: 0,\n      z: 0,\n      w: 0\n    };\n    this._unpackFlipYCached = null;\n    /**\n     * In case you are sharing the context with other applications, it might\n     * be interested to not cache the unpack flip y state to ensure a consistent\n     * value would be set.\n     */\n    this.enableUnpackFlipYCached = true;\n    this._boundUniforms = {};\n    this.startTime = PrecisionDate.Now;\n    let canvas = null;\n    options = options || {};\n    this._creationOptions = options;\n    // Save this off for use in resize().\n    this.adaptToDeviceRatio = adaptToDeviceRatio !== null && adaptToDeviceRatio !== void 0 ? adaptToDeviceRatio : false;\n    this._stencilStateComposer.stencilGlobal = this._stencilState;\n    PerformanceConfigurator.SetMatrixPrecision(!!options.useHighPrecisionMatrix);\n    options.antialias = antialias !== null && antialias !== void 0 ? antialias : options.antialias;\n    options.deterministicLockstep = (_a = options.deterministicLockstep) !== null && _a !== void 0 ? _a : false;\n    options.lockstepMaxSteps = (_b = options.lockstepMaxSteps) !== null && _b !== void 0 ? _b : 4;\n    options.timeStep = (_c = options.timeStep) !== null && _c !== void 0 ? _c : 1 / 60;\n    options.audioEngine = (_d = options.audioEngine) !== null && _d !== void 0 ? _d : true;\n    options.stencil = (_e = options.stencil) !== null && _e !== void 0 ? _e : true;\n    this._audioContext = (_g = (_f = options.audioEngineOptions) === null || _f === void 0 ? void 0 : _f.audioContext) !== null && _g !== void 0 ? _g : null;\n    this._audioDestination = (_j = (_h = options.audioEngineOptions) === null || _h === void 0 ? void 0 : _h.audioDestination) !== null && _j !== void 0 ? _j : null;\n    this.premultipliedAlpha = (_k = options.premultipliedAlpha) !== null && _k !== void 0 ? _k : true;\n    this.useExactSrgbConversions = (_l = options.useExactSrgbConversions) !== null && _l !== void 0 ? _l : false;\n    this._doNotHandleContextLost = !!options.doNotHandleContextLost;\n    this._isStencilEnable = options.stencil ? true : false;\n    // Viewport\n    adaptToDeviceRatio = adaptToDeviceRatio || options.adaptToDeviceRatio || false;\n    const devicePixelRatio = IsWindowObjectExist() ? window.devicePixelRatio || 1.0 : 1.0;\n    const limitDeviceRatio = options.limitDeviceRatio || devicePixelRatio;\n    this._hardwareScalingLevel = adaptToDeviceRatio ? 1.0 / Math.min(limitDeviceRatio, devicePixelRatio) : 1.0;\n    this._lastDevicePixelRatio = devicePixelRatio;\n    if (!canvasOrContext) {\n      return;\n    }\n    if (canvasOrContext.getContext) {\n      canvas = canvasOrContext;\n      this._renderingCanvas = canvas;\n      if (options.preserveDrawingBuffer === undefined) {\n        options.preserveDrawingBuffer = false;\n      }\n      if (options.xrCompatible === undefined) {\n        options.xrCompatible = true;\n      }\n      // Exceptions\n      if (navigator && navigator.userAgent) {\n        this._setupMobileChecks();\n        const ua = navigator.userAgent;\n        for (const exception of ThinEngine.ExceptionList) {\n          const key = exception.key;\n          const targets = exception.targets;\n          const check = new RegExp(key);\n          if (check.test(ua)) {\n            if (exception.capture && exception.captureConstraint) {\n              const capture = exception.capture;\n              const constraint = exception.captureConstraint;\n              const regex = new RegExp(capture);\n              const matches = regex.exec(ua);\n              if (matches && matches.length > 0) {\n                const capturedValue = parseInt(matches[matches.length - 1]);\n                if (capturedValue >= constraint) {\n                  continue;\n                }\n              }\n            }\n            for (const target of targets) {\n              switch (target) {\n                case \"uniformBuffer\":\n                  this.disableUniformBuffers = true;\n                  break;\n                case \"vao\":\n                  this.disableVertexArrayObjects = true;\n                  break;\n                case \"antialias\":\n                  options.antialias = false;\n                  break;\n                case \"maxMSAASamples\":\n                  this._maxMSAASamplesOverride = 1;\n                  break;\n              }\n            }\n          }\n        }\n      }\n      // Context lost\n      if (!this._doNotHandleContextLost) {\n        this._onContextLost = evt => {\n          evt.preventDefault();\n          this._contextWasLost = true;\n          Logger.Warn(\"WebGL context lost.\");\n          this.onContextLostObservable.notifyObservers(this);\n        };\n        this._onContextRestored = () => {\n          this._restoreEngineAfterContextLost(() => this._initGLContext());\n        };\n        canvas.addEventListener(\"webglcontextlost\", this._onContextLost, false);\n        canvas.addEventListener(\"webglcontextrestored\", this._onContextRestored, false);\n        options.powerPreference = options.powerPreference || \"high-performance\";\n      }\n      // Detect if we are running on a faulty buggy desktop OS.\n      this._badDesktopOS = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);\n      if (this._badDesktopOS) {\n        options.xrCompatible = false;\n      }\n      // GL\n      if (!options.disableWebGL2Support) {\n        try {\n          this._gl = canvas.getContext(\"webgl2\", options) || canvas.getContext(\"experimental-webgl2\", options);\n          if (this._gl) {\n            this._webGLVersion = 2.0;\n            this._shaderPlatformName = \"WEBGL2\";\n            // Prevent weird browsers to lie (yeah that happens!)\n            if (!this._gl.deleteQuery) {\n              this._webGLVersion = 1.0;\n              this._shaderPlatformName = \"WEBGL1\";\n            }\n          }\n        } catch (e) {\n          // Do nothing\n        }\n      }\n      if (!this._gl) {\n        if (!canvas) {\n          throw new Error(\"The provided canvas is null or undefined.\");\n        }\n        try {\n          this._gl = canvas.getContext(\"webgl\", options) || canvas.getContext(\"experimental-webgl\", options);\n        } catch (e) {\n          throw new Error(\"WebGL not supported\");\n        }\n      }\n      if (!this._gl) {\n        throw new Error(\"WebGL not supported\");\n      }\n    } else {\n      this._gl = canvasOrContext;\n      this._renderingCanvas = this._gl.canvas;\n      if (this._gl.renderbufferStorageMultisample) {\n        this._webGLVersion = 2.0;\n        this._shaderPlatformName = \"WEBGL2\";\n      } else {\n        this._shaderPlatformName = \"WEBGL1\";\n      }\n      const attributes = this._gl.getContextAttributes();\n      if (attributes) {\n        options.stencil = attributes.stencil;\n      }\n    }\n    // Ensures a consistent color space unpacking of textures cross browser.\n    this._gl.pixelStorei(this._gl.UNPACK_COLORSPACE_CONVERSION_WEBGL, this._gl.NONE);\n    if (options.useHighPrecisionFloats !== undefined) {\n      this._highPrecisionShadersAllowed = options.useHighPrecisionFloats;\n    }\n    this.resize();\n    this._initGLContext();\n    this._initFeatures();\n    // Prepare buffer pointers\n    for (let i = 0; i < this._caps.maxVertexAttribs; i++) {\n      this._currentBufferPointers[i] = new BufferPointer();\n    }\n    // Shader processor\n    this._shaderProcessor = this.webGLVersion > 1 ? new WebGL2ShaderProcessor() : new WebGLShaderProcessor();\n    // Detect if we are running on a faulty buggy OS.\n    this._badOS = /iPad/i.test(navigator.userAgent) || /iPhone/i.test(navigator.userAgent);\n    // Starting with iOS 14, we can trust the browser\n    // let matches = navigator.userAgent.match(/Version\\/(\\d+)/);\n    // if (matches && matches.length === 2) {\n    //     if (parseInt(matches[1]) >= 14) {\n    //         this._badOS = false;\n    //     }\n    // }\n    const versionToLog = `Babylon.js v${ThinEngine.Version}`;\n    console.log(versionToLog + ` - ${this.description}`);\n    // Check setAttribute in case of workers\n    if (this._renderingCanvas && this._renderingCanvas.setAttribute) {\n      this._renderingCanvas.setAttribute(\"data-engine\", versionToLog);\n    }\n  }\n  _setupMobileChecks() {\n    if (!(navigator && navigator.userAgent)) {\n      return;\n    }\n    // Function to check if running on mobile device\n    this._checkForMobile = () => {\n      const currentUA = navigator.userAgent;\n      this.hostInformation.isMobile = currentUA.indexOf(\"Mobile\") !== -1 ||\n      // Needed for iOS 13+ detection on iPad (inspired by solution from https://stackoverflow.com/questions/9038625/detect-if-device-is-ios)\n      currentUA.indexOf(\"Mac\") !== -1 && IsDocumentAvailable() && \"ontouchend\" in document;\n    };\n    // Set initial isMobile value\n    this._checkForMobile();\n    // Set up event listener to check when window is resized (used to get emulator activation to work properly)\n    if (IsWindowObjectExist()) {\n      window.addEventListener(\"resize\", this._checkForMobile);\n    }\n  }\n  _restoreEngineAfterContextLost(initEngine) {\n    // Adding a timeout to avoid race condition at browser level\n    setTimeout(async () => {\n      var _a;\n      this._dummyFramebuffer = null;\n      const depthTest = this._depthCullingState.depthTest; // backup those values because the call to initEngine / wipeCaches will reset them\n      const depthFunc = this._depthCullingState.depthFunc;\n      const depthMask = this._depthCullingState.depthMask;\n      const stencilTest = this._stencilState.stencilTest;\n      // Rebuild context\n      await initEngine();\n      // Ensure webgl and engine states are matching\n      this.wipeCaches(true);\n      // Rebuild effects\n      this._rebuildEffects();\n      (_a = this._rebuildComputeEffects) === null || _a === void 0 ? void 0 : _a.call(this);\n      // Note:\n      //  The call to _rebuildBuffers must be made before the call to _rebuildInternalTextures because in the process of _rebuildBuffers the buffers used by the post process managers will be rebuilt\n      //  and we may need to use the post process manager of the scene during _rebuildInternalTextures (in WebGL1, non-POT textures are rescaled using a post process + post process manager of the scene)\n      // Rebuild buffers\n      this._rebuildBuffers();\n      // Rebuild textures\n      this._rebuildInternalTextures();\n      // Rebuild textures\n      this._rebuildRenderTargetWrappers();\n      // Reset engine states after all the buffer/textures/... have been rebuilt\n      this.wipeCaches(true);\n      this._depthCullingState.depthTest = depthTest;\n      this._depthCullingState.depthFunc = depthFunc;\n      this._depthCullingState.depthMask = depthMask;\n      this._stencilState.stencilTest = stencilTest;\n      Logger.Warn(this.name + \" context successfully restored.\");\n      this.onContextRestoredObservable.notifyObservers(this);\n      this._contextWasLost = false;\n    }, 0);\n  }\n  /**\n   * Shared initialization across engines types.\n   * @param canvas The canvas associated with this instance of the engine.\n   */\n  _sharedInit(canvas) {\n    this._renderingCanvas = canvas;\n  }\n  /**\n   * @internal\n   */\n  _getShaderProcessingContext(shaderLanguage) {\n    return null;\n  }\n  _rebuildInternalTextures() {\n    const currentState = this._internalTexturesCache.slice(); // Do a copy because the rebuild will add proxies\n    for (const internalTexture of currentState) {\n      internalTexture._rebuild();\n    }\n  }\n  _rebuildRenderTargetWrappers() {\n    const currentState = this._renderTargetWrapperCache.slice(); // Do a copy because the rebuild will add proxies\n    for (const renderTargetWrapper of currentState) {\n      renderTargetWrapper._rebuild();\n    }\n  }\n  _rebuildEffects() {\n    for (const key in this._compiledEffects) {\n      const effect = this._compiledEffects[key];\n      effect._pipelineContext = null; // because _prepareEffect will try to dispose this pipeline before recreating it and that would lead to webgl errors\n      effect._wasPreviouslyReady = false;\n      effect._prepareEffect();\n    }\n    Effect.ResetCache();\n  }\n  /**\n   * Gets a boolean indicating if all created effects are ready\n   * @returns true if all effects are ready\n   */\n  areAllEffectsReady() {\n    for (const key in this._compiledEffects) {\n      const effect = this._compiledEffects[key];\n      if (!effect.isReady()) {\n        return false;\n      }\n    }\n    return true;\n  }\n  _rebuildBuffers() {\n    // Uniforms\n    for (const uniformBuffer of this._uniformBuffers) {\n      uniformBuffer._rebuild();\n    }\n    // Storage buffers\n    for (const storageBuffer of this._storageBuffers) {\n      storageBuffer._rebuild();\n    }\n  }\n  _initGLContext() {\n    var _a;\n    // Caps\n    this._caps = {\n      maxTexturesImageUnits: this._gl.getParameter(this._gl.MAX_TEXTURE_IMAGE_UNITS),\n      maxCombinedTexturesImageUnits: this._gl.getParameter(this._gl.MAX_COMBINED_TEXTURE_IMAGE_UNITS),\n      maxVertexTextureImageUnits: this._gl.getParameter(this._gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS),\n      maxTextureSize: this._gl.getParameter(this._gl.MAX_TEXTURE_SIZE),\n      maxSamples: this._webGLVersion > 1 ? this._gl.getParameter(this._gl.MAX_SAMPLES) : 1,\n      maxCubemapTextureSize: this._gl.getParameter(this._gl.MAX_CUBE_MAP_TEXTURE_SIZE),\n      maxRenderTextureSize: this._gl.getParameter(this._gl.MAX_RENDERBUFFER_SIZE),\n      maxVertexAttribs: this._gl.getParameter(this._gl.MAX_VERTEX_ATTRIBS),\n      maxVaryingVectors: this._gl.getParameter(this._gl.MAX_VARYING_VECTORS),\n      maxFragmentUniformVectors: this._gl.getParameter(this._gl.MAX_FRAGMENT_UNIFORM_VECTORS),\n      maxVertexUniformVectors: this._gl.getParameter(this._gl.MAX_VERTEX_UNIFORM_VECTORS),\n      parallelShaderCompile: this._gl.getExtension(\"KHR_parallel_shader_compile\") || undefined,\n      standardDerivatives: this._webGLVersion > 1 || this._gl.getExtension(\"OES_standard_derivatives\") !== null,\n      maxAnisotropy: 1,\n      astc: this._gl.getExtension(\"WEBGL_compressed_texture_astc\") || this._gl.getExtension(\"WEBKIT_WEBGL_compressed_texture_astc\"),\n      bptc: this._gl.getExtension(\"EXT_texture_compression_bptc\") || this._gl.getExtension(\"WEBKIT_EXT_texture_compression_bptc\"),\n      s3tc: this._gl.getExtension(\"WEBGL_compressed_texture_s3tc\") || this._gl.getExtension(\"WEBKIT_WEBGL_compressed_texture_s3tc\"),\n      // eslint-disable-next-line @typescript-eslint/naming-convention\n      s3tc_srgb: this._gl.getExtension(\"WEBGL_compressed_texture_s3tc_srgb\") || this._gl.getExtension(\"WEBKIT_WEBGL_compressed_texture_s3tc_srgb\"),\n      pvrtc: this._gl.getExtension(\"WEBGL_compressed_texture_pvrtc\") || this._gl.getExtension(\"WEBKIT_WEBGL_compressed_texture_pvrtc\"),\n      etc1: this._gl.getExtension(\"WEBGL_compressed_texture_etc1\") || this._gl.getExtension(\"WEBKIT_WEBGL_compressed_texture_etc1\"),\n      etc2: this._gl.getExtension(\"WEBGL_compressed_texture_etc\") || this._gl.getExtension(\"WEBKIT_WEBGL_compressed_texture_etc\") || this._gl.getExtension(\"WEBGL_compressed_texture_es3_0\"),\n      textureAnisotropicFilterExtension: this._gl.getExtension(\"EXT_texture_filter_anisotropic\") || this._gl.getExtension(\"WEBKIT_EXT_texture_filter_anisotropic\") || this._gl.getExtension(\"MOZ_EXT_texture_filter_anisotropic\"),\n      uintIndices: this._webGLVersion > 1 || this._gl.getExtension(\"OES_element_index_uint\") !== null,\n      fragmentDepthSupported: this._webGLVersion > 1 || this._gl.getExtension(\"EXT_frag_depth\") !== null,\n      highPrecisionShaderSupported: false,\n      timerQuery: this._gl.getExtension(\"EXT_disjoint_timer_query_webgl2\") || this._gl.getExtension(\"EXT_disjoint_timer_query\"),\n      supportOcclusionQuery: this._webGLVersion > 1,\n      canUseTimestampForTimerQuery: false,\n      drawBuffersExtension: false,\n      maxMSAASamples: 1,\n      colorBufferFloat: !!(this._webGLVersion > 1 && this._gl.getExtension(\"EXT_color_buffer_float\")),\n      colorBufferHalfFloat: !!(this._webGLVersion > 1 && this._gl.getExtension(\"EXT_color_buffer_half_float\")),\n      textureFloat: this._webGLVersion > 1 || this._gl.getExtension(\"OES_texture_float\") ? true : false,\n      textureHalfFloat: this._webGLVersion > 1 || this._gl.getExtension(\"OES_texture_half_float\") ? true : false,\n      textureHalfFloatRender: false,\n      textureFloatLinearFiltering: false,\n      textureFloatRender: false,\n      textureHalfFloatLinearFiltering: false,\n      vertexArrayObject: false,\n      instancedArrays: false,\n      textureLOD: this._webGLVersion > 1 || this._gl.getExtension(\"EXT_shader_texture_lod\") ? true : false,\n      texelFetch: this._webGLVersion !== 1,\n      blendMinMax: false,\n      multiview: this._gl.getExtension(\"OVR_multiview2\"),\n      oculusMultiview: this._gl.getExtension(\"OCULUS_multiview\"),\n      depthTextureExtension: false,\n      canUseGLInstanceID: this._webGLVersion > 1,\n      canUseGLVertexID: this._webGLVersion > 1,\n      supportComputeShaders: false,\n      supportSRGBBuffers: false,\n      supportTransformFeedbacks: this._webGLVersion > 1,\n      textureMaxLevel: this._webGLVersion > 1,\n      texture2DArrayMaxLayerCount: this._webGLVersion > 1 ? this._gl.getParameter(this._gl.MAX_ARRAY_TEXTURE_LAYERS) : 128,\n      disableMorphTargetTexture: false\n    };\n    // Infos\n    this._glVersion = this._gl.getParameter(this._gl.VERSION);\n    const rendererInfo = this._gl.getExtension(\"WEBGL_debug_renderer_info\");\n    if (rendererInfo != null) {\n      this._glRenderer = this._gl.getParameter(rendererInfo.UNMASKED_RENDERER_WEBGL);\n      this._glVendor = this._gl.getParameter(rendererInfo.UNMASKED_VENDOR_WEBGL);\n    }\n    if (!this._glVendor) {\n      this._glVendor = this._gl.getParameter(this._gl.VENDOR) || \"Unknown vendor\";\n    }\n    if (!this._glRenderer) {\n      this._glRenderer = this._gl.getParameter(this._gl.RENDERER) || \"Unknown renderer\";\n    }\n    // Constants\n    if (this._gl.HALF_FLOAT_OES !== 0x8d61) {\n      this._gl.HALF_FLOAT_OES = 0x8d61; // Half floating-point type (16-bit).\n    }\n\n    if (this._gl.RGBA16F !== 0x881a) {\n      this._gl.RGBA16F = 0x881a; // RGBA 16-bit floating-point color-renderable internal sized format.\n    }\n\n    if (this._gl.RGBA32F !== 0x8814) {\n      this._gl.RGBA32F = 0x8814; // RGBA 32-bit floating-point color-renderable internal sized format.\n    }\n\n    if (this._gl.DEPTH24_STENCIL8 !== 35056) {\n      this._gl.DEPTH24_STENCIL8 = 35056;\n    }\n    // Extensions\n    if (this._caps.timerQuery) {\n      if (this._webGLVersion === 1) {\n        this._gl.getQuery = this._caps.timerQuery.getQueryEXT.bind(this._caps.timerQuery);\n      }\n      // WebGLQuery casted to number to avoid TS error\n      this._caps.canUseTimestampForTimerQuery = ((_a = this._gl.getQuery(this._caps.timerQuery.TIMESTAMP_EXT, this._caps.timerQuery.QUERY_COUNTER_BITS_EXT)) !== null && _a !== void 0 ? _a : 0) > 0;\n    }\n    this._caps.maxAnisotropy = this._caps.textureAnisotropicFilterExtension ? this._gl.getParameter(this._caps.textureAnisotropicFilterExtension.MAX_TEXTURE_MAX_ANISOTROPY_EXT) : 0;\n    this._caps.textureFloatLinearFiltering = this._caps.textureFloat && this._gl.getExtension(\"OES_texture_float_linear\") ? true : false;\n    this._caps.textureFloatRender = this._caps.textureFloat && this._canRenderToFloatFramebuffer() ? true : false;\n    this._caps.textureHalfFloatLinearFiltering = this._webGLVersion > 1 || this._caps.textureHalfFloat && this._gl.getExtension(\"OES_texture_half_float_linear\") ? true : false;\n    // Compressed formats\n    if (this._caps.astc) {\n      this._gl.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR = this._caps.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR;\n    }\n    if (this._caps.bptc) {\n      this._gl.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT = this._caps.bptc.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT;\n    }\n    if (this._caps.s3tc_srgb) {\n      this._gl.COMPRESSED_SRGB_S3TC_DXT1_EXT = this._caps.s3tc_srgb.COMPRESSED_SRGB_S3TC_DXT1_EXT;\n      this._gl.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT = this._caps.s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;\n      this._gl.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT = this._caps.s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT;\n    }\n    if (this._caps.etc2) {\n      this._gl.COMPRESSED_SRGB8_ETC2 = this._caps.etc2.COMPRESSED_SRGB8_ETC2;\n      this._gl.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC = this._caps.etc2.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC;\n    }\n    // Checks if some of the format renders first to allow the use of webgl inspector.\n    if (this._webGLVersion > 1) {\n      if (this._gl.HALF_FLOAT_OES !== 0x140b) {\n        this._gl.HALF_FLOAT_OES = 0x140b;\n      }\n    }\n    this._caps.textureHalfFloatRender = this._caps.textureHalfFloat && this._canRenderToHalfFloatFramebuffer();\n    // Draw buffers\n    if (this._webGLVersion > 1) {\n      this._caps.drawBuffersExtension = true;\n      this._caps.maxMSAASamples = this._maxMSAASamplesOverride !== null ? this._maxMSAASamplesOverride : this._gl.getParameter(this._gl.MAX_SAMPLES);\n    } else {\n      const drawBuffersExtension = this._gl.getExtension(\"WEBGL_draw_buffers\");\n      if (drawBuffersExtension !== null) {\n        this._caps.drawBuffersExtension = true;\n        this._gl.drawBuffers = drawBuffersExtension.drawBuffersWEBGL.bind(drawBuffersExtension);\n        this._gl.DRAW_FRAMEBUFFER = this._gl.FRAMEBUFFER;\n        for (let i = 0; i < 16; i++) {\n          this._gl[\"COLOR_ATTACHMENT\" + i + \"_WEBGL\"] = drawBuffersExtension[\"COLOR_ATTACHMENT\" + i + \"_WEBGL\"];\n        }\n      }\n    }\n    // Depth Texture\n    if (this._webGLVersion > 1) {\n      this._caps.depthTextureExtension = true;\n    } else {\n      const depthTextureExtension = this._gl.getExtension(\"WEBGL_depth_texture\");\n      if (depthTextureExtension != null) {\n        this._caps.depthTextureExtension = true;\n        this._gl.UNSIGNED_INT_24_8 = depthTextureExtension.UNSIGNED_INT_24_8_WEBGL;\n      }\n    }\n    // Vertex array object\n    if (this.disableVertexArrayObjects) {\n      this._caps.vertexArrayObject = false;\n    } else if (this._webGLVersion > 1) {\n      this._caps.vertexArrayObject = true;\n    } else {\n      const vertexArrayObjectExtension = this._gl.getExtension(\"OES_vertex_array_object\");\n      if (vertexArrayObjectExtension != null) {\n        this._caps.vertexArrayObject = true;\n        this._gl.createVertexArray = vertexArrayObjectExtension.createVertexArrayOES.bind(vertexArrayObjectExtension);\n        this._gl.bindVertexArray = vertexArrayObjectExtension.bindVertexArrayOES.bind(vertexArrayObjectExtension);\n        this._gl.deleteVertexArray = vertexArrayObjectExtension.deleteVertexArrayOES.bind(vertexArrayObjectExtension);\n      }\n    }\n    // Instances count\n    if (this._webGLVersion > 1) {\n      this._caps.instancedArrays = true;\n    } else {\n      const instanceExtension = this._gl.getExtension(\"ANGLE_instanced_arrays\");\n      if (instanceExtension != null) {\n        this._caps.instancedArrays = true;\n        this._gl.drawArraysInstanced = instanceExtension.drawArraysInstancedANGLE.bind(instanceExtension);\n        this._gl.drawElementsInstanced = instanceExtension.drawElementsInstancedANGLE.bind(instanceExtension);\n        this._gl.vertexAttribDivisor = instanceExtension.vertexAttribDivisorANGLE.bind(instanceExtension);\n      } else {\n        this._caps.instancedArrays = false;\n      }\n    }\n    if (this._gl.getShaderPrecisionFormat) {\n      const vertexhighp = this._gl.getShaderPrecisionFormat(this._gl.VERTEX_SHADER, this._gl.HIGH_FLOAT);\n      const fragmenthighp = this._gl.getShaderPrecisionFormat(this._gl.FRAGMENT_SHADER, this._gl.HIGH_FLOAT);\n      if (vertexhighp && fragmenthighp) {\n        this._caps.highPrecisionShaderSupported = vertexhighp.precision !== 0 && fragmenthighp.precision !== 0;\n      }\n    }\n    if (this._webGLVersion > 1) {\n      this._caps.blendMinMax = true;\n    } else {\n      const blendMinMaxExtension = this._gl.getExtension(\"EXT_blend_minmax\");\n      if (blendMinMaxExtension != null) {\n        this._caps.blendMinMax = true;\n        this._gl.MAX = blendMinMaxExtension.MAX_EXT;\n        this._gl.MIN = blendMinMaxExtension.MIN_EXT;\n      }\n    }\n    // sRGB buffers\n    // only run this if not already set to true (in the constructor, for example)\n    if (!this._caps.supportSRGBBuffers) {\n      if (this._webGLVersion > 1) {\n        this._caps.supportSRGBBuffers = true;\n        this._glSRGBExtensionValues = {\n          SRGB: WebGL2RenderingContext.SRGB,\n          SRGB8: WebGL2RenderingContext.SRGB8,\n          SRGB8_ALPHA8: WebGL2RenderingContext.SRGB8_ALPHA8\n        };\n      } else {\n        const sRGBExtension = this._gl.getExtension(\"EXT_sRGB\");\n        if (sRGBExtension != null) {\n          this._caps.supportSRGBBuffers = true;\n          this._glSRGBExtensionValues = {\n            SRGB: sRGBExtension.SRGB_EXT,\n            SRGB8: sRGBExtension.SRGB_ALPHA_EXT,\n            SRGB8_ALPHA8: sRGBExtension.SRGB_ALPHA_EXT\n          };\n        }\n      }\n      // take into account the forced state that was provided in options\n      // When the issue in angle/chrome is fixed the flag should be taken into account only when it is explicitly defined\n      this._caps.supportSRGBBuffers = this._caps.supportSRGBBuffers && !!(this._creationOptions && this._creationOptions.forceSRGBBufferSupportState);\n    }\n    // Depth buffer\n    this._depthCullingState.depthTest = true;\n    this._depthCullingState.depthFunc = this._gl.LEQUAL;\n    this._depthCullingState.depthMask = true;\n    // Texture maps\n    this._maxSimultaneousTextures = this._caps.maxCombinedTexturesImageUnits;\n    for (let slot = 0; slot < this._maxSimultaneousTextures; slot++) {\n      this._nextFreeTextureSlots.push(slot);\n    }\n    if (this._glRenderer === \"Mali-G72\") {\n      // Overcome a bug when using a texture to store morph targets on Mali-G72\n      this._caps.disableMorphTargetTexture = true;\n    }\n  }\n  _initFeatures() {\n    this._features = {\n      forceBitmapOverHTMLImageElement: false,\n      supportRenderAndCopyToLodForFloatTextures: this._webGLVersion !== 1,\n      supportDepthStencilTexture: this._webGLVersion !== 1,\n      supportShadowSamplers: this._webGLVersion !== 1,\n      uniformBufferHardCheckMatrix: false,\n      allowTexturePrefiltering: this._webGLVersion !== 1,\n      trackUbosInFrame: false,\n      checkUbosContentBeforeUpload: false,\n      supportCSM: this._webGLVersion !== 1,\n      basisNeedsPOT: this._webGLVersion === 1,\n      support3DTextures: this._webGLVersion !== 1,\n      needTypeSuffixInShaderConstants: this._webGLVersion !== 1,\n      supportMSAA: this._webGLVersion !== 1,\n      supportSSAO2: this._webGLVersion !== 1,\n      supportExtendedTextureFormats: this._webGLVersion !== 1,\n      supportSwitchCaseInShader: this._webGLVersion !== 1,\n      supportSyncTextureRead: true,\n      needsInvertingBitmap: true,\n      useUBOBindingCache: true,\n      needShaderCodeInlining: false,\n      needToAlwaysBindUniformBuffers: false,\n      supportRenderPasses: false,\n      supportSpriteInstancing: true,\n      forceVertexBufferStrideMultiple4Bytes: false,\n      _collectUbosUpdatedInFrame: false\n    };\n  }\n  /**\n   * Gets version of the current webGL context\n   * Keep it for back compat - use version instead\n   */\n  get webGLVersion() {\n    return this._webGLVersion;\n  }\n  /**\n   * Gets a string identifying the name of the class\n   * @returns \"Engine\" string\n   */\n  getClassName() {\n    return \"ThinEngine\";\n  }\n  /**\n   * Returns true if the stencil buffer has been enabled through the creation option of the context.\n   */\n  get isStencilEnable() {\n    return this._isStencilEnable;\n  }\n  /** @internal */\n  _prepareWorkingCanvas() {\n    if (this._workingCanvas) {\n      return;\n    }\n    this._workingCanvas = this.createCanvas(1, 1);\n    const context = this._workingCanvas.getContext(\"2d\");\n    if (context) {\n      this._workingContext = context;\n    }\n  }\n  /**\n   * Reset the texture cache to empty state\n   */\n  resetTextureCache() {\n    for (const key in this._boundTexturesCache) {\n      if (!Object.prototype.hasOwnProperty.call(this._boundTexturesCache, key)) {\n        continue;\n      }\n      this._boundTexturesCache[key] = null;\n    }\n    this._currentTextureChannel = -1;\n  }\n  /**\n   * Gets an object containing information about the current engine context\n   * @returns an object containing the vendor, the renderer and the version of the current engine context\n   */\n  getInfo() {\n    return this.getGlInfo();\n  }\n  /**\n   * Gets an object containing information about the current webGL context\n   * @returns an object containing the vendor, the renderer and the version of the current webGL context\n   */\n  getGlInfo() {\n    return {\n      vendor: this._glVendor,\n      renderer: this._glRenderer,\n      version: this._glVersion\n    };\n  }\n  /**\n   * Defines the hardware scaling level.\n   * By default the hardware scaling level is computed from the window device ratio.\n   * if level = 1 then the engine will render at the exact resolution of the canvas. If level = 0.5 then the engine will render at twice the size of the canvas.\n   * @param level defines the level to use\n   */\n  setHardwareScalingLevel(level) {\n    this._hardwareScalingLevel = level;\n    this.resize();\n  }\n  /**\n   * Gets the current hardware scaling level.\n   * By default the hardware scaling level is computed from the window device ratio.\n   * if level = 1 then the engine will render at the exact resolution of the canvas. If level = 0.5 then the engine will render at twice the size of the canvas.\n   * @returns a number indicating the current hardware scaling level\n   */\n  getHardwareScalingLevel() {\n    return this._hardwareScalingLevel;\n  }\n  /**\n   * Gets the list of loaded textures\n   * @returns an array containing all loaded textures\n   */\n  getLoadedTexturesCache() {\n    return this._internalTexturesCache;\n  }\n  /**\n   * Gets the object containing all engine capabilities\n   * @returns the EngineCapabilities object\n   */\n  getCaps() {\n    return this._caps;\n  }\n  /**\n   * stop executing a render loop function and remove it from the execution array\n   * @param renderFunction defines the function to be removed. If not provided all functions will be removed.\n   */\n  stopRenderLoop(renderFunction) {\n    if (!renderFunction) {\n      this._activeRenderLoops.length = 0;\n      this._cancelFrame();\n      return;\n    }\n    const index = this._activeRenderLoops.indexOf(renderFunction);\n    if (index >= 0) {\n      this._activeRenderLoops.splice(index, 1);\n      if (this._activeRenderLoops.length == 0) {\n        this._cancelFrame();\n      }\n    }\n  }\n  _cancelFrame() {\n    if (this._renderingQueueLaunched && this._frameHandler) {\n      this._renderingQueueLaunched = false;\n      if (!IsWindowObjectExist()) {\n        if (typeof cancelAnimationFrame === \"function\") {\n          return cancelAnimationFrame(this._frameHandler);\n        }\n      } else {\n        const {\n          cancelAnimationFrame\n        } = this.getHostWindow() || window;\n        if (typeof cancelAnimationFrame === \"function\") {\n          return cancelAnimationFrame(this._frameHandler);\n        }\n      }\n      return clearTimeout(this._frameHandler);\n    }\n  }\n  /** @internal */\n  _renderLoop() {\n    if (!this._contextWasLost) {\n      let shouldRender = true;\n      if (this._isDisposed || !this.renderEvenInBackground && this._windowIsBackground) {\n        shouldRender = false;\n      }\n      if (shouldRender) {\n        // Start new frame\n        this.beginFrame();\n        for (let index = 0; index < this._activeRenderLoops.length; index++) {\n          const renderFunction = this._activeRenderLoops[index];\n          renderFunction();\n        }\n        // Present\n        this.endFrame();\n      }\n    }\n    if (this._activeRenderLoops.length > 0) {\n      this._frameHandler = this._queueNewFrame(this._boundRenderFunction, this.getHostWindow());\n    } else {\n      this._renderingQueueLaunched = false;\n    }\n  }\n  /**\n   * Gets the HTML canvas attached with the current webGL context\n   * @returns a HTML canvas\n   */\n  getRenderingCanvas() {\n    return this._renderingCanvas;\n  }\n  /**\n   * Gets the audio context specified in engine initialization options\n   * @returns an Audio Context\n   */\n  getAudioContext() {\n    return this._audioContext;\n  }\n  /**\n   * Gets the audio destination specified in engine initialization options\n   * @returns an audio destination node\n   */\n  getAudioDestination() {\n    return this._audioDestination;\n  }\n  /**\n   * Gets host window\n   * @returns the host window object\n   */\n  getHostWindow() {\n    if (!IsWindowObjectExist()) {\n      return null;\n    }\n    if (this._renderingCanvas && this._renderingCanvas.ownerDocument && this._renderingCanvas.ownerDocument.defaultView) {\n      return this._renderingCanvas.ownerDocument.defaultView;\n    }\n    return window;\n  }\n  /**\n   * Gets the current render width\n   * @param useScreen defines if screen size must be used (or the current render target if any)\n   * @returns a number defining the current render width\n   */\n  getRenderWidth() {\n    let useScreen = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n    if (!useScreen && this._currentRenderTarget) {\n      return this._currentRenderTarget.width;\n    }\n    return this._framebufferDimensionsObject ? this._framebufferDimensionsObject.framebufferWidth : this._gl.drawingBufferWidth;\n  }\n  /**\n   * Gets the current render height\n   * @param useScreen defines if screen size must be used (or the current render target if any)\n   * @returns a number defining the current render height\n   */\n  getRenderHeight() {\n    let useScreen = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n    if (!useScreen && this._currentRenderTarget) {\n      return this._currentRenderTarget.height;\n    }\n    return this._framebufferDimensionsObject ? this._framebufferDimensionsObject.framebufferHeight : this._gl.drawingBufferHeight;\n  }\n  /**\n   * Can be used to override the current requestAnimationFrame requester.\n   * @internal\n   */\n  _queueNewFrame(bindedRenderFunction, requester) {\n    return ThinEngine.QueueNewFrame(bindedRenderFunction, requester);\n  }\n  /**\n   * Register and execute a render loop. The engine can have more than one render function\n   * @param renderFunction defines the function to continuously execute\n   */\n  runRenderLoop(renderFunction) {\n    if (this._activeRenderLoops.indexOf(renderFunction) !== -1) {\n      return;\n    }\n    this._activeRenderLoops.push(renderFunction);\n    if (!this._renderingQueueLaunched) {\n      this._renderingQueueLaunched = true;\n      this._boundRenderFunction = () => this._renderLoop();\n      this._frameHandler = this._queueNewFrame(this._boundRenderFunction, this.getHostWindow());\n    }\n  }\n  /**\n   * Clear the current render buffer or the current render target (if any is set up)\n   * @param color defines the color to use\n   * @param backBuffer defines if the back buffer must be cleared\n   * @param depth defines if the depth buffer must be cleared\n   * @param stencil defines if the stencil buffer must be cleared\n   */\n  clear(color, backBuffer, depth) {\n    let stencil = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n    var _a, _b;\n    const useStencilGlobalOnly = this.stencilStateComposer.useStencilGlobalOnly;\n    this.stencilStateComposer.useStencilGlobalOnly = true; // make sure the stencil mask is coming from the global stencil and not from a material (effect) which would currently be in effect\n    this.applyStates();\n    this.stencilStateComposer.useStencilGlobalOnly = useStencilGlobalOnly;\n    let mode = 0;\n    if (backBuffer && color) {\n      let setBackBufferColor = true;\n      if (this._currentRenderTarget) {\n        const textureFormat = (_a = this._currentRenderTarget.texture) === null || _a === void 0 ? void 0 : _a.format;\n        if (textureFormat === 8 || textureFormat === 9 || textureFormat === 10 || textureFormat === 11) {\n          const textureType = (_b = this._currentRenderTarget.texture) === null || _b === void 0 ? void 0 : _b.type;\n          if (textureType === 7 || textureType === 5) {\n            ThinEngine._TempClearColorUint32[0] = color.r * 255;\n            ThinEngine._TempClearColorUint32[1] = color.g * 255;\n            ThinEngine._TempClearColorUint32[2] = color.b * 255;\n            ThinEngine._TempClearColorUint32[3] = color.a * 255;\n            this._gl.clearBufferuiv(this._gl.COLOR, 0, ThinEngine._TempClearColorUint32);\n            setBackBufferColor = false;\n          } else {\n            ThinEngine._TempClearColorInt32[0] = color.r * 255;\n            ThinEngine._TempClearColorInt32[1] = color.g * 255;\n            ThinEngine._TempClearColorInt32[2] = color.b * 255;\n            ThinEngine._TempClearColorInt32[3] = color.a * 255;\n            this._gl.clearBufferiv(this._gl.COLOR, 0, ThinEngine._TempClearColorInt32);\n            setBackBufferColor = false;\n          }\n        }\n      }\n      if (setBackBufferColor) {\n        this._gl.clearColor(color.r, color.g, color.b, color.a !== undefined ? color.a : 1.0);\n        mode |= this._gl.COLOR_BUFFER_BIT;\n      }\n    }\n    if (depth) {\n      if (this.useReverseDepthBuffer) {\n        this._depthCullingState.depthFunc = this._gl.GEQUAL;\n        this._gl.clearDepth(0.0);\n      } else {\n        this._gl.clearDepth(1.0);\n      }\n      mode |= this._gl.DEPTH_BUFFER_BIT;\n    }\n    if (stencil) {\n      this._gl.clearStencil(0);\n      mode |= this._gl.STENCIL_BUFFER_BIT;\n    }\n    this._gl.clear(mode);\n  }\n  /**\n   * @internal\n   */\n  _viewport(x, y, width, height) {\n    if (x !== this._viewportCached.x || y !== this._viewportCached.y || width !== this._viewportCached.z || height !== this._viewportCached.w) {\n      this._viewportCached.x = x;\n      this._viewportCached.y = y;\n      this._viewportCached.z = width;\n      this._viewportCached.w = height;\n      this._gl.viewport(x, y, width, height);\n    }\n  }\n  /**\n   * Set the WebGL's viewport\n   * @param viewport defines the viewport element to be used\n   * @param requiredWidth defines the width required for rendering. If not provided the rendering canvas' width is used\n   * @param requiredHeight defines the height required for rendering. If not provided the rendering canvas' height is used\n   */\n  setViewport(viewport, requiredWidth, requiredHeight) {\n    const width = requiredWidth || this.getRenderWidth();\n    const height = requiredHeight || this.getRenderHeight();\n    const x = viewport.x || 0;\n    const y = viewport.y || 0;\n    this._cachedViewport = viewport;\n    this._viewport(x * width, y * height, width * viewport.width, height * viewport.height);\n  }\n  /**\n   * Begin a new frame\n   */\n  beginFrame() {}\n  /**\n   * Enf the current frame\n   */\n  endFrame() {\n    // Force a flush in case we are using a bad OS.\n    if (this._badOS) {\n      this.flushFramebuffer();\n    }\n    this._frameId++;\n  }\n  /**\n   * Resize the view according to the canvas' size\n   * @param forceSetSize true to force setting the sizes of the underlying canvas\n   */\n  resize() {\n    let forceSetSize = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n    let width;\n    let height;\n    // Re-query hardware scaling level to handle zoomed-in resizing.\n    if (this.adaptToDeviceRatio) {\n      const devicePixelRatio = IsWindowObjectExist() ? window.devicePixelRatio || 1.0 : 1.0;\n      const changeRatio = this._lastDevicePixelRatio / devicePixelRatio;\n      this._lastDevicePixelRatio = devicePixelRatio;\n      this._hardwareScalingLevel *= changeRatio;\n    }\n    if (IsWindowObjectExist() && IsDocumentAvailable()) {\n      // make sure it is a Node object, and is a part of the document.\n      if (this._renderingCanvas) {\n        const boundingRect = this._renderingCanvas.getBoundingClientRect ? this._renderingCanvas.getBoundingClientRect() : {\n          // fallback to last solution in case the function doesn't exist\n          width: this._renderingCanvas.width * this._hardwareScalingLevel,\n          height: this._renderingCanvas.height * this._hardwareScalingLevel\n        };\n        width = this._renderingCanvas.clientWidth || boundingRect.width || this._renderingCanvas.width || 100;\n        height = this._renderingCanvas.clientHeight || boundingRect.height || this._renderingCanvas.height || 100;\n      } else {\n        width = window.innerWidth;\n        height = window.innerHeight;\n      }\n    } else {\n      width = this._renderingCanvas ? this._renderingCanvas.width : 100;\n      height = this._renderingCanvas ? this._renderingCanvas.height : 100;\n    }\n    this.setSize(width / this._hardwareScalingLevel, height / this._hardwareScalingLevel, forceSetSize);\n  }\n  /**\n   * Force a specific size of the canvas\n   * @param width defines the new canvas' width\n   * @param height defines the new canvas' height\n   * @param forceSetSize true to force setting the sizes of the underlying canvas\n   * @returns true if the size was changed\n   */\n  setSize(width, height) {\n    let forceSetSize = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    if (!this._renderingCanvas) {\n      return false;\n    }\n    width = width | 0;\n    height = height | 0;\n    if (!forceSetSize && this._renderingCanvas.width === width && this._renderingCanvas.height === height) {\n      return false;\n    }\n    this._renderingCanvas.width = width;\n    this._renderingCanvas.height = height;\n    return true;\n  }\n  /**\n   * Binds the frame buffer to the specified texture.\n   * @param rtWrapper The render target wrapper to render to\n   * @param faceIndex The face of the texture to render to in case of cube texture and if the render target wrapper is not a multi render target\n   * @param requiredWidth The width of the target to render to\n   * @param requiredHeight The height of the target to render to\n   * @param forceFullscreenViewport Forces the viewport to be the entire texture/screen if true\n   * @param lodLevel Defines the lod level to bind to the frame buffer\n   * @param layer Defines the 2d array index to bind to the frame buffer if the render target wrapper is not a multi render target\n   */\n  bindFramebuffer(rtWrapper) {\n    let faceIndex = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n    let requiredWidth = arguments.length > 2 ? arguments[2] : undefined;\n    let requiredHeight = arguments.length > 3 ? arguments[3] : undefined;\n    let forceFullscreenViewport = arguments.length > 4 ? arguments[4] : undefined;\n    let lodLevel = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : 0;\n    let layer = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : 0;\n    var _a, _b, _c, _d, _e, _f;\n    const webglRTWrapper = rtWrapper;\n    if (this._currentRenderTarget) {\n      this.unBindFramebuffer(this._currentRenderTarget);\n    }\n    this._currentRenderTarget = rtWrapper;\n    this._bindUnboundFramebuffer(webglRTWrapper._MSAAFramebuffer ? webglRTWrapper._MSAAFramebuffer : webglRTWrapper._framebuffer);\n    const gl = this._gl;\n    if (!rtWrapper.isMulti) {\n      if (rtWrapper.is2DArray) {\n        gl.framebufferTextureLayer(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, (_a = rtWrapper.texture._hardwareTexture) === null || _a === void 0 ? void 0 : _a.underlyingResource, lodLevel, layer);\n      } else if (rtWrapper.isCube) {\n        gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_CUBE_MAP_POSITIVE_X + faceIndex, (_b = rtWrapper.texture._hardwareTexture) === null || _b === void 0 ? void 0 : _b.underlyingResource, lodLevel);\n      } else if (webglRTWrapper._currentLOD !== lodLevel) {\n        gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, (_c = rtWrapper.texture._hardwareTexture) === null || _c === void 0 ? void 0 : _c.underlyingResource, lodLevel);\n        webglRTWrapper._currentLOD = lodLevel;\n      }\n    }\n    const depthStencilTexture = rtWrapper._depthStencilTexture;\n    if (depthStencilTexture) {\n      const attachment = rtWrapper._depthStencilTextureWithStencil ? gl.DEPTH_STENCIL_ATTACHMENT : gl.DEPTH_ATTACHMENT;\n      if (rtWrapper.is2DArray) {\n        gl.framebufferTextureLayer(gl.FRAMEBUFFER, attachment, (_d = depthStencilTexture._hardwareTexture) === null || _d === void 0 ? void 0 : _d.underlyingResource, lodLevel, layer);\n      } else if (rtWrapper.isCube) {\n        gl.framebufferTexture2D(gl.FRAMEBUFFER, attachment, gl.TEXTURE_CUBE_MAP_POSITIVE_X + faceIndex, (_e = depthStencilTexture._hardwareTexture) === null || _e === void 0 ? void 0 : _e.underlyingResource, lodLevel);\n      } else {\n        gl.framebufferTexture2D(gl.FRAMEBUFFER, attachment, gl.TEXTURE_2D, (_f = depthStencilTexture._hardwareTexture) === null || _f === void 0 ? void 0 : _f.underlyingResource, lodLevel);\n      }\n    }\n    if (this._cachedViewport && !forceFullscreenViewport) {\n      this.setViewport(this._cachedViewport, requiredWidth, requiredHeight);\n    } else {\n      if (!requiredWidth) {\n        requiredWidth = rtWrapper.width;\n        if (lodLevel) {\n          requiredWidth = requiredWidth / Math.pow(2, lodLevel);\n        }\n      }\n      if (!requiredHeight) {\n        requiredHeight = rtWrapper.height;\n        if (lodLevel) {\n          requiredHeight = requiredHeight / Math.pow(2, lodLevel);\n        }\n      }\n      this._viewport(0, 0, requiredWidth, requiredHeight);\n    }\n    this.wipeCaches();\n  }\n  /**\n   * Set various states to the webGL context\n   * @param culling defines culling state: true to enable culling, false to disable it\n   * @param zOffset defines the value to apply to zOffset (0 by default)\n   * @param force defines if states must be applied even if cache is up to date\n   * @param reverseSide defines if culling must be reversed (CCW if false, CW if true)\n   * @param cullBackFaces true to cull back faces, false to cull front faces (if culling is enabled)\n   * @param stencil stencil states to set\n   * @param zOffsetUnits defines the value to apply to zOffsetUnits (0 by default)\n   */\n  setState(culling) {\n    let zOffset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n    let force = arguments.length > 2 ? arguments[2] : undefined;\n    let reverseSide = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n    let cullBackFaces = arguments.length > 4 ? arguments[4] : undefined;\n    let stencil = arguments.length > 5 ? arguments[5] : undefined;\n    let zOffsetUnits = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : 0;\n    var _a, _b;\n    // Culling\n    if (this._depthCullingState.cull !== culling || force) {\n      this._depthCullingState.cull = culling;\n    }\n    // Cull face\n    const cullFace = ((_b = (_a = this.cullBackFaces) !== null && _a !== void 0 ? _a : cullBackFaces) !== null && _b !== void 0 ? _b : true) ? this._gl.BACK : this._gl.FRONT;\n    if (this._depthCullingState.cullFace !== cullFace || force) {\n      this._depthCullingState.cullFace = cullFace;\n    }\n    // Z offset\n    this.setZOffset(zOffset);\n    this.setZOffsetUnits(zOffsetUnits);\n    // Front face\n    const frontFace = reverseSide ? this._gl.CW : this._gl.CCW;\n    if (this._depthCullingState.frontFace !== frontFace || force) {\n      this._depthCullingState.frontFace = frontFace;\n    }\n    this._stencilStateComposer.stencilMaterial = stencil;\n  }\n  /**\n   * Gets a boolean indicating if depth testing is enabled\n   * @returns the current state\n   */\n  getDepthBuffer() {\n    return this._depthCullingState.depthTest;\n  }\n  /**\n   * Enable or disable depth buffering\n   * @param enable defines the state to set\n   */\n  setDepthBuffer(enable) {\n    this._depthCullingState.depthTest = enable;\n  }\n  /**\n   * Set the z offset Factor to apply to current rendering\n   * @param value defines the offset to apply\n   */\n  setZOffset(value) {\n    this._depthCullingState.zOffset = this.useReverseDepthBuffer ? -value : value;\n  }\n  /**\n   * Gets the current value of the zOffset Factor\n   * @returns the current zOffset Factor state\n   */\n  getZOffset() {\n    const zOffset = this._depthCullingState.zOffset;\n    return this.useReverseDepthBuffer ? -zOffset : zOffset;\n  }\n  /**\n   * Set the z offset Units to apply to current rendering\n   * @param value defines the offset to apply\n   */\n  setZOffsetUnits(value) {\n    this._depthCullingState.zOffsetUnits = this.useReverseDepthBuffer ? -value : value;\n  }\n  /**\n   * Gets the current value of the zOffset Units\n   * @returns the current zOffset Units state\n   */\n  getZOffsetUnits() {\n    const zOffsetUnits = this._depthCullingState.zOffsetUnits;\n    return this.useReverseDepthBuffer ? -zOffsetUnits : zOffsetUnits;\n  }\n  /**\n   * @internal\n   */\n  _bindUnboundFramebuffer(framebuffer) {\n    if (this._currentFramebuffer !== framebuffer) {\n      this._gl.bindFramebuffer(this._gl.FRAMEBUFFER, framebuffer);\n      this._currentFramebuffer = framebuffer;\n    }\n  }\n  /** @internal */\n  _currentFrameBufferIsDefaultFrameBuffer() {\n    return this._currentFramebuffer === null;\n  }\n  /**\n   * Generates the mipmaps for a texture\n   * @param texture texture to generate the mipmaps for\n   */\n  generateMipmaps(texture) {\n    this._bindTextureDirectly(this._gl.TEXTURE_2D, texture, true);\n    this._gl.generateMipmap(this._gl.TEXTURE_2D);\n    this._bindTextureDirectly(this._gl.TEXTURE_2D, null);\n  }\n  /**\n   * Unbind the current render target texture from the webGL context\n   * @param texture defines the render target wrapper to unbind\n   * @param disableGenerateMipMaps defines a boolean indicating that mipmaps must not be generated\n   * @param onBeforeUnbind defines a function which will be called before the effective unbind\n   */\n  unBindFramebuffer(texture) {\n    let disableGenerateMipMaps = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n    let onBeforeUnbind = arguments.length > 2 ? arguments[2] : undefined;\n    var _a;\n    const webglRTWrapper = texture;\n    this._currentRenderTarget = null;\n    // If MSAA, we need to bitblt back to main texture\n    const gl = this._gl;\n    if (webglRTWrapper._MSAAFramebuffer) {\n      if (texture.isMulti) {\n        // This texture is part of a MRT texture, we need to treat all attachments\n        this.unBindMultiColorAttachmentFramebuffer(texture, disableGenerateMipMaps, onBeforeUnbind);\n        return;\n      }\n      gl.bindFramebuffer(gl.READ_FRAMEBUFFER, webglRTWrapper._MSAAFramebuffer);\n      gl.bindFramebuffer(gl.DRAW_FRAMEBUFFER, webglRTWrapper._framebuffer);\n      gl.blitFramebuffer(0, 0, texture.width, texture.height, 0, 0, texture.width, texture.height, gl.COLOR_BUFFER_BIT, gl.NEAREST);\n    }\n    if (((_a = texture.texture) === null || _a === void 0 ? void 0 : _a.generateMipMaps) && !disableGenerateMipMaps && !texture.isCube) {\n      this.generateMipmaps(texture.texture);\n    }\n    if (onBeforeUnbind) {\n      if (webglRTWrapper._MSAAFramebuffer) {\n        // Bind the correct framebuffer\n        this._bindUnboundFramebuffer(webglRTWrapper._framebuffer);\n      }\n      onBeforeUnbind();\n    }\n    this._bindUnboundFramebuffer(null);\n  }\n  /**\n   * Force a webGL flush (ie. a flush of all waiting webGL commands)\n   */\n  flushFramebuffer() {\n    this._gl.flush();\n  }\n  /**\n   * Unbind the current render target and bind the default framebuffer\n   */\n  restoreDefaultFramebuffer() {\n    if (this._currentRenderTarget) {\n      this.unBindFramebuffer(this._currentRenderTarget);\n    } else {\n      this._bindUnboundFramebuffer(null);\n    }\n    if (this._cachedViewport) {\n      this.setViewport(this._cachedViewport);\n    }\n    this.wipeCaches();\n  }\n  // VBOs\n  /** @internal */\n  _resetVertexBufferBinding() {\n    this.bindArrayBuffer(null);\n    this._cachedVertexBuffers = null;\n  }\n  /**\n   * Creates a vertex buffer\n   * @param data the data for the vertex buffer\n   * @param _updatable whether the buffer should be created as updatable\n   * @param _label defines the label of the buffer (for debug purpose)\n   * @returns the new WebGL static buffer\n   */\n  createVertexBuffer(data, _updatable, _label) {\n    return this._createVertexBuffer(data, this._gl.STATIC_DRAW);\n  }\n  _createVertexBuffer(data, usage) {\n    const vbo = this._gl.createBuffer();\n    if (!vbo) {\n      throw new Error(\"Unable to create vertex buffer\");\n    }\n    const dataBuffer = new WebGLDataBuffer(vbo);\n    this.bindArrayBuffer(dataBuffer);\n    if (data instanceof Array) {\n      this._gl.bufferData(this._gl.ARRAY_BUFFER, new Float32Array(data), usage);\n    } else {\n      this._gl.bufferData(this._gl.ARRAY_BUFFER, data, usage);\n    }\n    this._resetVertexBufferBinding();\n    dataBuffer.references = 1;\n    return dataBuffer;\n  }\n  /**\n   * Creates a dynamic vertex buffer\n   * @param data the data for the dynamic vertex buffer\n   * @param _label defines the label of the buffer (for debug purpose)\n   * @returns the new WebGL dynamic buffer\n   */\n  createDynamicVertexBuffer(data, _label) {\n    return this._createVertexBuffer(data, this._gl.DYNAMIC_DRAW);\n  }\n  _resetIndexBufferBinding() {\n    this.bindIndexBuffer(null);\n    this._cachedIndexBuffer = null;\n  }\n  /**\n   * Creates a new index buffer\n   * @param indices defines the content of the index buffer\n   * @param updatable defines if the index buffer must be updatable\n   * @param _label defines the label of the buffer (for debug purpose)\n   * @returns a new webGL buffer\n   */\n  createIndexBuffer(indices, updatable, _label) {\n    const vbo = this._gl.createBuffer();\n    const dataBuffer = new WebGLDataBuffer(vbo);\n    if (!vbo) {\n      throw new Error(\"Unable to create index buffer\");\n    }\n    this.bindIndexBuffer(dataBuffer);\n    const data = this._normalizeIndexData(indices);\n    this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER, data, updatable ? this._gl.DYNAMIC_DRAW : this._gl.STATIC_DRAW);\n    this._resetIndexBufferBinding();\n    dataBuffer.references = 1;\n    dataBuffer.is32Bits = data.BYTES_PER_ELEMENT === 4;\n    return dataBuffer;\n  }\n  _normalizeIndexData(indices) {\n    const bytesPerElement = indices.BYTES_PER_ELEMENT;\n    if (bytesPerElement === 2) {\n      return indices;\n    }\n    // Check 32 bit support\n    if (this._caps.uintIndices) {\n      if (indices instanceof Uint32Array) {\n        return indices;\n      } else {\n        // number[] or Int32Array, check if 32 bit is necessary\n        for (let index = 0; index < indices.length; index++) {\n          if (indices[index] >= 65535) {\n            return new Uint32Array(indices);\n          }\n        }\n        return new Uint16Array(indices);\n      }\n    }\n    // No 32 bit support, force conversion to 16 bit (values greater 16 bit are lost)\n    return new Uint16Array(indices);\n  }\n  /**\n   * Bind a webGL buffer to the webGL context\n   * @param buffer defines the buffer to bind\n   */\n  bindArrayBuffer(buffer) {\n    if (!this._vaoRecordInProgress) {\n      this._unbindVertexArrayObject();\n    }\n    this._bindBuffer(buffer, this._gl.ARRAY_BUFFER);\n  }\n  /**\n   * Bind a specific block at a given index in a specific shader program\n   * @param pipelineContext defines the pipeline context to use\n   * @param blockName defines the block name\n   * @param index defines the index where to bind the block\n   */\n  bindUniformBlock(pipelineContext, blockName, index) {\n    const program = pipelineContext.program;\n    const uniformLocation = this._gl.getUniformBlockIndex(program, blockName);\n    this._gl.uniformBlockBinding(program, uniformLocation, index);\n  }\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  bindIndexBuffer(buffer) {\n    if (!this._vaoRecordInProgress) {\n      this._unbindVertexArrayObject();\n    }\n    this._bindBuffer(buffer, this._gl.ELEMENT_ARRAY_BUFFER);\n  }\n  _bindBuffer(buffer, target) {\n    if (this._vaoRecordInProgress || this._currentBoundBuffer[target] !== buffer) {\n      this._gl.bindBuffer(target, buffer ? buffer.underlyingResource : null);\n      this._currentBoundBuffer[target] = buffer;\n    }\n  }\n  /**\n   * update the bound buffer with the given data\n   * @param data defines the data to update\n   */\n  updateArrayBuffer(data) {\n    this._gl.bufferSubData(this._gl.ARRAY_BUFFER, 0, data);\n  }\n  _vertexAttribPointer(buffer, indx, size, type, normalized, stride, offset) {\n    const pointer = this._currentBufferPointers[indx];\n    if (!pointer) {\n      return;\n    }\n    let changed = false;\n    if (!pointer.active) {\n      changed = true;\n      pointer.active = true;\n      pointer.index = indx;\n      pointer.size = size;\n      pointer.type = type;\n      pointer.normalized = normalized;\n      pointer.stride = stride;\n      pointer.offset = offset;\n      pointer.buffer = buffer;\n    } else {\n      if (pointer.buffer !== buffer) {\n        pointer.buffer = buffer;\n        changed = true;\n      }\n      if (pointer.size !== size) {\n        pointer.size = size;\n        changed = true;\n      }\n      if (pointer.type !== type) {\n        pointer.type = type;\n        changed = true;\n      }\n      if (pointer.normalized !== normalized) {\n        pointer.normalized = normalized;\n        changed = true;\n      }\n      if (pointer.stride !== stride) {\n        pointer.stride = stride;\n        changed = true;\n      }\n      if (pointer.offset !== offset) {\n        pointer.offset = offset;\n        changed = true;\n      }\n    }\n    if (changed || this._vaoRecordInProgress) {\n      this.bindArrayBuffer(buffer);\n      if (type === this._gl.UNSIGNED_INT || type === this._gl.INT) {\n        this._gl.vertexAttribIPointer(indx, size, type, stride, offset);\n      } else {\n        this._gl.vertexAttribPointer(indx, size, type, normalized, stride, offset);\n      }\n    }\n  }\n  /**\n   * @internal\n   */\n  _bindIndexBufferWithCache(indexBuffer) {\n    if (indexBuffer == null) {\n      return;\n    }\n    if (this._cachedIndexBuffer !== indexBuffer) {\n      this._cachedIndexBuffer = indexBuffer;\n      this.bindIndexBuffer(indexBuffer);\n      this._uintIndicesCurrentlySet = indexBuffer.is32Bits;\n    }\n  }\n  _bindVertexBuffersAttributes(vertexBuffers, effect, overrideVertexBuffers) {\n    const attributes = effect.getAttributesNames();\n    if (!this._vaoRecordInProgress) {\n      this._unbindVertexArrayObject();\n    }\n    this.unbindAllAttributes();\n    for (let index = 0; index < attributes.length; index++) {\n      const order = effect.getAttributeLocation(index);\n      if (order >= 0) {\n        const ai = attributes[index];\n        let vertexBuffer = null;\n        if (overrideVertexBuffers) {\n          vertexBuffer = overrideVertexBuffers[ai];\n        }\n        if (!vertexBuffer) {\n          vertexBuffer = vertexBuffers[ai];\n        }\n        if (!vertexBuffer) {\n          continue;\n        }\n        this._gl.enableVertexAttribArray(order);\n        if (!this._vaoRecordInProgress) {\n          this._vertexAttribArraysEnabled[order] = true;\n        }\n        const buffer = vertexBuffer.getBuffer();\n        if (buffer) {\n          this._vertexAttribPointer(buffer, order, vertexBuffer.getSize(), vertexBuffer.type, vertexBuffer.normalized, vertexBuffer.byteStride, vertexBuffer.byteOffset);\n          if (vertexBuffer.getIsInstanced()) {\n            this._gl.vertexAttribDivisor(order, vertexBuffer.getInstanceDivisor());\n            if (!this._vaoRecordInProgress) {\n              this._currentInstanceLocations.push(order);\n              this._currentInstanceBuffers.push(buffer);\n            }\n          }\n        }\n      }\n    }\n  }\n  /**\n   * Records a vertex array object\n   * @see https://doc.babylonjs.com/setup/support/webGL2#vertex-array-objects\n   * @param vertexBuffers defines the list of vertex buffers to store\n   * @param indexBuffer defines the index buffer to store\n   * @param effect defines the effect to store\n   * @param overrideVertexBuffers defines optional list of avertex buffers that overrides the entries in vertexBuffers\n   * @returns the new vertex array object\n   */\n  recordVertexArrayObject(vertexBuffers, indexBuffer, effect, overrideVertexBuffers) {\n    const vao = this._gl.createVertexArray();\n    if (!vao) {\n      throw new Error(\"Unable to create VAO\");\n    }\n    this._vaoRecordInProgress = true;\n    this._gl.bindVertexArray(vao);\n    this._mustWipeVertexAttributes = true;\n    this._bindVertexBuffersAttributes(vertexBuffers, effect, overrideVertexBuffers);\n    this.bindIndexBuffer(indexBuffer);\n    this._vaoRecordInProgress = false;\n    this._gl.bindVertexArray(null);\n    return vao;\n  }\n  /**\n   * Bind a specific vertex array object\n   * @see https://doc.babylonjs.com/setup/support/webGL2#vertex-array-objects\n   * @param vertexArrayObject defines the vertex array object to bind\n   * @param indexBuffer defines the index buffer to bind\n   */\n  bindVertexArrayObject(vertexArrayObject, indexBuffer) {\n    if (this._cachedVertexArrayObject !== vertexArrayObject) {\n      this._cachedVertexArrayObject = vertexArrayObject;\n      this._gl.bindVertexArray(vertexArrayObject);\n      this._cachedVertexBuffers = null;\n      this._cachedIndexBuffer = null;\n      this._uintIndicesCurrentlySet = indexBuffer != null && indexBuffer.is32Bits;\n      this._mustWipeVertexAttributes = true;\n    }\n  }\n  /**\n   * Bind webGl buffers directly to the webGL context\n   * @param vertexBuffer defines the vertex buffer to bind\n   * @param indexBuffer defines the index buffer to bind\n   * @param vertexDeclaration defines the vertex declaration to use with the vertex buffer\n   * @param vertexStrideSize defines the vertex stride of the vertex buffer\n   * @param effect defines the effect associated with the vertex buffer\n   */\n  bindBuffersDirectly(vertexBuffer, indexBuffer, vertexDeclaration, vertexStrideSize, effect) {\n    if (this._cachedVertexBuffers !== vertexBuffer || this._cachedEffectForVertexBuffers !== effect) {\n      this._cachedVertexBuffers = vertexBuffer;\n      this._cachedEffectForVertexBuffers = effect;\n      const attributesCount = effect.getAttributesCount();\n      this._unbindVertexArrayObject();\n      this.unbindAllAttributes();\n      let offset = 0;\n      for (let index = 0; index < attributesCount; index++) {\n        if (index < vertexDeclaration.length) {\n          const order = effect.getAttributeLocation(index);\n          if (order >= 0) {\n            this._gl.enableVertexAttribArray(order);\n            this._vertexAttribArraysEnabled[order] = true;\n            this._vertexAttribPointer(vertexBuffer, order, vertexDeclaration[index], this._gl.FLOAT, false, vertexStrideSize, offset);\n          }\n          offset += vertexDeclaration[index] * 4;\n        }\n      }\n    }\n    this._bindIndexBufferWithCache(indexBuffer);\n  }\n  _unbindVertexArrayObject() {\n    if (!this._cachedVertexArrayObject) {\n      return;\n    }\n    this._cachedVertexArrayObject = null;\n    this._gl.bindVertexArray(null);\n  }\n  /**\n   * Bind a list of vertex buffers to the webGL context\n   * @param vertexBuffers defines the list of vertex buffers to bind\n   * @param indexBuffer defines the index buffer to bind\n   * @param effect defines the effect associated with the vertex buffers\n   * @param overrideVertexBuffers defines optional list of avertex buffers that overrides the entries in vertexBuffers\n   */\n  bindBuffers(vertexBuffers, indexBuffer, effect, overrideVertexBuffers) {\n    if (this._cachedVertexBuffers !== vertexBuffers || this._cachedEffectForVertexBuffers !== effect) {\n      this._cachedVertexBuffers = vertexBuffers;\n      this._cachedEffectForVertexBuffers = effect;\n      this._bindVertexBuffersAttributes(vertexBuffers, effect, overrideVertexBuffers);\n    }\n    this._bindIndexBufferWithCache(indexBuffer);\n  }\n  /**\n   * Unbind all instance attributes\n   */\n  unbindInstanceAttributes() {\n    let boundBuffer;\n    for (let i = 0, ul = this._currentInstanceLocations.length; i < ul; i++) {\n      const instancesBuffer = this._currentInstanceBuffers[i];\n      if (boundBuffer != instancesBuffer && instancesBuffer.references) {\n        boundBuffer = instancesBuffer;\n        this.bindArrayBuffer(instancesBuffer);\n      }\n      const offsetLocation = this._currentInstanceLocations[i];\n      this._gl.vertexAttribDivisor(offsetLocation, 0);\n    }\n    this._currentInstanceBuffers.length = 0;\n    this._currentInstanceLocations.length = 0;\n  }\n  /**\n   * Release and free the memory of a vertex array object\n   * @param vao defines the vertex array object to delete\n   */\n  releaseVertexArrayObject(vao) {\n    this._gl.deleteVertexArray(vao);\n  }\n  /**\n   * @internal\n   */\n  _releaseBuffer(buffer) {\n    buffer.references--;\n    if (buffer.references === 0) {\n      this._deleteBuffer(buffer);\n      return true;\n    }\n    return false;\n  }\n  _deleteBuffer(buffer) {\n    this._gl.deleteBuffer(buffer.underlyingResource);\n  }\n  /**\n   * Update the content of a webGL buffer used with instantiation and bind it to the webGL context\n   * @param instancesBuffer defines the webGL buffer to update and bind\n   * @param data defines the data to store in the buffer\n   * @param offsetLocations defines the offsets or attributes information used to determine where data must be stored in the buffer\n   */\n  updateAndBindInstancesBuffer(instancesBuffer, data, offsetLocations) {\n    this.bindArrayBuffer(instancesBuffer);\n    if (data) {\n      this._gl.bufferSubData(this._gl.ARRAY_BUFFER, 0, data);\n    }\n    if (offsetLocations[0].index !== undefined) {\n      this.bindInstancesBuffer(instancesBuffer, offsetLocations, true);\n    } else {\n      for (let index = 0; index < 4; index++) {\n        const offsetLocation = offsetLocations[index];\n        if (!this._vertexAttribArraysEnabled[offsetLocation]) {\n          this._gl.enableVertexAttribArray(offsetLocation);\n          this._vertexAttribArraysEnabled[offsetLocation] = true;\n        }\n        this._vertexAttribPointer(instancesBuffer, offsetLocation, 4, this._gl.FLOAT, false, 64, index * 16);\n        this._gl.vertexAttribDivisor(offsetLocation, 1);\n        this._currentInstanceLocations.push(offsetLocation);\n        this._currentInstanceBuffers.push(instancesBuffer);\n      }\n    }\n  }\n  /**\n   * Bind the content of a webGL buffer used with instantiation\n   * @param instancesBuffer defines the webGL buffer to bind\n   * @param attributesInfo defines the offsets or attributes information used to determine where data must be stored in the buffer\n   * @param computeStride defines Whether to compute the strides from the info or use the default 0\n   */\n  bindInstancesBuffer(instancesBuffer, attributesInfo) {\n    let computeStride = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n    this.bindArrayBuffer(instancesBuffer);\n    let stride = 0;\n    if (computeStride) {\n      for (let i = 0; i < attributesInfo.length; i++) {\n        const ai = attributesInfo[i];\n        stride += ai.attributeSize * 4;\n      }\n    }\n    for (let i = 0; i < attributesInfo.length; i++) {\n      const ai = attributesInfo[i];\n      if (ai.index === undefined) {\n        ai.index = this._currentEffect.getAttributeLocationByName(ai.attributeName);\n      }\n      if (ai.index < 0) {\n        continue;\n      }\n      if (!this._vertexAttribArraysEnabled[ai.index]) {\n        this._gl.enableVertexAttribArray(ai.index);\n        this._vertexAttribArraysEnabled[ai.index] = true;\n      }\n      this._vertexAttribPointer(instancesBuffer, ai.index, ai.attributeSize, ai.attributeType || this._gl.FLOAT, ai.normalized || false, stride, ai.offset);\n      this._gl.vertexAttribDivisor(ai.index, ai.divisor === undefined ? 1 : ai.divisor);\n      this._currentInstanceLocations.push(ai.index);\n      this._currentInstanceBuffers.push(instancesBuffer);\n    }\n  }\n  /**\n   * Disable the instance attribute corresponding to the name in parameter\n   * @param name defines the name of the attribute to disable\n   */\n  disableInstanceAttributeByName(name) {\n    if (!this._currentEffect) {\n      return;\n    }\n    const attributeLocation = this._currentEffect.getAttributeLocationByName(name);\n    this.disableInstanceAttribute(attributeLocation);\n  }\n  /**\n   * Disable the instance attribute corresponding to the location in parameter\n   * @param attributeLocation defines the attribute location of the attribute to disable\n   */\n  disableInstanceAttribute(attributeLocation) {\n    let shouldClean = false;\n    let index;\n    while ((index = this._currentInstanceLocations.indexOf(attributeLocation)) !== -1) {\n      this._currentInstanceLocations.splice(index, 1);\n      this._currentInstanceBuffers.splice(index, 1);\n      shouldClean = true;\n      index = this._currentInstanceLocations.indexOf(attributeLocation);\n    }\n    if (shouldClean) {\n      this._gl.vertexAttribDivisor(attributeLocation, 0);\n      this.disableAttributeByIndex(attributeLocation);\n    }\n  }\n  /**\n   * Disable the attribute corresponding to the location in parameter\n   * @param attributeLocation defines the attribute location of the attribute to disable\n   */\n  disableAttributeByIndex(attributeLocation) {\n    this._gl.disableVertexAttribArray(attributeLocation);\n    this._vertexAttribArraysEnabled[attributeLocation] = false;\n    this._currentBufferPointers[attributeLocation].active = false;\n  }\n  /**\n   * Send a draw order\n   * @param useTriangles defines if triangles must be used to draw (else wireframe will be used)\n   * @param indexStart defines the starting index\n   * @param indexCount defines the number of index to draw\n   * @param instancesCount defines the number of instances to draw (if instantiation is enabled)\n   */\n  draw(useTriangles, indexStart, indexCount, instancesCount) {\n    this.drawElementsType(useTriangles ? 0 : 1, indexStart, indexCount, instancesCount);\n  }\n  /**\n   * Draw a list of points\n   * @param verticesStart defines the index of first vertex to draw\n   * @param verticesCount defines the count of vertices to draw\n   * @param instancesCount defines the number of instances to draw (if instantiation is enabled)\n   */\n  drawPointClouds(verticesStart, verticesCount, instancesCount) {\n    this.drawArraysType(2, verticesStart, verticesCount, instancesCount);\n  }\n  /**\n   * Draw a list of unindexed primitives\n   * @param useTriangles defines if triangles must be used to draw (else wireframe will be used)\n   * @param verticesStart defines the index of first vertex to draw\n   * @param verticesCount defines the count of vertices to draw\n   * @param instancesCount defines the number of instances to draw (if instantiation is enabled)\n   */\n  drawUnIndexed(useTriangles, verticesStart, verticesCount, instancesCount) {\n    this.drawArraysType(useTriangles ? 0 : 1, verticesStart, verticesCount, instancesCount);\n  }\n  /**\n   * Draw a list of indexed primitives\n   * @param fillMode defines the primitive to use\n   * @param indexStart defines the starting index\n   * @param indexCount defines the number of index to draw\n   * @param instancesCount defines the number of instances to draw (if instantiation is enabled)\n   */\n  drawElementsType(fillMode, indexStart, indexCount, instancesCount) {\n    // Apply states\n    this.applyStates();\n    this._reportDrawCall();\n    // Render\n    const drawMode = this._drawMode(fillMode);\n    const indexFormat = this._uintIndicesCurrentlySet ? this._gl.UNSIGNED_INT : this._gl.UNSIGNED_SHORT;\n    const mult = this._uintIndicesCurrentlySet ? 4 : 2;\n    if (instancesCount) {\n      this._gl.drawElementsInstanced(drawMode, indexCount, indexFormat, indexStart * mult, instancesCount);\n    } else {\n      this._gl.drawElements(drawMode, indexCount, indexFormat, indexStart * mult);\n    }\n  }\n  /**\n   * Draw a list of unindexed primitives\n   * @param fillMode defines the primitive to use\n   * @param verticesStart defines the index of first vertex to draw\n   * @param verticesCount defines the count of vertices to draw\n   * @param instancesCount defines the number of instances to draw (if instantiation is enabled)\n   */\n  drawArraysType(fillMode, verticesStart, verticesCount, instancesCount) {\n    // Apply states\n    this.applyStates();\n    this._reportDrawCall();\n    const drawMode = this._drawMode(fillMode);\n    if (instancesCount) {\n      this._gl.drawArraysInstanced(drawMode, verticesStart, verticesCount, instancesCount);\n    } else {\n      this._gl.drawArrays(drawMode, verticesStart, verticesCount);\n    }\n  }\n  _drawMode(fillMode) {\n    switch (fillMode) {\n      // Triangle views\n      case 0:\n        return this._gl.TRIANGLES;\n      case 2:\n        return this._gl.POINTS;\n      case 1:\n        return this._gl.LINES;\n      // Draw modes\n      case 3:\n        return this._gl.POINTS;\n      case 4:\n        return this._gl.LINES;\n      case 5:\n        return this._gl.LINE_LOOP;\n      case 6:\n        return this._gl.LINE_STRIP;\n      case 7:\n        return this._gl.TRIANGLE_STRIP;\n      case 8:\n        return this._gl.TRIANGLE_FAN;\n      default:\n        return this._gl.TRIANGLES;\n    }\n  }\n  /** @internal */\n  _reportDrawCall() {\n    // Will be implemented by children\n  }\n  // Shaders\n  /**\n   * @internal\n   */\n  _releaseEffect(effect) {\n    if (this._compiledEffects[effect._key]) {\n      delete this._compiledEffects[effect._key];\n    }\n    const pipelineContext = effect.getPipelineContext();\n    if (pipelineContext) {\n      this._deletePipelineContext(pipelineContext);\n    }\n  }\n  /**\n   * @internal\n   */\n  _deletePipelineContext(pipelineContext) {\n    const webGLPipelineContext = pipelineContext;\n    if (webGLPipelineContext && webGLPipelineContext.program) {\n      webGLPipelineContext.program.__SPECTOR_rebuildProgram = null;\n      this._gl.deleteProgram(webGLPipelineContext.program);\n    }\n  }\n  /** @internal */\n  _getGlobalDefines(defines) {\n    if (defines) {\n      if (this.isNDCHalfZRange) {\n        defines[\"IS_NDC_HALF_ZRANGE\"] = \"\";\n      } else {\n        delete defines[\"IS_NDC_HALF_ZRANGE\"];\n      }\n      if (this.useReverseDepthBuffer) {\n        defines[\"USE_REVERSE_DEPTHBUFFER\"] = \"\";\n      } else {\n        delete defines[\"USE_REVERSE_DEPTHBUFFER\"];\n      }\n      if (this.useExactSrgbConversions) {\n        defines[\"USE_EXACT_SRGB_CONVERSIONS\"] = \"\";\n      } else {\n        delete defines[\"USE_EXACT_SRGB_CONVERSIONS\"];\n      }\n      return;\n    } else {\n      let s = \"\";\n      if (this.isNDCHalfZRange) {\n        s += \"#define IS_NDC_HALF_ZRANGE\";\n      }\n      if (this.useReverseDepthBuffer) {\n        if (s) {\n          s += \"\\n\";\n        }\n        s += \"#define USE_REVERSE_DEPTHBUFFER\";\n      }\n      if (this.useExactSrgbConversions) {\n        if (s) {\n          s += \"\\n\";\n        }\n        s += \"#define USE_EXACT_SRGB_CONVERSIONS\";\n      }\n      return s;\n    }\n  }\n  /**\n   * Create a new effect (used to store vertex/fragment shaders)\n   * @param baseName defines the base name of the effect (The name of file without .fragment.fx or .vertex.fx)\n   * @param attributesNamesOrOptions defines either a list of attribute names or an IEffectCreationOptions object\n   * @param uniformsNamesOrEngine defines either a list of uniform names or the engine to use\n   * @param samplers defines an array of string used to represent textures\n   * @param defines defines the string containing the defines to use to compile the shaders\n   * @param fallbacks defines the list of potential fallbacks to use if shader compilation fails\n   * @param onCompiled defines a function to call when the effect creation is successful\n   * @param onError defines a function to call when the effect creation has failed\n   * @param indexParameters defines an object containing the index values to use to compile shaders (like the maximum number of simultaneous lights)\n   * @param shaderLanguage the language the shader is written in (default: GLSL)\n   * @returns the new Effect\n   */\n  createEffect(baseName, attributesNamesOrOptions, uniformsNamesOrEngine, samplers, defines, fallbacks, onCompiled, onError, indexParameters) {\n    let shaderLanguage = arguments.length > 9 && arguments[9] !== undefined ? arguments[9] : ShaderLanguage.GLSL;\n    var _a;\n    const vertex = baseName.vertexElement || baseName.vertex || baseName.vertexToken || baseName.vertexSource || baseName;\n    const fragment = baseName.fragmentElement || baseName.fragment || baseName.fragmentToken || baseName.fragmentSource || baseName;\n    const globalDefines = this._getGlobalDefines();\n    let fullDefines = (_a = defines !== null && defines !== void 0 ? defines : attributesNamesOrOptions.defines) !== null && _a !== void 0 ? _a : \"\";\n    if (globalDefines) {\n      fullDefines += globalDefines;\n    }\n    const name = vertex + \"+\" + fragment + \"@\" + fullDefines;\n    if (this._compiledEffects[name]) {\n      const compiledEffect = this._compiledEffects[name];\n      if (onCompiled && compiledEffect.isReady()) {\n        onCompiled(compiledEffect);\n      }\n      return compiledEffect;\n    }\n    const effect = new Effect(baseName, attributesNamesOrOptions, uniformsNamesOrEngine, samplers, this, defines, fallbacks, onCompiled, onError, indexParameters, name, shaderLanguage);\n    this._compiledEffects[name] = effect;\n    return effect;\n  }\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  static _ConcatenateShader(source, defines) {\n    let shaderVersion = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : \"\";\n    return shaderVersion + (defines ? defines + \"\\n\" : \"\") + source;\n  }\n  _compileShader(source, type, defines, shaderVersion) {\n    return this._compileRawShader(ThinEngine._ConcatenateShader(source, defines, shaderVersion), type);\n  }\n  _compileRawShader(source, type) {\n    const gl = this._gl;\n    const shader = gl.createShader(type === \"vertex\" ? gl.VERTEX_SHADER : gl.FRAGMENT_SHADER);\n    if (!shader) {\n      let error = gl.NO_ERROR;\n      let tempError = gl.NO_ERROR;\n      while ((tempError = gl.getError()) !== gl.NO_ERROR) {\n        error = tempError;\n      }\n      throw new Error(`Something went wrong while creating a gl ${type} shader object. gl error=${error}, gl isContextLost=${gl.isContextLost()}, _contextWasLost=${this._contextWasLost}`);\n    }\n    gl.shaderSource(shader, source);\n    gl.compileShader(shader);\n    return shader;\n  }\n  /**\n   * @internal\n   */\n  _getShaderSource(shader) {\n    return this._gl.getShaderSource(shader);\n  }\n  /**\n   * Directly creates a webGL program\n   * @param pipelineContext  defines the pipeline context to attach to\n   * @param vertexCode defines the vertex shader code to use\n   * @param fragmentCode defines the fragment shader code to use\n   * @param context defines the webGL context to use (if not set, the current one will be used)\n   * @param transformFeedbackVaryings defines the list of transform feedback varyings to use\n   * @returns the new webGL program\n   */\n  createRawShaderProgram(pipelineContext, vertexCode, fragmentCode, context) {\n    let transformFeedbackVaryings = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : null;\n    context = context || this._gl;\n    const vertexShader = this._compileRawShader(vertexCode, \"vertex\");\n    const fragmentShader = this._compileRawShader(fragmentCode, \"fragment\");\n    return this._createShaderProgram(pipelineContext, vertexShader, fragmentShader, context, transformFeedbackVaryings);\n  }\n  /**\n   * Creates a webGL program\n   * @param pipelineContext  defines the pipeline context to attach to\n   * @param vertexCode  defines the vertex shader code to use\n   * @param fragmentCode defines the fragment shader code to use\n   * @param defines defines the string containing the defines to use to compile the shaders\n   * @param context defines the webGL context to use (if not set, the current one will be used)\n   * @param transformFeedbackVaryings defines the list of transform feedback varyings to use\n   * @returns the new webGL program\n   */\n  createShaderProgram(pipelineContext, vertexCode, fragmentCode, defines, context) {\n    let transformFeedbackVaryings = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : null;\n    context = context || this._gl;\n    const shaderVersion = this._webGLVersion > 1 ? \"#version 300 es\\n#define WEBGL2 \\n\" : \"\";\n    const vertexShader = this._compileShader(vertexCode, \"vertex\", defines, shaderVersion);\n    const fragmentShader = this._compileShader(fragmentCode, \"fragment\", defines, shaderVersion);\n    return this._createShaderProgram(pipelineContext, vertexShader, fragmentShader, context, transformFeedbackVaryings);\n  }\n  /**\n   * Inline functions in shader code that are marked to be inlined\n   * @param code code to inline\n   * @returns inlined code\n   */\n  inlineShaderCode(code) {\n    // no inlining needed in the WebGL engine\n    return code;\n  }\n  /**\n   * Creates a new pipeline context\n   * @param shaderProcessingContext defines the shader processing context used during the processing if available\n   * @returns the new pipeline\n   */\n  createPipelineContext(shaderProcessingContext) {\n    const pipelineContext = new WebGLPipelineContext();\n    pipelineContext.engine = this;\n    if (this._caps.parallelShaderCompile) {\n      pipelineContext.isParallelCompiled = true;\n    }\n    return pipelineContext;\n  }\n  /**\n   * Creates a new material context\n   * @returns the new context\n   */\n  createMaterialContext() {\n    return undefined;\n  }\n  /**\n   * Creates a new draw context\n   * @returns the new context\n   */\n  createDrawContext() {\n    return undefined;\n  }\n  _createShaderProgram(pipelineContext, vertexShader, fragmentShader, context) {\n    let transformFeedbackVaryings = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : null;\n    const shaderProgram = context.createProgram();\n    pipelineContext.program = shaderProgram;\n    if (!shaderProgram) {\n      throw new Error(\"Unable to create program\");\n    }\n    context.attachShader(shaderProgram, vertexShader);\n    context.attachShader(shaderProgram, fragmentShader);\n    context.linkProgram(shaderProgram);\n    pipelineContext.context = context;\n    pipelineContext.vertexShader = vertexShader;\n    pipelineContext.fragmentShader = fragmentShader;\n    if (!pipelineContext.isParallelCompiled) {\n      this._finalizePipelineContext(pipelineContext);\n    }\n    return shaderProgram;\n  }\n  _finalizePipelineContext(pipelineContext) {\n    const context = pipelineContext.context;\n    const vertexShader = pipelineContext.vertexShader;\n    const fragmentShader = pipelineContext.fragmentShader;\n    const program = pipelineContext.program;\n    const linked = context.getProgramParameter(program, context.LINK_STATUS);\n    if (!linked) {\n      // Get more info\n      // Vertex\n      if (!this._gl.getShaderParameter(vertexShader, this._gl.COMPILE_STATUS)) {\n        const log = this._gl.getShaderInfoLog(vertexShader);\n        if (log) {\n          pipelineContext.vertexCompilationError = log;\n          throw new Error(\"VERTEX SHADER \" + log);\n        }\n      }\n      // Fragment\n      if (!this._gl.getShaderParameter(fragmentShader, this._gl.COMPILE_STATUS)) {\n        const log = this._gl.getShaderInfoLog(fragmentShader);\n        if (log) {\n          pipelineContext.fragmentCompilationError = log;\n          throw new Error(\"FRAGMENT SHADER \" + log);\n        }\n      }\n      const error = context.getProgramInfoLog(program);\n      if (error) {\n        pipelineContext.programLinkError = error;\n        throw new Error(error);\n      }\n    }\n    if (this.validateShaderPrograms) {\n      context.validateProgram(program);\n      const validated = context.getProgramParameter(program, context.VALIDATE_STATUS);\n      if (!validated) {\n        const error = context.getProgramInfoLog(program);\n        if (error) {\n          pipelineContext.programValidationError = error;\n          throw new Error(error);\n        }\n      }\n    }\n    context.deleteShader(vertexShader);\n    context.deleteShader(fragmentShader);\n    pipelineContext.vertexShader = undefined;\n    pipelineContext.fragmentShader = undefined;\n    if (pipelineContext.onCompiled) {\n      pipelineContext.onCompiled();\n      pipelineContext.onCompiled = undefined;\n    }\n  }\n  /**\n   * @internal\n   */\n  _preparePipelineContext(pipelineContext, vertexSourceCode, fragmentSourceCode, createAsRaw, rawVertexSourceCode, rawFragmentSourceCode, rebuildRebind, defines, transformFeedbackVaryings, key) {\n    const webGLRenderingState = pipelineContext;\n    if (createAsRaw) {\n      webGLRenderingState.program = this.createRawShaderProgram(webGLRenderingState, vertexSourceCode, fragmentSourceCode, undefined, transformFeedbackVaryings);\n    } else {\n      webGLRenderingState.program = this.createShaderProgram(webGLRenderingState, vertexSourceCode, fragmentSourceCode, defines, undefined, transformFeedbackVaryings);\n    }\n    webGLRenderingState.program.__SPECTOR_rebuildProgram = rebuildRebind;\n  }\n  /**\n   * @internal\n   */\n  _isRenderingStateCompiled(pipelineContext) {\n    const webGLPipelineContext = pipelineContext;\n    if (this._isDisposed || webGLPipelineContext._isDisposed) {\n      return false;\n    }\n    if (this._gl.getProgramParameter(webGLPipelineContext.program, this._caps.parallelShaderCompile.COMPLETION_STATUS_KHR)) {\n      this._finalizePipelineContext(webGLPipelineContext);\n      return true;\n    }\n    return false;\n  }\n  /**\n   * @internal\n   */\n  _executeWhenRenderingStateIsCompiled(pipelineContext, action) {\n    const webGLPipelineContext = pipelineContext;\n    if (!webGLPipelineContext.isParallelCompiled) {\n      action();\n      return;\n    }\n    const oldHandler = webGLPipelineContext.onCompiled;\n    if (oldHandler) {\n      webGLPipelineContext.onCompiled = () => {\n        oldHandler();\n        action();\n      };\n    } else {\n      webGLPipelineContext.onCompiled = action;\n    }\n  }\n  /**\n   * Gets the list of webGL uniform locations associated with a specific program based on a list of uniform names\n   * @param pipelineContext defines the pipeline context to use\n   * @param uniformsNames defines the list of uniform names\n   * @returns an array of webGL uniform locations\n   */\n  getUniforms(pipelineContext, uniformsNames) {\n    const results = new Array();\n    const webGLPipelineContext = pipelineContext;\n    for (let index = 0; index < uniformsNames.length; index++) {\n      results.push(this._gl.getUniformLocation(webGLPipelineContext.program, uniformsNames[index]));\n    }\n    return results;\n  }\n  /**\n   * Gets the list of active attributes for a given webGL program\n   * @param pipelineContext defines the pipeline context to use\n   * @param attributesNames defines the list of attribute names to get\n   * @returns an array of indices indicating the offset of each attribute\n   */\n  getAttributes(pipelineContext, attributesNames) {\n    const results = [];\n    const webGLPipelineContext = pipelineContext;\n    for (let index = 0; index < attributesNames.length; index++) {\n      try {\n        results.push(this._gl.getAttribLocation(webGLPipelineContext.program, attributesNames[index]));\n      } catch (e) {\n        results.push(-1);\n      }\n    }\n    return results;\n  }\n  /**\n   * Activates an effect, making it the current one (ie. the one used for rendering)\n   * @param effect defines the effect to activate\n   */\n  enableEffect(effect) {\n    effect = effect !== null && DrawWrapper.IsWrapper(effect) ? effect.effect : effect; // get only the effect, we don't need a Wrapper in the WebGL engine\n    if (!effect || effect === this._currentEffect) {\n      return;\n    }\n    this._stencilStateComposer.stencilMaterial = undefined;\n    effect = effect;\n    // Use program\n    this.bindSamplers(effect);\n    this._currentEffect = effect;\n    if (effect.onBind) {\n      effect.onBind(effect);\n    }\n    if (effect._onBindObservable) {\n      effect._onBindObservable.notifyObservers(effect);\n    }\n  }\n  /**\n   * Set the value of an uniform to a number (int)\n   * @param uniform defines the webGL uniform location where to store the value\n   * @param value defines the int number to store\n   * @returns true if the value was set\n   */\n  setInt(uniform, value) {\n    if (!uniform) {\n      return false;\n    }\n    this._gl.uniform1i(uniform, value);\n    return true;\n  }\n  /**\n   * Set the value of an uniform to a int2\n   * @param uniform defines the webGL uniform location where to store the value\n   * @param x defines the 1st component of the value\n   * @param y defines the 2nd component of the value\n   * @returns true if the value was set\n   */\n  setInt2(uniform, x, y) {\n    if (!uniform) {\n      return false;\n    }\n    this._gl.uniform2i(uniform, x, y);\n    return true;\n  }\n  /**\n   * Set the value of an uniform to a int3\n   * @param uniform defines the webGL uniform location where to store the value\n   * @param x defines the 1st component of the value\n   * @param y defines the 2nd component of the value\n   * @param z defines the 3rd component of the value\n   * @returns true if the value was set\n   */\n  setInt3(uniform, x, y, z) {\n    if (!uniform) {\n      return false;\n    }\n    this._gl.uniform3i(uniform, x, y, z);\n    return true;\n  }\n  /**\n   * Set the value of an uniform to a int4\n   * @param uniform defines the webGL uniform location where to store the value\n   * @param x defines the 1st component of the value\n   * @param y defines the 2nd component of the value\n   * @param z defines the 3rd component of the value\n   * @param w defines the 4th component of the value\n   * @returns true if the value was set\n   */\n  setInt4(uniform, x, y, z, w) {\n    if (!uniform) {\n      return false;\n    }\n    this._gl.uniform4i(uniform, x, y, z, w);\n    return true;\n  }\n  /**\n   * Set the value of an uniform to an array of int32\n   * @param uniform defines the webGL uniform location where to store the value\n   * @param array defines the array of int32 to store\n   * @returns true if the value was set\n   */\n  setIntArray(uniform, array) {\n    if (!uniform) {\n      return false;\n    }\n    this._gl.uniform1iv(uniform, array);\n    return true;\n  }\n  /**\n   * Set the value of an uniform to an array of int32 (stored as vec2)\n   * @param uniform defines the webGL uniform location where to store the value\n   * @param array defines the array of int32 to store\n   * @returns true if the value was set\n   */\n  setIntArray2(uniform, array) {\n    if (!uniform || array.length % 2 !== 0) {\n      return false;\n    }\n    this._gl.uniform2iv(uniform, array);\n    return true;\n  }\n  /**\n   * Set the value of an uniform to an array of int32 (stored as vec3)\n   * @param uniform defines the webGL uniform location where to store the value\n   * @param array defines the array of int32 to store\n   * @returns true if the value was set\n   */\n  setIntArray3(uniform, array) {\n    if (!uniform || array.length % 3 !== 0) {\n      return false;\n    }\n    this._gl.uniform3iv(uniform, array);\n    return true;\n  }\n  /**\n   * Set the value of an uniform to an array of int32 (stored as vec4)\n   * @param uniform defines the webGL uniform location where to store the value\n   * @param array defines the array of int32 to store\n   * @returns true if the value was set\n   */\n  setIntArray4(uniform, array) {\n    if (!uniform || array.length % 4 !== 0) {\n      return false;\n    }\n    this._gl.uniform4iv(uniform, array);\n    return true;\n  }\n  /**\n   * Set the value of an uniform to a number (unsigned int)\n   * @param uniform defines the webGL uniform location where to store the value\n   * @param value defines the unsigned int number to store\n   * @returns true if the value was set\n   */\n  setUInt(uniform, value) {\n    if (!uniform) {\n      return false;\n    }\n    this._gl.uniform1ui(uniform, value);\n    return true;\n  }\n  /**\n   * Set the value of an uniform to a unsigned int2\n   * @param uniform defines the webGL uniform location where to store the value\n   * @param x defines the 1st component of the value\n   * @param y defines the 2nd component of the value\n   * @returns true if the value was set\n   */\n  setUInt2(uniform, x, y) {\n    if (!uniform) {\n      return false;\n    }\n    this._gl.uniform2ui(uniform, x, y);\n    return true;\n  }\n  /**\n   * Set the value of an uniform to a unsigned int3\n   * @param uniform defines the webGL uniform location where to store the value\n   * @param x defines the 1st component of the value\n   * @param y defines the 2nd component of the value\n   * @param z defines the 3rd component of the value\n   * @returns true if the value was set\n   */\n  setUInt3(uniform, x, y, z) {\n    if (!uniform) {\n      return false;\n    }\n    this._gl.uniform3ui(uniform, x, y, z);\n    return true;\n  }\n  /**\n   * Set the value of an uniform to a unsigned int4\n   * @param uniform defines the webGL uniform location where to store the value\n   * @param x defines the 1st component of the value\n   * @param y defines the 2nd component of the value\n   * @param z defines the 3rd component of the value\n   * @param w defines the 4th component of the value\n   * @returns true if the value was set\n   */\n  setUInt4(uniform, x, y, z, w) {\n    if (!uniform) {\n      return false;\n    }\n    this._gl.uniform4ui(uniform, x, y, z, w);\n    return true;\n  }\n  /**\n   * Set the value of an uniform to an array of unsigned int32\n   * @param uniform defines the webGL uniform location where to store the value\n   * @param array defines the array of unsigned int32 to store\n   * @returns true if the value was set\n   */\n  setUIntArray(uniform, array) {\n    if (!uniform) {\n      return false;\n    }\n    this._gl.uniform1uiv(uniform, array);\n    return true;\n  }\n  /**\n   * Set the value of an uniform to an array of unsigned int32 (stored as vec2)\n   * @param uniform defines the webGL uniform location where to store the value\n   * @param array defines the array of unsigned int32 to store\n   * @returns true if the value was set\n   */\n  setUIntArray2(uniform, array) {\n    if (!uniform || array.length % 2 !== 0) {\n      return false;\n    }\n    this._gl.uniform2uiv(uniform, array);\n    return true;\n  }\n  /**\n   * Set the value of an uniform to an array of unsigned int32 (stored as vec3)\n   * @param uniform defines the webGL uniform location where to store the value\n   * @param array defines the array of unsigned int32 to store\n   * @returns true if the value was set\n   */\n  setUIntArray3(uniform, array) {\n    if (!uniform || array.length % 3 !== 0) {\n      return false;\n    }\n    this._gl.uniform3uiv(uniform, array);\n    return true;\n  }\n  /**\n   * Set the value of an uniform to an array of unsigned int32 (stored as vec4)\n   * @param uniform defines the webGL uniform location where to store the value\n   * @param array defines the array of unsigned int32 to store\n   * @returns true if the value was set\n   */\n  setUIntArray4(uniform, array) {\n    if (!uniform || array.length % 4 !== 0) {\n      return false;\n    }\n    this._gl.uniform4uiv(uniform, array);\n    return true;\n  }\n  /**\n   * Set the value of an uniform to an array of number\n   * @param uniform defines the webGL uniform location where to store the value\n   * @param array defines the array of number to store\n   * @returns true if the value was set\n   */\n  setArray(uniform, array) {\n    if (!uniform) {\n      return false;\n    }\n    if (array.length < 1) {\n      return false;\n    }\n    this._gl.uniform1fv(uniform, array);\n    return true;\n  }\n  /**\n   * Set the value of an uniform to an array of number (stored as vec2)\n   * @param uniform defines the webGL uniform location where to store the value\n   * @param array defines the array of number to store\n   * @returns true if the value was set\n   */\n  setArray2(uniform, array) {\n    if (!uniform || array.length % 2 !== 0) {\n      return false;\n    }\n    this._gl.uniform2fv(uniform, array);\n    return true;\n  }\n  /**\n   * Set the value of an uniform to an array of number (stored as vec3)\n   * @param uniform defines the webGL uniform location where to store the value\n   * @param array defines the array of number to store\n   * @returns true if the value was set\n   */\n  setArray3(uniform, array) {\n    if (!uniform || array.length % 3 !== 0) {\n      return false;\n    }\n    this._gl.uniform3fv(uniform, array);\n    return true;\n  }\n  /**\n   * Set the value of an uniform to an array of number (stored as vec4)\n   * @param uniform defines the webGL uniform location where to store the value\n   * @param array defines the array of number to store\n   * @returns true if the value was set\n   */\n  setArray4(uniform, array) {\n    if (!uniform || array.length % 4 !== 0) {\n      return false;\n    }\n    this._gl.uniform4fv(uniform, array);\n    return true;\n  }\n  /**\n   * Set the value of an uniform to an array of float32 (stored as matrices)\n   * @param uniform defines the webGL uniform location where to store the value\n   * @param matrices defines the array of float32 to store\n   * @returns true if the value was set\n   */\n  setMatrices(uniform, matrices) {\n    if (!uniform) {\n      return false;\n    }\n    this._gl.uniformMatrix4fv(uniform, false, matrices);\n    return true;\n  }\n  /**\n   * Set the value of an uniform to a matrix (3x3)\n   * @param uniform defines the webGL uniform location where to store the value\n   * @param matrix defines the Float32Array representing the 3x3 matrix to store\n   * @returns true if the value was set\n   */\n  setMatrix3x3(uniform, matrix) {\n    if (!uniform) {\n      return false;\n    }\n    this._gl.uniformMatrix3fv(uniform, false, matrix);\n    return true;\n  }\n  /**\n   * Set the value of an uniform to a matrix (2x2)\n   * @param uniform defines the webGL uniform location where to store the value\n   * @param matrix defines the Float32Array representing the 2x2 matrix to store\n   * @returns true if the value was set\n   */\n  setMatrix2x2(uniform, matrix) {\n    if (!uniform) {\n      return false;\n    }\n    this._gl.uniformMatrix2fv(uniform, false, matrix);\n    return true;\n  }\n  /**\n   * Set the value of an uniform to a number (float)\n   * @param uniform defines the webGL uniform location where to store the value\n   * @param value defines the float number to store\n   * @returns true if the value was transferred\n   */\n  setFloat(uniform, value) {\n    if (!uniform) {\n      return false;\n    }\n    this._gl.uniform1f(uniform, value);\n    return true;\n  }\n  /**\n   * Set the value of an uniform to a vec2\n   * @param uniform defines the webGL uniform location where to store the value\n   * @param x defines the 1st component of the value\n   * @param y defines the 2nd component of the value\n   * @returns true if the value was set\n   */\n  setFloat2(uniform, x, y) {\n    if (!uniform) {\n      return false;\n    }\n    this._gl.uniform2f(uniform, x, y);\n    return true;\n  }\n  /**\n   * Set the value of an uniform to a vec3\n   * @param uniform defines the webGL uniform location where to store the value\n   * @param x defines the 1st component of the value\n   * @param y defines the 2nd component of the value\n   * @param z defines the 3rd component of the value\n   * @returns true if the value was set\n   */\n  setFloat3(uniform, x, y, z) {\n    if (!uniform) {\n      return false;\n    }\n    this._gl.uniform3f(uniform, x, y, z);\n    return true;\n  }\n  /**\n   * Set the value of an uniform to a vec4\n   * @param uniform defines the webGL uniform location where to store the value\n   * @param x defines the 1st component of the value\n   * @param y defines the 2nd component of the value\n   * @param z defines the 3rd component of the value\n   * @param w defines the 4th component of the value\n   * @returns true if the value was set\n   */\n  setFloat4(uniform, x, y, z, w) {\n    if (!uniform) {\n      return false;\n    }\n    this._gl.uniform4f(uniform, x, y, z, w);\n    return true;\n  }\n  // States\n  /**\n   * Apply all cached states (depth, culling, stencil and alpha)\n   */\n  applyStates() {\n    this._depthCullingState.apply(this._gl);\n    this._stencilStateComposer.apply(this._gl);\n    this._alphaState.apply(this._gl);\n    if (this._colorWriteChanged) {\n      this._colorWriteChanged = false;\n      const enable = this._colorWrite;\n      this._gl.colorMask(enable, enable, enable, enable);\n    }\n  }\n  /**\n   * Enable or disable color writing\n   * @param enable defines the state to set\n   */\n  setColorWrite(enable) {\n    if (enable !== this._colorWrite) {\n      this._colorWriteChanged = true;\n      this._colorWrite = enable;\n    }\n  }\n  /**\n   * Gets a boolean indicating if color writing is enabled\n   * @returns the current color writing state\n   */\n  getColorWrite() {\n    return this._colorWrite;\n  }\n  /**\n   * Gets the depth culling state manager\n   */\n  get depthCullingState() {\n    return this._depthCullingState;\n  }\n  /**\n   * Gets the alpha state manager\n   */\n  get alphaState() {\n    return this._alphaState;\n  }\n  /**\n   * Gets the stencil state manager\n   */\n  get stencilState() {\n    return this._stencilState;\n  }\n  /**\n   * Gets the stencil state composer\n   */\n  get stencilStateComposer() {\n    return this._stencilStateComposer;\n  }\n  // Textures\n  /**\n   * Clears the list of texture accessible through engine.\n   * This can help preventing texture load conflict due to name collision.\n   */\n  clearInternalTexturesCache() {\n    this._internalTexturesCache.length = 0;\n  }\n  /**\n   * Force the entire cache to be cleared\n   * You should not have to use this function unless your engine needs to share the webGL context with another engine\n   * @param bruteForce defines a boolean to force clearing ALL caches (including stencil, detoh and alpha states)\n   */\n  wipeCaches(bruteForce) {\n    if (this.preventCacheWipeBetweenFrames && !bruteForce) {\n      return;\n    }\n    this._currentEffect = null;\n    this._viewportCached.x = 0;\n    this._viewportCached.y = 0;\n    this._viewportCached.z = 0;\n    this._viewportCached.w = 0;\n    // Done before in case we clean the attributes\n    this._unbindVertexArrayObject();\n    if (bruteForce) {\n      this._currentProgram = null;\n      this.resetTextureCache();\n      this._stencilStateComposer.reset();\n      this._depthCullingState.reset();\n      this._depthCullingState.depthFunc = this._gl.LEQUAL;\n      this._alphaState.reset();\n      this._alphaMode = 1;\n      this._alphaEquation = 0;\n      this._colorWrite = true;\n      this._colorWriteChanged = true;\n      this._unpackFlipYCached = null;\n      this._gl.pixelStorei(this._gl.UNPACK_COLORSPACE_CONVERSION_WEBGL, this._gl.NONE);\n      this._gl.pixelStorei(this._gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, 0);\n      this._mustWipeVertexAttributes = true;\n      this.unbindAllAttributes();\n    }\n    this._resetVertexBufferBinding();\n    this._cachedIndexBuffer = null;\n    this._cachedEffectForVertexBuffers = null;\n    this.bindIndexBuffer(null);\n  }\n  /**\n   * @internal\n   */\n  _getSamplingParameters(samplingMode, generateMipMaps) {\n    const gl = this._gl;\n    let magFilter = gl.NEAREST;\n    let minFilter = gl.NEAREST;\n    switch (samplingMode) {\n      case 11:\n        magFilter = gl.LINEAR;\n        if (generateMipMaps) {\n          minFilter = gl.LINEAR_MIPMAP_NEAREST;\n        } else {\n          minFilter = gl.LINEAR;\n        }\n        break;\n      case 3:\n        magFilter = gl.LINEAR;\n        if (generateMipMaps) {\n          minFilter = gl.LINEAR_MIPMAP_LINEAR;\n        } else {\n          minFilter = gl.LINEAR;\n        }\n        break;\n      case 8:\n        magFilter = gl.NEAREST;\n        if (generateMipMaps) {\n          minFilter = gl.NEAREST_MIPMAP_LINEAR;\n        } else {\n          minFilter = gl.NEAREST;\n        }\n        break;\n      case 4:\n        magFilter = gl.NEAREST;\n        if (generateMipMaps) {\n          minFilter = gl.NEAREST_MIPMAP_NEAREST;\n        } else {\n          minFilter = gl.NEAREST;\n        }\n        break;\n      case 5:\n        magFilter = gl.NEAREST;\n        if (generateMipMaps) {\n          minFilter = gl.LINEAR_MIPMAP_NEAREST;\n        } else {\n          minFilter = gl.LINEAR;\n        }\n        break;\n      case 6:\n        magFilter = gl.NEAREST;\n        if (generateMipMaps) {\n          minFilter = gl.LINEAR_MIPMAP_LINEAR;\n        } else {\n          minFilter = gl.LINEAR;\n        }\n        break;\n      case 7:\n        magFilter = gl.NEAREST;\n        minFilter = gl.LINEAR;\n        break;\n      case 1:\n        magFilter = gl.NEAREST;\n        minFilter = gl.NEAREST;\n        break;\n      case 9:\n        magFilter = gl.LINEAR;\n        if (generateMipMaps) {\n          minFilter = gl.NEAREST_MIPMAP_NEAREST;\n        } else {\n          minFilter = gl.NEAREST;\n        }\n        break;\n      case 10:\n        magFilter = gl.LINEAR;\n        if (generateMipMaps) {\n          minFilter = gl.NEAREST_MIPMAP_LINEAR;\n        } else {\n          minFilter = gl.NEAREST;\n        }\n        break;\n      case 2:\n        magFilter = gl.LINEAR;\n        minFilter = gl.LINEAR;\n        break;\n      case 12:\n        magFilter = gl.LINEAR;\n        minFilter = gl.NEAREST;\n        break;\n    }\n    return {\n      min: minFilter,\n      mag: magFilter\n    };\n  }\n  /** @internal */\n  _createTexture() {\n    const texture = this._gl.createTexture();\n    if (!texture) {\n      throw new Error(\"Unable to create texture\");\n    }\n    return texture;\n  }\n  /** @internal */\n  _createHardwareTexture() {\n    return new WebGLHardwareTexture(this._createTexture(), this._gl);\n  }\n  /**\n   * Creates an internal texture without binding it to a framebuffer\n   * @internal\n   * @param size defines the size of the texture\n   * @param options defines the options used to create the texture\n   * @param delayGPUTextureCreation true to delay the texture creation the first time it is really needed. false to create it right away\n   * @param source source type of the texture\n   * @returns a new internal texture\n   */\n  _createInternalTexture(size, options) {\n    let delayGPUTextureCreation = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n    let source = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : InternalTextureSource.Unknown;\n    var _a;\n    let generateMipMaps = false;\n    let type = 0;\n    let samplingMode = 3;\n    let format = 5;\n    let useSRGBBuffer = false;\n    let samples = 1;\n    let label;\n    if (options !== undefined && typeof options === \"object\") {\n      generateMipMaps = !!options.generateMipMaps;\n      type = options.type === undefined ? 0 : options.type;\n      samplingMode = options.samplingMode === undefined ? 3 : options.samplingMode;\n      format = options.format === undefined ? 5 : options.format;\n      useSRGBBuffer = options.useSRGBBuffer === undefined ? false : options.useSRGBBuffer;\n      samples = (_a = options.samples) !== null && _a !== void 0 ? _a : 1;\n      label = options.label;\n    } else {\n      generateMipMaps = !!options;\n    }\n    useSRGBBuffer && (useSRGBBuffer = this._caps.supportSRGBBuffers && (this.webGLVersion > 1 || this.isWebGPU));\n    if (type === 1 && !this._caps.textureFloatLinearFiltering) {\n      // if floating point linear (gl.FLOAT) then force to NEAREST_SAMPLINGMODE\n      samplingMode = 1;\n    } else if (type === 2 && !this._caps.textureHalfFloatLinearFiltering) {\n      // if floating point linear (HALF_FLOAT) then force to NEAREST_SAMPLINGMODE\n      samplingMode = 1;\n    }\n    if (type === 1 && !this._caps.textureFloat) {\n      type = 0;\n      Logger.Warn(\"Float textures are not supported. Type forced to TEXTURETYPE_UNSIGNED_BYTE\");\n    }\n    const gl = this._gl;\n    const texture = new InternalTexture(this, source);\n    const width = size.width || size;\n    const height = size.height || size;\n    const layers = size.layers || 0;\n    const filters = this._getSamplingParameters(samplingMode, generateMipMaps);\n    const target = layers !== 0 ? gl.TEXTURE_2D_ARRAY : gl.TEXTURE_2D;\n    const sizedFormat = this._getRGBABufferInternalSizedFormat(type, format, useSRGBBuffer);\n    const internalFormat = this._getInternalFormat(format);\n    const textureType = this._getWebGLTextureType(type);\n    // Bind\n    this._bindTextureDirectly(target, texture);\n    if (layers !== 0) {\n      texture.is2DArray = true;\n      gl.texImage3D(target, 0, sizedFormat, width, height, layers, 0, internalFormat, textureType, null);\n    } else {\n      gl.texImage2D(target, 0, sizedFormat, width, height, 0, internalFormat, textureType, null);\n    }\n    gl.texParameteri(target, gl.TEXTURE_MAG_FILTER, filters.mag);\n    gl.texParameteri(target, gl.TEXTURE_MIN_FILTER, filters.min);\n    gl.texParameteri(target, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n    gl.texParameteri(target, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n    // MipMaps\n    if (generateMipMaps) {\n      this._gl.generateMipmap(target);\n    }\n    this._bindTextureDirectly(target, null);\n    texture._useSRGBBuffer = useSRGBBuffer;\n    texture.baseWidth = width;\n    texture.baseHeight = height;\n    texture.width = width;\n    texture.height = height;\n    texture.depth = layers;\n    texture.isReady = true;\n    texture.samples = samples;\n    texture.generateMipMaps = generateMipMaps;\n    texture.samplingMode = samplingMode;\n    texture.type = type;\n    texture.format = format;\n    texture.label = label;\n    this._internalTexturesCache.push(texture);\n    return texture;\n  }\n  /**\n   * @internal\n   */\n  _getUseSRGBBuffer(useSRGBBuffer, noMipmap) {\n    // Generating mipmaps for sRGB textures is not supported in WebGL1 so we must disable the support if mipmaps is enabled\n    return useSRGBBuffer && this._caps.supportSRGBBuffers && (this.webGLVersion > 1 || this.isWebGPU || noMipmap);\n  }\n  _createTextureBase(url, noMipmap, invertY, scene) {\n    let samplingMode = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 3;\n    let onLoad = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : null;\n    let onError = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : null;\n    let prepareTexture = arguments.length > 7 ? arguments[7] : undefined;\n    let prepareTextureProcessFunction = arguments.length > 8 ? arguments[8] : undefined;\n    let buffer = arguments.length > 9 && arguments[9] !== undefined ? arguments[9] : null;\n    let fallback = arguments.length > 10 && arguments[10] !== undefined ? arguments[10] : null;\n    let format = arguments.length > 11 && arguments[11] !== undefined ? arguments[11] : null;\n    let forcedExtension = arguments.length > 12 && arguments[12] !== undefined ? arguments[12] : null;\n    let mimeType = arguments.length > 13 ? arguments[13] : undefined;\n    let loaderOptions = arguments.length > 14 ? arguments[14] : undefined;\n    let useSRGBBuffer = arguments.length > 15 ? arguments[15] : undefined;\n    url = url || \"\";\n    const fromData = url.substr(0, 5) === \"data:\";\n    const fromBlob = url.substr(0, 5) === \"blob:\";\n    const isBase64 = fromData && url.indexOf(\";base64,\") !== -1;\n    const texture = fallback ? fallback : new InternalTexture(this, InternalTextureSource.Url);\n    if (texture !== fallback) {\n      texture.label = url.substring(0, 60); // default label, can be overriden by the caller\n    }\n\n    const originalUrl = url;\n    if (this._transformTextureUrl && !isBase64 && !fallback && !buffer) {\n      url = this._transformTextureUrl(url);\n    }\n    if (originalUrl !== url) {\n      texture._originalUrl = originalUrl;\n    }\n    // establish the file extension, if possible\n    const lastDot = url.lastIndexOf(\".\");\n    let extension = forcedExtension ? forcedExtension : lastDot > -1 ? url.substring(lastDot).toLowerCase() : \"\";\n    let loader = null;\n    // Remove query string\n    const queryStringIndex = extension.indexOf(\"?\");\n    if (queryStringIndex > -1) {\n      extension = extension.split(\"?\")[0];\n    }\n    for (const availableLoader of ThinEngine._TextureLoaders) {\n      if (availableLoader.canLoad(extension, mimeType)) {\n        loader = availableLoader;\n        break;\n      }\n    }\n    if (scene) {\n      scene.addPendingData(texture);\n    }\n    texture.url = url;\n    texture.generateMipMaps = !noMipmap;\n    texture.samplingMode = samplingMode;\n    texture.invertY = invertY;\n    texture._useSRGBBuffer = this._getUseSRGBBuffer(!!useSRGBBuffer, noMipmap);\n    if (!this._doNotHandleContextLost) {\n      // Keep a link to the buffer only if we plan to handle context lost\n      texture._buffer = buffer;\n    }\n    let onLoadObserver = null;\n    if (onLoad && !fallback) {\n      onLoadObserver = texture.onLoadedObservable.add(onLoad);\n    }\n    if (!fallback) {\n      this._internalTexturesCache.push(texture);\n    }\n    const onInternalError = (message, exception) => {\n      if (scene) {\n        scene.removePendingData(texture);\n      }\n      if (url === originalUrl) {\n        if (onLoadObserver) {\n          texture.onLoadedObservable.remove(onLoadObserver);\n        }\n        if (EngineStore.UseFallbackTexture) {\n          this._createTextureBase(EngineStore.FallbackTexture, noMipmap, texture.invertY, scene, samplingMode, null, onError, prepareTexture, prepareTextureProcessFunction, buffer, texture);\n        }\n        message = (message || \"Unknown error\") + (EngineStore.UseFallbackTexture ? \" - Fallback texture was used\" : \"\");\n        texture.onErrorObservable.notifyObservers({\n          message,\n          exception\n        });\n        if (onError) {\n          onError(message, exception);\n        }\n      } else {\n        // fall back to the original url if the transformed url fails to load\n        Logger.Warn(`Failed to load ${url}, falling back to ${originalUrl}`);\n        this._createTextureBase(originalUrl, noMipmap, texture.invertY, scene, samplingMode, onLoad, onError, prepareTexture, prepareTextureProcessFunction, buffer, texture, format, forcedExtension, mimeType, loaderOptions, useSRGBBuffer);\n      }\n    };\n    // processing for non-image formats\n    if (loader) {\n      const callback = data => {\n        loader.loadData(data, texture, (width, height, loadMipmap, isCompressed, done, loadFailed) => {\n          if (loadFailed) {\n            onInternalError(\"TextureLoader failed to load data\");\n          } else {\n            prepareTexture(texture, extension, scene, {\n              width,\n              height\n            }, texture.invertY, !loadMipmap, isCompressed, () => {\n              done();\n              return false;\n            }, samplingMode);\n          }\n        }, loaderOptions);\n      };\n      if (!buffer) {\n        this._loadFile(url, data => callback(new Uint8Array(data)), undefined, scene ? scene.offlineProvider : undefined, true, (request, exception) => {\n          onInternalError(\"Unable to load \" + (request ? request.responseURL : url, exception));\n        });\n      } else {\n        if (buffer instanceof ArrayBuffer) {\n          callback(new Uint8Array(buffer));\n        } else if (ArrayBuffer.isView(buffer)) {\n          callback(buffer);\n        } else {\n          if (onError) {\n            onError(\"Unable to load: only ArrayBuffer or ArrayBufferView is supported\", null);\n          }\n        }\n      }\n    } else {\n      const onload = img => {\n        if (fromBlob && !this._doNotHandleContextLost) {\n          // We need to store the image if we need to rebuild the texture\n          // in case of a webgl context lost\n          texture._buffer = img;\n        }\n        prepareTexture(texture, extension, scene, img, texture.invertY, noMipmap, false, prepareTextureProcessFunction, samplingMode);\n      };\n      // According to the WebGL spec section 6.10, ImageBitmaps must be inverted on creation.\n      // So, we pass imageOrientation to _FileToolsLoadImage() as it may create an ImageBitmap.\n      if (!fromData || isBase64) {\n        if (buffer && (typeof buffer.decoding === \"string\" || buffer.close)) {\n          onload(buffer);\n        } else {\n          ThinEngine._FileToolsLoadImage(url, onload, onInternalError, scene ? scene.offlineProvider : null, mimeType, texture.invertY && this._features.needsInvertingBitmap ? {\n            imageOrientation: \"flipY\"\n          } : undefined);\n        }\n      } else if (typeof buffer === \"string\" || buffer instanceof ArrayBuffer || ArrayBuffer.isView(buffer) || buffer instanceof Blob) {\n        ThinEngine._FileToolsLoadImage(buffer, onload, onInternalError, scene ? scene.offlineProvider : null, mimeType, texture.invertY && this._features.needsInvertingBitmap ? {\n          imageOrientation: \"flipY\"\n        } : undefined);\n      } else if (buffer) {\n        onload(buffer);\n      }\n    }\n    return texture;\n  }\n  /**\n   * Usually called from Texture.ts.\n   * Passed information to create a WebGLTexture\n   * @param url defines a value which contains one of the following:\n   * * A conventional http URL, e.g. 'http://...' or 'file://...'\n   * * A base64 string of in-line texture data, e.g. 'data:image/jpg;base64,/...'\n   * * An indicator that data being passed using the buffer parameter, e.g. 'data:mytexture.jpg'\n   * @param noMipmap defines a boolean indicating that no mipmaps shall be generated.  Ignored for compressed textures.  They must be in the file\n   * @param invertY when true, image is flipped when loaded.  You probably want true. Certain compressed textures may invert this if their default is inverted (eg. ktx)\n   * @param scene needed for loading to the correct scene\n   * @param samplingMode mode with should be used sample / access the texture (Default: Texture.TRILINEAR_SAMPLINGMODE)\n   * @param onLoad optional callback to be called upon successful completion\n   * @param onError optional callback to be called upon failure\n   * @param buffer a source of a file previously fetched as either a base64 string, an ArrayBuffer (compressed or image format), HTMLImageElement (image format), or a Blob\n   * @param fallback an internal argument in case the function must be called again, due to etc1 not having alpha capabilities\n   * @param format internal format.  Default: RGB when extension is '.jpg' else RGBA.  Ignored for compressed textures\n   * @param forcedExtension defines the extension to use to pick the right loader\n   * @param mimeType defines an optional mime type\n   * @param loaderOptions options to be passed to the loader\n   * @param creationFlags specific flags to use when creating the texture (1 for storage textures, for eg)\n   * @param useSRGBBuffer defines if the texture must be loaded in a sRGB GPU buffer (if supported by the GPU).\n   * @returns a InternalTexture for assignment back into BABYLON.Texture\n   */\n  createTexture(url, noMipmap, invertY, scene) {\n    let samplingMode = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 3;\n    let onLoad = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : null;\n    let onError = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : null;\n    let buffer = arguments.length > 7 && arguments[7] !== undefined ? arguments[7] : null;\n    let fallback = arguments.length > 8 && arguments[8] !== undefined ? arguments[8] : null;\n    let format = arguments.length > 9 && arguments[9] !== undefined ? arguments[9] : null;\n    let forcedExtension = arguments.length > 10 && arguments[10] !== undefined ? arguments[10] : null;\n    let mimeType = arguments.length > 11 ? arguments[11] : undefined;\n    let loaderOptions = arguments.length > 12 ? arguments[12] : undefined;\n    let creationFlags = arguments.length > 13 ? arguments[13] : undefined;\n    let useSRGBBuffer = arguments.length > 14 ? arguments[14] : undefined;\n    return this._createTextureBase(url, noMipmap, invertY, scene, samplingMode, onLoad, onError, this._prepareWebGLTexture.bind(this), (potWidth, potHeight, img, extension, texture, continuationCallback) => {\n      const gl = this._gl;\n      const isPot = img.width === potWidth && img.height === potHeight;\n      const tip = this._getTexImageParametersForCreateTexture(format, extension, texture._useSRGBBuffer);\n      if (isPot) {\n        gl.texImage2D(gl.TEXTURE_2D, 0, tip.internalFormat, tip.format, tip.type, img);\n        return false;\n      }\n      const maxTextureSize = this._caps.maxTextureSize;\n      if (img.width > maxTextureSize || img.height > maxTextureSize || !this._supportsHardwareTextureRescaling) {\n        this._prepareWorkingCanvas();\n        if (!this._workingCanvas || !this._workingContext) {\n          return false;\n        }\n        this._workingCanvas.width = potWidth;\n        this._workingCanvas.height = potHeight;\n        this._workingContext.drawImage(img, 0, 0, img.width, img.height, 0, 0, potWidth, potHeight);\n        gl.texImage2D(gl.TEXTURE_2D, 0, tip.internalFormat, tip.format, tip.type, this._workingCanvas);\n        texture.width = potWidth;\n        texture.height = potHeight;\n        return false;\n      } else {\n        // Using shaders when possible to rescale because canvas.drawImage is lossy\n        const source = new InternalTexture(this, InternalTextureSource.Temp);\n        this._bindTextureDirectly(gl.TEXTURE_2D, source, true);\n        gl.texImage2D(gl.TEXTURE_2D, 0, tip.internalFormat, tip.format, tip.type, img);\n        this._rescaleTexture(source, texture, scene, tip.format, () => {\n          this._releaseTexture(source);\n          this._bindTextureDirectly(gl.TEXTURE_2D, texture, true);\n          continuationCallback();\n        });\n      }\n      return true;\n    }, buffer, fallback, format, forcedExtension, mimeType, loaderOptions, useSRGBBuffer);\n  }\n  /**\n   * Calls to the GL texImage2D and texImage3D functions require three arguments describing the pixel format of the texture.\n   * createTexture derives these from the babylonFormat and useSRGBBuffer arguments and also the file extension of the URL it's working with.\n   * This function encapsulates that derivation for easy unit testing.\n   * @param babylonFormat Babylon's format enum, as specified in ITextureCreationOptions.\n   * @param fileExtension The file extension including the dot, e.g. .jpg.\n   * @param useSRGBBuffer Use SRGB not linear.\n   * @returns The options to pass to texImage2D or texImage3D calls.\n   * @internal\n   */\n  _getTexImageParametersForCreateTexture(babylonFormat, fileExtension, useSRGBBuffer) {\n    if (babylonFormat === undefined || babylonFormat === null) {\n      babylonFormat = fileExtension === \".jpg\" && !useSRGBBuffer ? 4 : 5;\n    }\n    let format, internalFormat;\n    if (this.webGLVersion === 1) {\n      // In WebGL 1, format and internalFormat must be the same and taken from a limited set of values, see https://docs.gl/es2/glTexImage2D.\n      // The SRGB extension (https://developer.mozilla.org/en-US/docs/Web/API/EXT_sRGB) adds some extra values, hence passing useSRGBBuffer\n      // to getInternalFormat.\n      format = this._getInternalFormat(babylonFormat, useSRGBBuffer);\n      internalFormat = format;\n    } else {\n      // In WebGL 2, format has a wider range of values and internal format can be one of the sized formats, see\n      // https://registry.khronos.org/OpenGL-Refpages/es3.0/html/glTexImage2D.xhtml.\n      // SRGB is included in the sized format and should not be passed in \"format\", hence always passing useSRGBBuffer as false.\n      format = this._getInternalFormat(babylonFormat, false);\n      internalFormat = this._getRGBABufferInternalSizedFormat(0, babylonFormat, useSRGBBuffer);\n    }\n    return {\n      internalFormat,\n      format,\n      type: this._gl.UNSIGNED_BYTE\n    };\n  }\n  /**\n   * Loads an image as an HTMLImageElement.\n   * @param input url string, ArrayBuffer, or Blob to load\n   * @param onLoad callback called when the image successfully loads\n   * @param onError callback called when the image fails to load\n   * @param offlineProvider offline provider for caching\n   * @param mimeType optional mime type\n   * @param imageBitmapOptions optional the options to use when creating an ImageBitmap\n   * @returns the HTMLImageElement of the loaded image\n   * @internal\n   */\n  static _FileToolsLoadImage(input, onLoad, onError, offlineProvider, mimeType, imageBitmapOptions) {\n    throw _WarnImport(\"FileTools\");\n  }\n  /**\n   * @internal\n   */\n  _rescaleTexture(source, destination, scene, internalFormat, onComplete) {}\n  /**\n   * Creates a raw texture\n   * @param data defines the data to store in the texture\n   * @param width defines the width of the texture\n   * @param height defines the height of the texture\n   * @param format defines the format of the data\n   * @param generateMipMaps defines if the engine should generate the mip levels\n   * @param invertY defines if data must be stored with Y axis inverted\n   * @param samplingMode defines the required sampling mode (Texture.NEAREST_SAMPLINGMODE by default)\n   * @param compression defines the compression used (null by default)\n   * @param type defines the type fo the data (Engine.TEXTURETYPE_UNSIGNED_INT by default)\n   * @param creationFlags specific flags to use when creating the texture (1 for storage textures, for eg)\n   * @param useSRGBBuffer defines if the texture must be loaded in a sRGB GPU buffer (if supported by the GPU).\n   * @returns the raw texture inside an InternalTexture\n   */\n  createRawTexture(data, width, height, format, generateMipMaps, invertY, samplingMode) {\n    let compression = arguments.length > 7 && arguments[7] !== undefined ? arguments[7] : null;\n    let type = arguments.length > 8 && arguments[8] !== undefined ? arguments[8] : 0;\n    let creationFlags = arguments.length > 9 && arguments[9] !== undefined ? arguments[9] : 0;\n    let useSRGBBuffer = arguments.length > 10 && arguments[10] !== undefined ? arguments[10] : false;\n    throw _WarnImport(\"Engine.RawTexture\");\n  }\n  /**\n   * Creates a new raw cube texture\n   * @param data defines the array of data to use to create each face\n   * @param size defines the size of the textures\n   * @param format defines the format of the data\n   * @param type defines the type of the data (like Engine.TEXTURETYPE_UNSIGNED_INT)\n   * @param generateMipMaps  defines if the engine should generate the mip levels\n   * @param invertY defines if data must be stored with Y axis inverted\n   * @param samplingMode defines the required sampling mode (like Texture.NEAREST_SAMPLINGMODE)\n   * @param compression defines the compression used (null by default)\n   * @returns the cube texture as an InternalTexture\n   */\n  createRawCubeTexture(data, size, format, type, generateMipMaps, invertY, samplingMode) {\n    let compression = arguments.length > 7 && arguments[7] !== undefined ? arguments[7] : null;\n    throw _WarnImport(\"Engine.RawTexture\");\n  }\n  /**\n   * Creates a new raw 3D texture\n   * @param data defines the data used to create the texture\n   * @param width defines the width of the texture\n   * @param height defines the height of the texture\n   * @param depth defines the depth of the texture\n   * @param format defines the format of the texture\n   * @param generateMipMaps defines if the engine must generate mip levels\n   * @param invertY defines if data must be stored with Y axis inverted\n   * @param samplingMode defines the required sampling mode (like Texture.NEAREST_SAMPLINGMODE)\n   * @param compression defines the compressed used (can be null)\n   * @param textureType defines the compressed used (can be null)\n   * @returns a new raw 3D texture (stored in an InternalTexture)\n   */\n  createRawTexture3D(data, width, height, depth, format, generateMipMaps, invertY, samplingMode) {\n    let compression = arguments.length > 8 && arguments[8] !== undefined ? arguments[8] : null;\n    let textureType = arguments.length > 9 && arguments[9] !== undefined ? arguments[9] : 0;\n    throw _WarnImport(\"Engine.RawTexture\");\n  }\n  /**\n   * Creates a new raw 2D array texture\n   * @param data defines the data used to create the texture\n   * @param width defines the width of the texture\n   * @param height defines the height of the texture\n   * @param depth defines the number of layers of the texture\n   * @param format defines the format of the texture\n   * @param generateMipMaps defines if the engine must generate mip levels\n   * @param invertY defines if data must be stored with Y axis inverted\n   * @param samplingMode defines the required sampling mode (like Texture.NEAREST_SAMPLINGMODE)\n   * @param compression defines the compressed used (can be null)\n   * @param textureType defines the compressed used (can be null)\n   * @returns a new raw 2D array texture (stored in an InternalTexture)\n   */\n  createRawTexture2DArray(data, width, height, depth, format, generateMipMaps, invertY, samplingMode) {\n    let compression = arguments.length > 8 && arguments[8] !== undefined ? arguments[8] : null;\n    let textureType = arguments.length > 9 && arguments[9] !== undefined ? arguments[9] : 0;\n    throw _WarnImport(\"Engine.RawTexture\");\n  }\n  /**\n   * @internal\n   */\n  _unpackFlipY(value) {\n    if (this._unpackFlipYCached !== value) {\n      this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL, value ? 1 : 0);\n      if (this.enableUnpackFlipYCached) {\n        this._unpackFlipYCached = value;\n      }\n    }\n  }\n  /** @internal */\n  _getUnpackAlignement() {\n    return this._gl.getParameter(this._gl.UNPACK_ALIGNMENT);\n  }\n  _getTextureTarget(texture) {\n    if (texture.isCube) {\n      return this._gl.TEXTURE_CUBE_MAP;\n    } else if (texture.is3D) {\n      return this._gl.TEXTURE_3D;\n    } else if (texture.is2DArray || texture.isMultiview) {\n      return this._gl.TEXTURE_2D_ARRAY;\n    }\n    return this._gl.TEXTURE_2D;\n  }\n  /**\n   * Update the sampling mode of a given texture\n   * @param samplingMode defines the required sampling mode\n   * @param texture defines the texture to update\n   * @param generateMipMaps defines whether to generate mipmaps for the texture\n   */\n  updateTextureSamplingMode(samplingMode, texture) {\n    let generateMipMaps = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    const target = this._getTextureTarget(texture);\n    const filters = this._getSamplingParameters(samplingMode, texture.useMipMaps || generateMipMaps);\n    this._setTextureParameterInteger(target, this._gl.TEXTURE_MAG_FILTER, filters.mag, texture);\n    this._setTextureParameterInteger(target, this._gl.TEXTURE_MIN_FILTER, filters.min);\n    if (generateMipMaps) {\n      texture.generateMipMaps = true;\n      this._gl.generateMipmap(target);\n    }\n    this._bindTextureDirectly(target, null);\n    texture.samplingMode = samplingMode;\n  }\n  /**\n   * Update the dimensions of a texture\n   * @param texture texture to update\n   * @param width new width of the texture\n   * @param height new height of the texture\n   * @param depth new depth of the texture\n   */\n  updateTextureDimensions(texture, width, height) {\n    let depth = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 1;\n  }\n  /**\n   * Update the sampling mode of a given texture\n   * @param texture defines the texture to update\n   * @param wrapU defines the texture wrap mode of the u coordinates\n   * @param wrapV defines the texture wrap mode of the v coordinates\n   * @param wrapR defines the texture wrap mode of the r coordinates\n   */\n  updateTextureWrappingMode(texture, wrapU) {\n    let wrapV = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n    let wrapR = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;\n    const target = this._getTextureTarget(texture);\n    if (wrapU !== null) {\n      this._setTextureParameterInteger(target, this._gl.TEXTURE_WRAP_S, this._getTextureWrapMode(wrapU), texture);\n      texture._cachedWrapU = wrapU;\n    }\n    if (wrapV !== null) {\n      this._setTextureParameterInteger(target, this._gl.TEXTURE_WRAP_T, this._getTextureWrapMode(wrapV), texture);\n      texture._cachedWrapV = wrapV;\n    }\n    if ((texture.is2DArray || texture.is3D) && wrapR !== null) {\n      this._setTextureParameterInteger(target, this._gl.TEXTURE_WRAP_R, this._getTextureWrapMode(wrapR), texture);\n      texture._cachedWrapR = wrapR;\n    }\n    this._bindTextureDirectly(target, null);\n  }\n  /**\n   * @internal\n   */\n  _setupDepthStencilTexture(internalTexture, size, generateStencil, bilinearFiltering, comparisonFunction) {\n    let samples = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : 1;\n    const width = size.width || size;\n    const height = size.height || size;\n    const layers = size.layers || 0;\n    internalTexture.baseWidth = width;\n    internalTexture.baseHeight = height;\n    internalTexture.width = width;\n    internalTexture.height = height;\n    internalTexture.is2DArray = layers > 0;\n    internalTexture.depth = layers;\n    internalTexture.isReady = true;\n    internalTexture.samples = samples;\n    internalTexture.generateMipMaps = false;\n    internalTexture.samplingMode = bilinearFiltering ? 2 : 1;\n    internalTexture.type = 0;\n    internalTexture._comparisonFunction = comparisonFunction;\n    const gl = this._gl;\n    const target = this._getTextureTarget(internalTexture);\n    const samplingParameters = this._getSamplingParameters(internalTexture.samplingMode, false);\n    gl.texParameteri(target, gl.TEXTURE_MAG_FILTER, samplingParameters.mag);\n    gl.texParameteri(target, gl.TEXTURE_MIN_FILTER, samplingParameters.min);\n    gl.texParameteri(target, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n    gl.texParameteri(target, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n    // TEXTURE_COMPARE_FUNC/MODE are only availble in WebGL2.\n    if (this.webGLVersion > 1) {\n      if (comparisonFunction === 0) {\n        gl.texParameteri(target, gl.TEXTURE_COMPARE_FUNC, 515);\n        gl.texParameteri(target, gl.TEXTURE_COMPARE_MODE, gl.NONE);\n      } else {\n        gl.texParameteri(target, gl.TEXTURE_COMPARE_FUNC, comparisonFunction);\n        gl.texParameteri(target, gl.TEXTURE_COMPARE_MODE, gl.COMPARE_REF_TO_TEXTURE);\n      }\n    }\n  }\n  /**\n   * @internal\n   */\n  _uploadCompressedDataToTextureDirectly(texture, internalFormat, width, height, data) {\n    let faceIndex = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : 0;\n    let lod = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : 0;\n    const gl = this._gl;\n    let target = gl.TEXTURE_2D;\n    if (texture.isCube) {\n      target = gl.TEXTURE_CUBE_MAP_POSITIVE_X + faceIndex;\n    }\n    if (texture._useSRGBBuffer) {\n      switch (internalFormat) {\n        case 37492:\n        case 36196:\n          // Note, if using ETC1 and sRGB is requested, this will use ETC2 if available.\n          if (this._caps.etc2) {\n            internalFormat = gl.COMPRESSED_SRGB8_ETC2;\n          } else {\n            texture._useSRGBBuffer = false;\n          }\n          break;\n        case 37496:\n          if (this._caps.etc2) {\n            internalFormat = gl.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC;\n          } else {\n            texture._useSRGBBuffer = false;\n          }\n          break;\n        case 36492:\n          internalFormat = gl.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT;\n          break;\n        case 37808:\n          internalFormat = gl.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR;\n          break;\n        case 33776:\n          if (this._caps.s3tc_srgb) {\n            internalFormat = gl.COMPRESSED_SRGB_S3TC_DXT1_EXT;\n          } else {\n            // S3TC sRGB extension not supported\n            texture._useSRGBBuffer = false;\n          }\n          break;\n        case 33777:\n          if (this._caps.s3tc_srgb) {\n            internalFormat = gl.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;\n          } else {\n            // S3TC sRGB extension not supported\n            texture._useSRGBBuffer = false;\n          }\n          break;\n        case 33779:\n          if (this._caps.s3tc_srgb) {\n            internalFormat = gl.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT;\n          } else {\n            // S3TC sRGB extension not supported\n            texture._useSRGBBuffer = false;\n          }\n          break;\n        default:\n          // We don't support a sRGB format corresponding to internalFormat, so revert to non sRGB format\n          texture._useSRGBBuffer = false;\n          break;\n      }\n    }\n    this._gl.compressedTexImage2D(target, lod, internalFormat, width, height, 0, data);\n  }\n  /**\n   * @internal\n   */\n  _uploadDataToTextureDirectly(texture, imageData) {\n    let faceIndex = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n    let lod = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n    let babylonInternalFormat = arguments.length > 4 ? arguments[4] : undefined;\n    let useTextureWidthAndHeight = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : false;\n    const gl = this._gl;\n    const textureType = this._getWebGLTextureType(texture.type);\n    const format = this._getInternalFormat(texture.format);\n    const internalFormat = babylonInternalFormat === undefined ? this._getRGBABufferInternalSizedFormat(texture.type, texture.format, texture._useSRGBBuffer) : this._getInternalFormat(babylonInternalFormat, texture._useSRGBBuffer);\n    this._unpackFlipY(texture.invertY);\n    let target = gl.TEXTURE_2D;\n    if (texture.isCube) {\n      target = gl.TEXTURE_CUBE_MAP_POSITIVE_X + faceIndex;\n    }\n    const lodMaxWidth = Math.round(Math.log(texture.width) * Math.LOG2E);\n    const lodMaxHeight = Math.round(Math.log(texture.height) * Math.LOG2E);\n    const width = useTextureWidthAndHeight ? texture.width : Math.pow(2, Math.max(lodMaxWidth - lod, 0));\n    const height = useTextureWidthAndHeight ? texture.height : Math.pow(2, Math.max(lodMaxHeight - lod, 0));\n    gl.texImage2D(target, lod, internalFormat, width, height, 0, format, textureType, imageData);\n  }\n  /**\n   * Update a portion of an internal texture\n   * @param texture defines the texture to update\n   * @param imageData defines the data to store into the texture\n   * @param xOffset defines the x coordinates of the update rectangle\n   * @param yOffset defines the y coordinates of the update rectangle\n   * @param width defines the width of the update rectangle\n   * @param height defines the height of the update rectangle\n   * @param faceIndex defines the face index if texture is a cube (0 by default)\n   * @param lod defines the lod level to update (0 by default)\n   * @param generateMipMaps defines whether to generate mipmaps or not\n   */\n  updateTextureData(texture, imageData, xOffset, yOffset, width, height) {\n    let faceIndex = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : 0;\n    let lod = arguments.length > 7 && arguments[7] !== undefined ? arguments[7] : 0;\n    let generateMipMaps = arguments.length > 8 && arguments[8] !== undefined ? arguments[8] : false;\n    const gl = this._gl;\n    const textureType = this._getWebGLTextureType(texture.type);\n    const format = this._getInternalFormat(texture.format);\n    this._unpackFlipY(texture.invertY);\n    let targetForBinding = gl.TEXTURE_2D;\n    let target = gl.TEXTURE_2D;\n    if (texture.isCube) {\n      target = gl.TEXTURE_CUBE_MAP_POSITIVE_X + faceIndex;\n      targetForBinding = gl.TEXTURE_CUBE_MAP;\n    }\n    this._bindTextureDirectly(targetForBinding, texture, true);\n    gl.texSubImage2D(target, lod, xOffset, yOffset, width, height, format, textureType, imageData);\n    if (generateMipMaps) {\n      this._gl.generateMipmap(target);\n    }\n    this._bindTextureDirectly(targetForBinding, null);\n  }\n  /**\n   * @internal\n   */\n  _uploadArrayBufferViewToTexture(texture, imageData) {\n    let faceIndex = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n    let lod = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n    const gl = this._gl;\n    const bindTarget = texture.isCube ? gl.TEXTURE_CUBE_MAP : gl.TEXTURE_2D;\n    this._bindTextureDirectly(bindTarget, texture, true);\n    this._uploadDataToTextureDirectly(texture, imageData, faceIndex, lod);\n    this._bindTextureDirectly(bindTarget, null, true);\n  }\n  _prepareWebGLTextureContinuation(texture, scene, noMipmap, isCompressed, samplingMode) {\n    const gl = this._gl;\n    if (!gl) {\n      return;\n    }\n    const filters = this._getSamplingParameters(samplingMode, !noMipmap);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, filters.mag);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, filters.min);\n    if (!noMipmap && !isCompressed) {\n      gl.generateMipmap(gl.TEXTURE_2D);\n    }\n    this._bindTextureDirectly(gl.TEXTURE_2D, null);\n    // this.resetTextureCache();\n    if (scene) {\n      scene.removePendingData(texture);\n    }\n    texture.onLoadedObservable.notifyObservers(texture);\n    texture.onLoadedObservable.clear();\n  }\n  _prepareWebGLTexture(texture, extension, scene, img, invertY, noMipmap, isCompressed, processFunction) {\n    let samplingMode = arguments.length > 8 && arguments[8] !== undefined ? arguments[8] : 3;\n    const maxTextureSize = this.getCaps().maxTextureSize;\n    const potWidth = Math.min(maxTextureSize, this.needPOTTextures ? ThinEngine.GetExponentOfTwo(img.width, maxTextureSize) : img.width);\n    const potHeight = Math.min(maxTextureSize, this.needPOTTextures ? ThinEngine.GetExponentOfTwo(img.height, maxTextureSize) : img.height);\n    const gl = this._gl;\n    if (!gl) {\n      return;\n    }\n    if (!texture._hardwareTexture) {\n      //  this.resetTextureCache();\n      if (scene) {\n        scene.removePendingData(texture);\n      }\n      return;\n    }\n    this._bindTextureDirectly(gl.TEXTURE_2D, texture, true);\n    this._unpackFlipY(invertY === undefined ? true : invertY ? true : false);\n    texture.baseWidth = img.width;\n    texture.baseHeight = img.height;\n    texture.width = potWidth;\n    texture.height = potHeight;\n    texture.isReady = true;\n    texture.type = texture.type !== -1 ? texture.type : 0;\n    texture.format = texture.format !== -1 ? texture.format : extension === \".jpg\" && !texture._useSRGBBuffer ? 4 : 5;\n    if (processFunction(potWidth, potHeight, img, extension, texture, () => {\n      this._prepareWebGLTextureContinuation(texture, scene, noMipmap, isCompressed, samplingMode);\n    })) {\n      // Returning as texture needs extra async steps\n      return;\n    }\n    this._prepareWebGLTextureContinuation(texture, scene, noMipmap, isCompressed, samplingMode);\n  }\n  /**\n   * @internal\n   */\n  _setupFramebufferDepthAttachments(generateStencilBuffer, generateDepthBuffer, width, height) {\n    let samples = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 1;\n    const gl = this._gl;\n    // Create the depth/stencil buffer\n    if (generateStencilBuffer && generateDepthBuffer) {\n      return this._createRenderBuffer(width, height, samples, gl.DEPTH_STENCIL, gl.DEPTH24_STENCIL8, gl.DEPTH_STENCIL_ATTACHMENT);\n    }\n    if (generateDepthBuffer) {\n      let depthFormat = gl.DEPTH_COMPONENT16;\n      if (this._webGLVersion > 1) {\n        depthFormat = gl.DEPTH_COMPONENT32F;\n      }\n      return this._createRenderBuffer(width, height, samples, depthFormat, depthFormat, gl.DEPTH_ATTACHMENT);\n    }\n    if (generateStencilBuffer) {\n      return this._createRenderBuffer(width, height, samples, gl.STENCIL_INDEX8, gl.STENCIL_INDEX8, gl.STENCIL_ATTACHMENT);\n    }\n    return null;\n  }\n  /**\n   * @internal\n   */\n  _createRenderBuffer(width, height, samples, internalFormat, msInternalFormat, attachment) {\n    let unbindBuffer = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : true;\n    const gl = this._gl;\n    const renderBuffer = gl.createRenderbuffer();\n    return this._updateRenderBuffer(renderBuffer, width, height, samples, internalFormat, msInternalFormat, attachment, unbindBuffer);\n  }\n  _updateRenderBuffer(renderBuffer, width, height, samples, internalFormat, msInternalFormat, attachment) {\n    let unbindBuffer = arguments.length > 7 && arguments[7] !== undefined ? arguments[7] : true;\n    const gl = this._gl;\n    gl.bindRenderbuffer(gl.RENDERBUFFER, renderBuffer);\n    if (samples > 1 && gl.renderbufferStorageMultisample) {\n      gl.renderbufferStorageMultisample(gl.RENDERBUFFER, samples, msInternalFormat, width, height);\n    } else {\n      gl.renderbufferStorage(gl.RENDERBUFFER, internalFormat, width, height);\n    }\n    gl.framebufferRenderbuffer(gl.FRAMEBUFFER, attachment, gl.RENDERBUFFER, renderBuffer);\n    if (unbindBuffer) {\n      gl.bindRenderbuffer(gl.RENDERBUFFER, null);\n    }\n    return renderBuffer;\n  }\n  /**\n   * @internal\n   */\n  _releaseTexture(texture) {\n    var _a;\n    this._deleteTexture((_a = texture._hardwareTexture) === null || _a === void 0 ? void 0 : _a.underlyingResource);\n    // Unbind channels\n    this.unbindAllTextures();\n    const index = this._internalTexturesCache.indexOf(texture);\n    if (index !== -1) {\n      this._internalTexturesCache.splice(index, 1);\n    }\n    // Integrated fixed lod samplers.\n    if (texture._lodTextureHigh) {\n      texture._lodTextureHigh.dispose();\n    }\n    if (texture._lodTextureMid) {\n      texture._lodTextureMid.dispose();\n    }\n    if (texture._lodTextureLow) {\n      texture._lodTextureLow.dispose();\n    }\n    // Integrated irradiance map.\n    if (texture._irradianceTexture) {\n      texture._irradianceTexture.dispose();\n    }\n  }\n  /**\n   * @internal\n   */\n  _releaseRenderTargetWrapper(rtWrapper) {\n    const index = this._renderTargetWrapperCache.indexOf(rtWrapper);\n    if (index !== -1) {\n      this._renderTargetWrapperCache.splice(index, 1);\n    }\n  }\n  _deleteTexture(texture) {\n    if (texture) {\n      this._gl.deleteTexture(texture);\n    }\n  }\n  _setProgram(program) {\n    if (this._currentProgram !== program) {\n      this._gl.useProgram(program);\n      this._currentProgram = program;\n    }\n  }\n  /**\n   * Binds an effect to the webGL context\n   * @param effect defines the effect to bind\n   */\n  bindSamplers(effect) {\n    const webGLPipelineContext = effect.getPipelineContext();\n    this._setProgram(webGLPipelineContext.program);\n    const samplers = effect.getSamplers();\n    for (let index = 0; index < samplers.length; index++) {\n      const uniform = effect.getUniform(samplers[index]);\n      if (uniform) {\n        this._boundUniforms[index] = uniform;\n      }\n    }\n    this._currentEffect = null;\n  }\n  _activateCurrentTexture() {\n    if (this._currentTextureChannel !== this._activeChannel) {\n      this._gl.activeTexture(this._gl.TEXTURE0 + this._activeChannel);\n      this._currentTextureChannel = this._activeChannel;\n    }\n  }\n  /**\n   * @internal\n   */\n  _bindTextureDirectly(target, texture) {\n    let forTextureDataUpdate = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    let force = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n    var _a, _b;\n    let wasPreviouslyBound = false;\n    const isTextureForRendering = texture && texture._associatedChannel > -1;\n    if (forTextureDataUpdate && isTextureForRendering) {\n      this._activeChannel = texture._associatedChannel;\n    }\n    const currentTextureBound = this._boundTexturesCache[this._activeChannel];\n    if (currentTextureBound !== texture || force) {\n      this._activateCurrentTexture();\n      if (texture && texture.isMultiview) {\n        //this._gl.bindTexture(target, texture ? texture._colorTextureArray : null);\n        console.error(target, texture);\n        throw \"_bindTextureDirectly called with a multiview texture!\";\n      } else {\n        this._gl.bindTexture(target, (_b = (_a = texture === null || texture === void 0 ? void 0 : texture._hardwareTexture) === null || _a === void 0 ? void 0 : _a.underlyingResource) !== null && _b !== void 0 ? _b : null);\n      }\n      this._boundTexturesCache[this._activeChannel] = texture;\n      if (texture) {\n        texture._associatedChannel = this._activeChannel;\n      }\n    } else if (forTextureDataUpdate) {\n      wasPreviouslyBound = true;\n      this._activateCurrentTexture();\n    }\n    if (isTextureForRendering && !forTextureDataUpdate) {\n      this._bindSamplerUniformToChannel(texture._associatedChannel, this._activeChannel);\n    }\n    return wasPreviouslyBound;\n  }\n  /**\n   * @internal\n   */\n  _bindTexture(channel, texture, name) {\n    if (channel === undefined) {\n      return;\n    }\n    if (texture) {\n      texture._associatedChannel = channel;\n    }\n    this._activeChannel = channel;\n    const target = texture ? this._getTextureTarget(texture) : this._gl.TEXTURE_2D;\n    this._bindTextureDirectly(target, texture);\n  }\n  /**\n   * Unbind all textures from the webGL context\n   */\n  unbindAllTextures() {\n    for (let channel = 0; channel < this._maxSimultaneousTextures; channel++) {\n      this._activeChannel = channel;\n      this._bindTextureDirectly(this._gl.TEXTURE_2D, null);\n      this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP, null);\n      if (this.webGLVersion > 1) {\n        this._bindTextureDirectly(this._gl.TEXTURE_3D, null);\n        this._bindTextureDirectly(this._gl.TEXTURE_2D_ARRAY, null);\n      }\n    }\n  }\n  /**\n   * Sets a texture to the according uniform.\n   * @param channel The texture channel\n   * @param uniform The uniform to set\n   * @param texture The texture to apply\n   * @param name The name of the uniform in the effect\n   */\n  setTexture(channel, uniform, texture, name) {\n    if (channel === undefined) {\n      return;\n    }\n    if (uniform) {\n      this._boundUniforms[channel] = uniform;\n    }\n    this._setTexture(channel, texture);\n  }\n  _bindSamplerUniformToChannel(sourceSlot, destination) {\n    const uniform = this._boundUniforms[sourceSlot];\n    if (!uniform || uniform._currentState === destination) {\n      return;\n    }\n    this._gl.uniform1i(uniform, destination);\n    uniform._currentState = destination;\n  }\n  _getTextureWrapMode(mode) {\n    switch (mode) {\n      case 1:\n        return this._gl.REPEAT;\n      case 0:\n        return this._gl.CLAMP_TO_EDGE;\n      case 2:\n        return this._gl.MIRRORED_REPEAT;\n    }\n    return this._gl.REPEAT;\n  }\n  _setTexture(channel, texture) {\n    let isPartOfTextureArray = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    let depthStencilTexture = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n    let name = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : \"\";\n    // Not ready?\n    if (!texture) {\n      if (this._boundTexturesCache[channel] != null) {\n        this._activeChannel = channel;\n        this._bindTextureDirectly(this._gl.TEXTURE_2D, null);\n        this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP, null);\n        if (this.webGLVersion > 1) {\n          this._bindTextureDirectly(this._gl.TEXTURE_3D, null);\n          this._bindTextureDirectly(this._gl.TEXTURE_2D_ARRAY, null);\n        }\n      }\n      return false;\n    }\n    // Video\n    if (texture.video) {\n      this._activeChannel = channel;\n      const videoInternalTexture = texture.getInternalTexture();\n      if (videoInternalTexture) {\n        videoInternalTexture._associatedChannel = channel;\n      }\n      texture.update();\n    } else if (texture.delayLoadState === 4) {\n      // Delay loading\n      texture.delayLoad();\n      return false;\n    }\n    let internalTexture;\n    if (depthStencilTexture) {\n      internalTexture = texture.depthStencilTexture;\n    } else if (texture.isReady()) {\n      internalTexture = texture.getInternalTexture();\n    } else if (texture.isCube) {\n      internalTexture = this.emptyCubeTexture;\n    } else if (texture.is3D) {\n      internalTexture = this.emptyTexture3D;\n    } else if (texture.is2DArray) {\n      internalTexture = this.emptyTexture2DArray;\n    } else {\n      internalTexture = this.emptyTexture;\n    }\n    if (!isPartOfTextureArray && internalTexture) {\n      internalTexture._associatedChannel = channel;\n    }\n    let needToBind = true;\n    if (this._boundTexturesCache[channel] === internalTexture) {\n      if (!isPartOfTextureArray) {\n        this._bindSamplerUniformToChannel(internalTexture._associatedChannel, channel);\n      }\n      needToBind = false;\n    }\n    this._activeChannel = channel;\n    const target = this._getTextureTarget(internalTexture);\n    if (needToBind) {\n      this._bindTextureDirectly(target, internalTexture, isPartOfTextureArray);\n    }\n    if (internalTexture && !internalTexture.isMultiview) {\n      // CUBIC_MODE and SKYBOX_MODE both require CLAMP_TO_EDGE.  All other modes use REPEAT.\n      if (internalTexture.isCube && internalTexture._cachedCoordinatesMode !== texture.coordinatesMode) {\n        internalTexture._cachedCoordinatesMode = texture.coordinatesMode;\n        const textureWrapMode = texture.coordinatesMode !== 3 && texture.coordinatesMode !== 5 ? 1 : 0;\n        texture.wrapU = textureWrapMode;\n        texture.wrapV = textureWrapMode;\n      }\n      if (internalTexture._cachedWrapU !== texture.wrapU) {\n        internalTexture._cachedWrapU = texture.wrapU;\n        this._setTextureParameterInteger(target, this._gl.TEXTURE_WRAP_S, this._getTextureWrapMode(texture.wrapU), internalTexture);\n      }\n      if (internalTexture._cachedWrapV !== texture.wrapV) {\n        internalTexture._cachedWrapV = texture.wrapV;\n        this._setTextureParameterInteger(target, this._gl.TEXTURE_WRAP_T, this._getTextureWrapMode(texture.wrapV), internalTexture);\n      }\n      if (internalTexture.is3D && internalTexture._cachedWrapR !== texture.wrapR) {\n        internalTexture._cachedWrapR = texture.wrapR;\n        this._setTextureParameterInteger(target, this._gl.TEXTURE_WRAP_R, this._getTextureWrapMode(texture.wrapR), internalTexture);\n      }\n      this._setAnisotropicLevel(target, internalTexture, texture.anisotropicFilteringLevel);\n    }\n    return true;\n  }\n  /**\n   * Sets an array of texture to the webGL context\n   * @param channel defines the channel where the texture array must be set\n   * @param uniform defines the associated uniform location\n   * @param textures defines the array of textures to bind\n   * @param name name of the channel\n   */\n  setTextureArray(channel, uniform, textures, name) {\n    if (channel === undefined || !uniform) {\n      return;\n    }\n    if (!this._textureUnits || this._textureUnits.length !== textures.length) {\n      this._textureUnits = new Int32Array(textures.length);\n    }\n    for (let i = 0; i < textures.length; i++) {\n      const texture = textures[i].getInternalTexture();\n      if (texture) {\n        this._textureUnits[i] = channel + i;\n        texture._associatedChannel = channel + i;\n      } else {\n        this._textureUnits[i] = -1;\n      }\n    }\n    this._gl.uniform1iv(uniform, this._textureUnits);\n    for (let index = 0; index < textures.length; index++) {\n      this._setTexture(this._textureUnits[index], textures[index], true);\n    }\n  }\n  /**\n   * @internal\n   */\n  _setAnisotropicLevel(target, internalTexture, anisotropicFilteringLevel) {\n    const anisotropicFilterExtension = this._caps.textureAnisotropicFilterExtension;\n    if (internalTexture.samplingMode !== 11 && internalTexture.samplingMode !== 3 && internalTexture.samplingMode !== 2) {\n      anisotropicFilteringLevel = 1; // Forcing the anisotropic to 1 because else webgl will force filters to linear\n    }\n\n    if (anisotropicFilterExtension && internalTexture._cachedAnisotropicFilteringLevel !== anisotropicFilteringLevel) {\n      this._setTextureParameterFloat(target, anisotropicFilterExtension.TEXTURE_MAX_ANISOTROPY_EXT, Math.min(anisotropicFilteringLevel, this._caps.maxAnisotropy), internalTexture);\n      internalTexture._cachedAnisotropicFilteringLevel = anisotropicFilteringLevel;\n    }\n  }\n  _setTextureParameterFloat(target, parameter, value, texture) {\n    this._bindTextureDirectly(target, texture, true, true);\n    this._gl.texParameterf(target, parameter, value);\n  }\n  _setTextureParameterInteger(target, parameter, value, texture) {\n    if (texture) {\n      this._bindTextureDirectly(target, texture, true, true);\n    }\n    this._gl.texParameteri(target, parameter, value);\n  }\n  /**\n   * Unbind all vertex attributes from the webGL context\n   */\n  unbindAllAttributes() {\n    if (this._mustWipeVertexAttributes) {\n      this._mustWipeVertexAttributes = false;\n      for (let i = 0; i < this._caps.maxVertexAttribs; i++) {\n        this.disableAttributeByIndex(i);\n      }\n      return;\n    }\n    for (let i = 0, ul = this._vertexAttribArraysEnabled.length; i < ul; i++) {\n      if (i >= this._caps.maxVertexAttribs || !this._vertexAttribArraysEnabled[i]) {\n        continue;\n      }\n      this.disableAttributeByIndex(i);\n    }\n  }\n  /**\n   * Force the engine to release all cached effects. This means that next effect compilation will have to be done completely even if a similar effect was already compiled\n   */\n  releaseEffects() {\n    for (const name in this._compiledEffects) {\n      const webGLPipelineContext = this._compiledEffects[name].getPipelineContext();\n      this._deletePipelineContext(webGLPipelineContext);\n    }\n    this._compiledEffects = {};\n  }\n  /**\n   * Dispose and release all associated resources\n   */\n  dispose() {\n    var _a, _b;\n    this._isDisposed = true;\n    this.stopRenderLoop();\n    // Clear observables\n    if (this.onBeforeTextureInitObservable) {\n      this.onBeforeTextureInitObservable.clear();\n    }\n    // Empty texture\n    if (this._emptyTexture) {\n      this._releaseTexture(this._emptyTexture);\n      this._emptyTexture = null;\n    }\n    if (this._emptyCubeTexture) {\n      this._releaseTexture(this._emptyCubeTexture);\n      this._emptyCubeTexture = null;\n    }\n    if (this._dummyFramebuffer) {\n      this._gl.deleteFramebuffer(this._dummyFramebuffer);\n    }\n    // Release effects\n    this.releaseEffects();\n    (_a = this.releaseComputeEffects) === null || _a === void 0 ? void 0 : _a.call(this);\n    // Unbind\n    this.unbindAllAttributes();\n    this._boundUniforms = {};\n    // Events\n    if (IsWindowObjectExist()) {\n      if (this._renderingCanvas) {\n        if (!this._doNotHandleContextLost) {\n          this._renderingCanvas.removeEventListener(\"webglcontextlost\", this._onContextLost);\n          this._renderingCanvas.removeEventListener(\"webglcontextrestored\", this._onContextRestored);\n        }\n        window.removeEventListener(\"resize\", this._checkForMobile);\n      }\n    }\n    this._workingCanvas = null;\n    this._workingContext = null;\n    this._currentBufferPointers.length = 0;\n    this._renderingCanvas = null;\n    this._currentProgram = null;\n    this._boundRenderFunction = null;\n    Effect.ResetCache();\n    // Abort active requests\n    for (const request of this._activeRequests) {\n      request.abort();\n    }\n    this.onDisposeObservable.notifyObservers(this);\n    this.onDisposeObservable.clear();\n    if (this._creationOptions.loseContextOnDispose) {\n      (_b = this._gl.getExtension(\"WEBGL_lose_context\")) === null || _b === void 0 ? void 0 : _b.loseContext();\n    }\n  }\n  /**\n   * Attach a new callback raised when context lost event is fired\n   * @param callback defines the callback to call\n   */\n  attachContextLostEvent(callback) {\n    if (this._renderingCanvas) {\n      this._renderingCanvas.addEventListener(\"webglcontextlost\", callback, false);\n    }\n  }\n  /**\n   * Attach a new callback raised when context restored event is fired\n   * @param callback defines the callback to call\n   */\n  attachContextRestoredEvent(callback) {\n    if (this._renderingCanvas) {\n      this._renderingCanvas.addEventListener(\"webglcontextrestored\", callback, false);\n    }\n  }\n  /**\n   * Get the current error code of the webGL context\n   * @returns the error code\n   * @see https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/getError\n   */\n  getError() {\n    return this._gl.getError();\n  }\n  _canRenderToFloatFramebuffer() {\n    if (this._webGLVersion > 1) {\n      return this._caps.colorBufferFloat;\n    }\n    return this._canRenderToFramebuffer(1);\n  }\n  _canRenderToHalfFloatFramebuffer() {\n    if (this._webGLVersion > 1) {\n      return this._caps.colorBufferFloat;\n    }\n    return this._canRenderToFramebuffer(2);\n  }\n  // Thank you : http://stackoverflow.com/questions/28827511/webgl-ios-render-to-floating-point-texture\n  _canRenderToFramebuffer(type) {\n    const gl = this._gl;\n    //clear existing errors\n    // eslint-disable-next-line no-empty\n    while (gl.getError() !== gl.NO_ERROR) {}\n    let successful = true;\n    const texture = gl.createTexture();\n    gl.bindTexture(gl.TEXTURE_2D, texture);\n    gl.texImage2D(gl.TEXTURE_2D, 0, this._getRGBABufferInternalSizedFormat(type), 1, 1, 0, gl.RGBA, this._getWebGLTextureType(type), null);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n    const fb = gl.createFramebuffer();\n    gl.bindFramebuffer(gl.FRAMEBUFFER, fb);\n    gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, texture, 0);\n    const status = gl.checkFramebufferStatus(gl.FRAMEBUFFER);\n    successful = successful && status === gl.FRAMEBUFFER_COMPLETE;\n    successful = successful && gl.getError() === gl.NO_ERROR;\n    //try render by clearing frame buffer's color buffer\n    if (successful) {\n      gl.clear(gl.COLOR_BUFFER_BIT);\n      successful = successful && gl.getError() === gl.NO_ERROR;\n    }\n    //try reading from frame to ensure render occurs (just creating the FBO is not sufficient to determine if rendering is supported)\n    if (successful) {\n      //in practice it's sufficient to just read from the backbuffer rather than handle potentially issues reading from the texture\n      gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n      const readFormat = gl.RGBA;\n      const readType = gl.UNSIGNED_BYTE;\n      const buffer = new Uint8Array(4);\n      gl.readPixels(0, 0, 1, 1, readFormat, readType, buffer);\n      successful = successful && gl.getError() === gl.NO_ERROR;\n    }\n    //clean up\n    gl.deleteTexture(texture);\n    gl.deleteFramebuffer(fb);\n    gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n    //clear accumulated errors\n    // eslint-disable-next-line no-empty\n    while (!successful && gl.getError() !== gl.NO_ERROR) {}\n    return successful;\n  }\n  /**\n   * @internal\n   */\n  _getWebGLTextureType(type) {\n    if (this._webGLVersion === 1) {\n      switch (type) {\n        case 1:\n          return this._gl.FLOAT;\n        case 2:\n          return this._gl.HALF_FLOAT_OES;\n        case 0:\n          return this._gl.UNSIGNED_BYTE;\n        case 8:\n          return this._gl.UNSIGNED_SHORT_4_4_4_4;\n        case 9:\n          return this._gl.UNSIGNED_SHORT_5_5_5_1;\n        case 10:\n          return this._gl.UNSIGNED_SHORT_5_6_5;\n      }\n      return this._gl.UNSIGNED_BYTE;\n    }\n    switch (type) {\n      case 3:\n        return this._gl.BYTE;\n      case 0:\n        return this._gl.UNSIGNED_BYTE;\n      case 4:\n        return this._gl.SHORT;\n      case 5:\n        return this._gl.UNSIGNED_SHORT;\n      case 6:\n        return this._gl.INT;\n      case 7:\n        // Refers to UNSIGNED_INT\n        return this._gl.UNSIGNED_INT;\n      case 1:\n        return this._gl.FLOAT;\n      case 2:\n        return this._gl.HALF_FLOAT;\n      case 8:\n        return this._gl.UNSIGNED_SHORT_4_4_4_4;\n      case 9:\n        return this._gl.UNSIGNED_SHORT_5_5_5_1;\n      case 10:\n        return this._gl.UNSIGNED_SHORT_5_6_5;\n      case 11:\n        return this._gl.UNSIGNED_INT_2_10_10_10_REV;\n      case 12:\n        return this._gl.UNSIGNED_INT_24_8;\n      case 13:\n        return this._gl.UNSIGNED_INT_10F_11F_11F_REV;\n      case 14:\n        return this._gl.UNSIGNED_INT_5_9_9_9_REV;\n      case 15:\n        return this._gl.FLOAT_32_UNSIGNED_INT_24_8_REV;\n    }\n    return this._gl.UNSIGNED_BYTE;\n  }\n  /**\n   * @internal\n   */\n  _getInternalFormat(format) {\n    let useSRGBBuffer = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n    let internalFormat = useSRGBBuffer ? this._glSRGBExtensionValues.SRGB8_ALPHA8 : this._gl.RGBA;\n    switch (format) {\n      case 0:\n        internalFormat = this._gl.ALPHA;\n        break;\n      case 1:\n        internalFormat = this._gl.LUMINANCE;\n        break;\n      case 2:\n        internalFormat = this._gl.LUMINANCE_ALPHA;\n        break;\n      case 6:\n        internalFormat = this._gl.RED;\n        break;\n      case 7:\n        internalFormat = this._gl.RG;\n        break;\n      case 4:\n        internalFormat = useSRGBBuffer ? this._glSRGBExtensionValues.SRGB : this._gl.RGB;\n        break;\n      case 5:\n        internalFormat = useSRGBBuffer ? this._glSRGBExtensionValues.SRGB8_ALPHA8 : this._gl.RGBA;\n        break;\n    }\n    if (this._webGLVersion > 1) {\n      switch (format) {\n        case 8:\n          internalFormat = this._gl.RED_INTEGER;\n          break;\n        case 9:\n          internalFormat = this._gl.RG_INTEGER;\n          break;\n        case 10:\n          internalFormat = this._gl.RGB_INTEGER;\n          break;\n        case 11:\n          internalFormat = this._gl.RGBA_INTEGER;\n          break;\n      }\n    }\n    return internalFormat;\n  }\n  /**\n   * @internal\n   */\n  _getRGBABufferInternalSizedFormat(type, format) {\n    let useSRGBBuffer = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    if (this._webGLVersion === 1) {\n      if (format !== undefined) {\n        switch (format) {\n          case 0:\n            return this._gl.ALPHA;\n          case 1:\n            return this._gl.LUMINANCE;\n          case 2:\n            return this._gl.LUMINANCE_ALPHA;\n          case 4:\n            return useSRGBBuffer ? this._glSRGBExtensionValues.SRGB : this._gl.RGB;\n        }\n      }\n      return this._gl.RGBA;\n    }\n    switch (type) {\n      case 3:\n        switch (format) {\n          case 6:\n            return this._gl.R8_SNORM;\n          case 7:\n            return this._gl.RG8_SNORM;\n          case 4:\n            return this._gl.RGB8_SNORM;\n          case 8:\n            return this._gl.R8I;\n          case 9:\n            return this._gl.RG8I;\n          case 10:\n            return this._gl.RGB8I;\n          case 11:\n            return this._gl.RGBA8I;\n          default:\n            return this._gl.RGBA8_SNORM;\n        }\n      case 0:\n        switch (format) {\n          case 6:\n            return this._gl.R8;\n          case 7:\n            return this._gl.RG8;\n          case 4:\n            return useSRGBBuffer ? this._glSRGBExtensionValues.SRGB8 : this._gl.RGB8;\n          // By default. Other possibilities are RGB565, SRGB8.\n          case 5:\n            return useSRGBBuffer ? this._glSRGBExtensionValues.SRGB8_ALPHA8 : this._gl.RGBA8;\n          // By default. Other possibilities are RGB5_A1, RGBA4, SRGB8_ALPHA8.\n          case 8:\n            return this._gl.R8UI;\n          case 9:\n            return this._gl.RG8UI;\n          case 10:\n            return this._gl.RGB8UI;\n          case 11:\n            return this._gl.RGBA8UI;\n          case 0:\n            return this._gl.ALPHA;\n          case 1:\n            return this._gl.LUMINANCE;\n          case 2:\n            return this._gl.LUMINANCE_ALPHA;\n          default:\n            return this._gl.RGBA8;\n        }\n      case 4:\n        switch (format) {\n          case 8:\n            return this._gl.R16I;\n          case 9:\n            return this._gl.RG16I;\n          case 10:\n            return this._gl.RGB16I;\n          case 11:\n            return this._gl.RGBA16I;\n          default:\n            return this._gl.RGBA16I;\n        }\n      case 5:\n        switch (format) {\n          case 8:\n            return this._gl.R16UI;\n          case 9:\n            return this._gl.RG16UI;\n          case 10:\n            return this._gl.RGB16UI;\n          case 11:\n            return this._gl.RGBA16UI;\n          default:\n            return this._gl.RGBA16UI;\n        }\n      case 6:\n        switch (format) {\n          case 8:\n            return this._gl.R32I;\n          case 9:\n            return this._gl.RG32I;\n          case 10:\n            return this._gl.RGB32I;\n          case 11:\n            return this._gl.RGBA32I;\n          default:\n            return this._gl.RGBA32I;\n        }\n      case 7:\n        // Refers to UNSIGNED_INT\n        switch (format) {\n          case 8:\n            return this._gl.R32UI;\n          case 9:\n            return this._gl.RG32UI;\n          case 10:\n            return this._gl.RGB32UI;\n          case 11:\n            return this._gl.RGBA32UI;\n          default:\n            return this._gl.RGBA32UI;\n        }\n      case 1:\n        switch (format) {\n          case 6:\n            return this._gl.R32F;\n          // By default. Other possibility is R16F.\n          case 7:\n            return this._gl.RG32F;\n          // By default. Other possibility is RG16F.\n          case 4:\n            return this._gl.RGB32F;\n          // By default. Other possibilities are RGB16F, R11F_G11F_B10F, RGB9_E5.\n          case 5:\n            return this._gl.RGBA32F;\n          // By default. Other possibility is RGBA16F.\n          default:\n            return this._gl.RGBA32F;\n        }\n      case 2:\n        switch (format) {\n          case 6:\n            return this._gl.R16F;\n          case 7:\n            return this._gl.RG16F;\n          case 4:\n            return this._gl.RGB16F;\n          // By default. Other possibilities are R11F_G11F_B10F, RGB9_E5.\n          case 5:\n            return this._gl.RGBA16F;\n          default:\n            return this._gl.RGBA16F;\n        }\n      case 10:\n        return this._gl.RGB565;\n      case 13:\n        return this._gl.R11F_G11F_B10F;\n      case 14:\n        return this._gl.RGB9_E5;\n      case 8:\n        return this._gl.RGBA4;\n      case 9:\n        return this._gl.RGB5_A1;\n      case 11:\n        switch (format) {\n          case 5:\n            return this._gl.RGB10_A2;\n          // By default. Other possibility is RGB5_A1.\n          case 11:\n            return this._gl.RGB10_A2UI;\n          default:\n            return this._gl.RGB10_A2;\n        }\n    }\n    return useSRGBBuffer ? this._glSRGBExtensionValues.SRGB8_ALPHA8 : this._gl.RGBA8;\n  }\n  /**\n   * @internal\n   */\n  _getRGBAMultiSampleBufferFormat(type) {\n    let format = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 5;\n    switch (type) {\n      case 1:\n        switch (format) {\n          case 6:\n            return this._gl.R32F;\n          default:\n            return this._gl.RGBA32F;\n        }\n      case 2:\n        switch (format) {\n          case 6:\n            return this._gl.R16F;\n          default:\n            return this._gl.RGBA16F;\n        }\n    }\n    return this._gl.RGBA8;\n  }\n  /**\n   * @internal\n   */\n  _loadFile(url, onSuccess, onProgress, offlineProvider, useArrayBuffer, onError) {\n    const request = ThinEngine._FileToolsLoadFile(url, onSuccess, onProgress, offlineProvider, useArrayBuffer, onError);\n    this._activeRequests.push(request);\n    request.onCompleteObservable.add(request => {\n      this._activeRequests.splice(this._activeRequests.indexOf(request), 1);\n    });\n    return request;\n  }\n  /**\n   * Loads a file from a url\n   * @param url url to load\n   * @param onSuccess callback called when the file successfully loads\n   * @param onProgress callback called while file is loading (if the server supports this mode)\n   * @param offlineProvider defines the offline provider for caching\n   * @param useArrayBuffer defines a boolean indicating that date must be returned as ArrayBuffer\n   * @param onError callback called when the file fails to load\n   * @returns a file request object\n   * @internal\n   */\n  static _FileToolsLoadFile(url, onSuccess, onProgress, offlineProvider, useArrayBuffer, onError) {\n    throw _WarnImport(\"FileTools\");\n  }\n  /**\n   * Reads pixels from the current frame buffer. Please note that this function can be slow\n   * @param x defines the x coordinate of the rectangle where pixels must be read\n   * @param y defines the y coordinate of the rectangle where pixels must be read\n   * @param width defines the width of the rectangle where pixels must be read\n   * @param height defines the height of the rectangle where pixels must be read\n   * @param hasAlpha defines whether the output should have alpha or not (defaults to true)\n   * @param flushRenderer true to flush the renderer from the pending commands before reading the pixels\n   * @returns a ArrayBufferView promise (Uint8Array) containing RGBA colors\n   */\n  readPixels(x, y, width, height) {\n    let hasAlpha = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : true;\n    let flushRenderer = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : true;\n    const numChannels = hasAlpha ? 4 : 3;\n    const format = hasAlpha ? this._gl.RGBA : this._gl.RGB;\n    const data = new Uint8Array(height * width * numChannels);\n    if (flushRenderer) {\n      this.flushFramebuffer();\n    }\n    this._gl.readPixels(x, y, width, height, format, this._gl.UNSIGNED_BYTE, data);\n    return Promise.resolve(data);\n  }\n  /**\n   * Gets a Promise<boolean> indicating if the engine can be instantiated (ie. if a webGL context can be found)\n   */\n  static get IsSupportedAsync() {\n    return Promise.resolve(this.isSupported());\n  }\n  /**\n   * Gets a boolean indicating if the engine can be instantiated (ie. if a webGL context can be found)\n   */\n  static get IsSupported() {\n    return this.isSupported(); // Backward compat\n  }\n  /**\n   * Gets a boolean indicating if the engine can be instantiated (ie. if a webGL context can be found)\n   * @returns true if the engine can be created\n   * @ignorenaming\n   */\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  static isSupported() {\n    if (this._HasMajorPerformanceCaveat !== null) {\n      return !this._HasMajorPerformanceCaveat; // We know it is performant so WebGL is supported\n    }\n\n    if (this._IsSupported === null) {\n      try {\n        const tempcanvas = this._CreateCanvas(1, 1);\n        const gl = tempcanvas.getContext(\"webgl\") || tempcanvas.getContext(\"experimental-webgl\");\n        this._IsSupported = gl != null && !!window.WebGLRenderingContext;\n      } catch (e) {\n        this._IsSupported = false;\n      }\n    }\n    return this._IsSupported;\n  }\n  /**\n   * Gets a boolean indicating if the engine can be instantiated on a performant device (ie. if a webGL context can be found and it does not use a slow implementation)\n   */\n  static get HasMajorPerformanceCaveat() {\n    if (this._HasMajorPerformanceCaveat === null) {\n      try {\n        const tempcanvas = this._CreateCanvas(1, 1);\n        const gl = tempcanvas.getContext(\"webgl\", {\n          failIfMajorPerformanceCaveat: true\n        }) || tempcanvas.getContext(\"experimental-webgl\", {\n          failIfMajorPerformanceCaveat: true\n        });\n        this._HasMajorPerformanceCaveat = !gl;\n      } catch (e) {\n        this._HasMajorPerformanceCaveat = false;\n      }\n    }\n    return this._HasMajorPerformanceCaveat;\n  }\n  /**\n   * Find the next highest power of two.\n   * @param x Number to start search from.\n   * @returns Next highest power of two.\n   */\n  static CeilingPOT(x) {\n    x--;\n    x |= x >> 1;\n    x |= x >> 2;\n    x |= x >> 4;\n    x |= x >> 8;\n    x |= x >> 16;\n    x++;\n    return x;\n  }\n  /**\n   * Find the next lowest power of two.\n   * @param x Number to start search from.\n   * @returns Next lowest power of two.\n   */\n  static FloorPOT(x) {\n    x = x | x >> 1;\n    x = x | x >> 2;\n    x = x | x >> 4;\n    x = x | x >> 8;\n    x = x | x >> 16;\n    return x - (x >> 1);\n  }\n  /**\n   * Find the nearest power of two.\n   * @param x Number to start search from.\n   * @returns Next nearest power of two.\n   */\n  static NearestPOT(x) {\n    const c = ThinEngine.CeilingPOT(x);\n    const f = ThinEngine.FloorPOT(x);\n    return c - x > x - f ? f : c;\n  }\n  /**\n   * Get the closest exponent of two\n   * @param value defines the value to approximate\n   * @param max defines the maximum value to return\n   * @param mode defines how to define the closest value\n   * @returns closest exponent of two of the given value\n   */\n  static GetExponentOfTwo(value, max) {\n    let mode = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 2;\n    let pot;\n    switch (mode) {\n      case 1:\n        pot = ThinEngine.FloorPOT(value);\n        break;\n      case 2:\n        pot = ThinEngine.NearestPOT(value);\n        break;\n      case 3:\n      default:\n        pot = ThinEngine.CeilingPOT(value);\n        break;\n    }\n    return Math.min(pot, max);\n  }\n  /**\n   * Queue a new function into the requested animation frame pool (ie. this function will be executed by the browser (or the javascript engine) for the next frame)\n   * @param func - the function to be called\n   * @param requester - the object that will request the next frame. Falls back to window.\n   * @returns frame number\n   */\n  static QueueNewFrame(func, requester) {\n    // Note that there is kind of a typing issue here, as `setTimeout` might return something else than a number (NodeJs returns a NodeJS.Timeout object).\n    // Also if the global `requestAnimationFrame`'s returnType is number, `requester.requestPostAnimationFrame` and `requester.requestAnimationFrame` types\n    // are `any`.\n    if (!IsWindowObjectExist()) {\n      if (typeof requestAnimationFrame === \"function\") {\n        return requestAnimationFrame(func);\n      }\n    } else {\n      const {\n        requestAnimationFrame\n      } = requester || window;\n      if (typeof requestAnimationFrame === \"function\") {\n        return requestAnimationFrame(func);\n      }\n    }\n    // fallback to the global `setTimeout`.\n    // In most cases (aka in the browser), `window` is the global object, so instead of calling `window.setTimeout` we could call the global `setTimeout`.\n    return setTimeout(func, 16);\n  }\n  /**\n   * Gets host document\n   * @returns the host document object\n   */\n  getHostDocument() {\n    if (this._renderingCanvas && this._renderingCanvas.ownerDocument) {\n      return this._renderingCanvas.ownerDocument;\n    }\n    return IsDocumentAvailable() ? document : null;\n  }\n}\nThinEngine._TempClearColorUint32 = new Uint32Array(4);\nThinEngine._TempClearColorInt32 = new Int32Array(4);\n/** Use this array to turn off some WebGL2 features on known buggy browsers version */\nThinEngine.ExceptionList = [{\n  key: \"Chrome/63.0\",\n  capture: \"63\\\\.0\\\\.3239\\\\.(\\\\d+)\",\n  captureConstraint: 108,\n  targets: [\"uniformBuffer\"]\n}, {\n  key: \"Firefox/58\",\n  capture: null,\n  captureConstraint: null,\n  targets: [\"uniformBuffer\"]\n}, {\n  key: \"Firefox/59\",\n  capture: null,\n  captureConstraint: null,\n  targets: [\"uniformBuffer\"]\n}, {\n  key: \"Chrome/72.+?Mobile\",\n  capture: null,\n  captureConstraint: null,\n  targets: [\"vao\"]\n}, {\n  key: \"Chrome/73.+?Mobile\",\n  capture: null,\n  captureConstraint: null,\n  targets: [\"vao\"]\n}, {\n  key: \"Chrome/74.+?Mobile\",\n  capture: null,\n  captureConstraint: null,\n  targets: [\"vao\"]\n}, {\n  key: \"Mac OS.+Chrome/71\",\n  capture: null,\n  captureConstraint: null,\n  targets: [\"vao\"]\n}, {\n  key: \"Mac OS.+Chrome/72\",\n  capture: null,\n  captureConstraint: null,\n  targets: [\"vao\"]\n}, {\n  key: \"Mac OS.+Chrome\",\n  capture: null,\n  captureConstraint: null,\n  targets: [\"uniformBuffer\"]\n},\n// desktop osx safari 15.4\n{\n  key: \".*AppleWebKit.*(15.4).*Safari\",\n  capture: null,\n  captureConstraint: null,\n  targets: [\"antialias\", \"maxMSAASamples\"]\n},\n// mobile browsers using safari 15.4 on ios\n{\n  key: \".*(15.4).*AppleWebKit.*Safari\",\n  capture: null,\n  captureConstraint: null,\n  targets: [\"antialias\", \"maxMSAASamples\"]\n}];\n/** @internal */\nThinEngine._TextureLoaders = [];\n// Updatable statics so stick with vars here\n/**\n * Gets or sets the epsilon value used by collision engine\n */\nThinEngine.CollisionsEpsilon = 0.001;\n// Statics\nThinEngine._IsSupported = null;\nThinEngine._HasMajorPerformanceCaveat = null;"],"names":["BufferPointer","ThinEngine","NpmPackage","Version","description","this","name","webGLVersion","_caps","parallelShaderCompile","_name","value","version","_webGLVersion","isDisposed","_isDisposed","ShadersRepository","_getShaderProcessor","shaderLanguage","_shaderProcessor","useReverseDepthBuffer","_useReverseDepthBuffer","useReverse","_depthCullingState","depthFunc","frameId","_frameId","supportsUniformBuffers","disableUniformBuffers","getCreationOptions","_creationOptions","_shouldUseHighPrecisionShader","highPrecisionShaderSupported","_highPrecisionShadersAllowed","needPOTTextures","forcePOTTextures","activeRenderLoops","_activeRenderLoops","doNotHandleContextLost","_doNotHandleContextLost","_supportsHardwareTextureRescaling","framebufferDimensionsObject","dimensions","_framebufferDimensionsObject","currentViewport","_cachedViewport","emptyTexture","_emptyTexture","createRawTexture","Uint8Array","emptyTexture3D","_emptyTexture3D","createRawTexture3D","emptyTexture2DArray","_emptyTexture2DArray","createRawTexture2DArray","emptyCubeTexture","_emptyCubeTexture","faceData","cubeData","createRawCubeTexture","isWebGPU","_isWebGPU","shaderPlatformName","_shaderPlatformName","snapshotRendering","activate","snapshotRenderingMode","_snapshotRenderingMode","mode","snapshotRenderingReset","_CreateCanvas","width","height","document","OffscreenCanvas","canvas","createElement","createCanvas","createCanvasImage","constructor","canvasOrContext","antialias","options","adaptToDeviceRatio","_a","_b","_c","_d","_e","_f","_g","_h","_j","_k","_l","isFullscreen","cullBackFaces","renderEvenInBackground","preventCacheWipeBetweenFrames","validateShaderPrograms","isNDCHalfZRange","hasOriginBottomLeft","onDisposeObservable","_uniformBuffers","Array","_storageBuffers","_windowIsBackground","_badOS","_badDesktopOS","_renderingQueueLaunched","onContextLostObservable","onContextRestoredObservable","_contextWasLost","disableVertexArrayObjects","_colorWrite","_colorWriteChanged","_stencilStateComposer","_stencilState","_alphaState","_alphaMode","_alphaEquation","_internalTexturesCache","_renderTargetWrapperCache","_activeChannel","_currentTextureChannel","_boundTexturesCache","_compiledEffects","_vertexAttribArraysEnabled","_uintIndicesCurrentlySet","_currentBoundBuffer","_currentFramebuffer","_dummyFramebuffer","_currentBufferPointers","_currentInstanceLocations","_currentInstanceBuffers","_vaoRecordInProgress","_mustWipeVertexAttributes","_nextFreeTextureSlots","_maxSimultaneousTextures","_maxMSAASamplesOverride","_activeRequests","_lastDevicePixelRatio","_transformTextureUrl","hostInformation","isMobile","premultipliedAlpha","onBeforeTextureInitObservable","_viewportCached","x","y","z","w","_unpackFlipYCached","enableUnpackFlipYCached","_boundUniforms","startTime","Now","stencilGlobal","SetMatrixPrecision","useHighPrecisionMatrix","deterministicLockstep","lockstepMaxSteps","timeStep","audioEngine","stencil","_audioContext","audioEngineOptions","audioContext","_audioDestination","audioDestination","useExactSrgbConversions","_isStencilEnable","devicePixelRatio","window","limitDeviceRatio","_hardwareScalingLevel","Math","min","getContext","_renderingCanvas","undefined","preserveDrawingBuffer","xrCompatible","navigator","userAgent","_setupMobileChecks","ua","exception","ExceptionList","key","targets","RegExp","test","capture","captureConstraint","constraint","matches","exec","length","parseInt","target","_onContextLost","evt","preventDefault","Warn","notifyObservers","_onContextRestored","_restoreEngineAfterContextLost","_initGLContext","addEventListener","powerPreference","disableWebGL2Support","_gl","deleteQuery","e","Error","renderbufferStorageMultisample","attributes","getContextAttributes","pixelStorei","UNPACK_COLORSPACE_CONVERSION_WEBGL","NONE","useHighPrecisionFloats","resize","_initFeatures","i","maxVertexAttribs","versionToLog","console","log","setAttribute","_checkForMobile","currentUA","indexOf","initEngine","setTimeout","async","depthTest","depthMask","stencilTest","wipeCaches","_rebuildEffects","_rebuildComputeEffects","call","_rebuildBuffers","_rebuildInternalTextures","_rebuildRenderTargetWrappers","_sharedInit","_getShaderProcessingContext","currentState","slice","internalTexture","_rebuild","renderTargetWrapper","effect","_pipelineContext","_wasPreviouslyReady","_prepareEffect","ResetCache","areAllEffectsReady","isReady","uniformBuffer","storageBuffer","maxTexturesImageUnits","getParameter","MAX_TEXTURE_IMAGE_UNITS","maxCombinedTexturesImageUnits","MAX_COMBINED_TEXTURE_IMAGE_UNITS","maxVertexTextureImageUnits","MAX_VERTEX_TEXTURE_IMAGE_UNITS","maxTextureSize","MAX_TEXTURE_SIZE","maxSamples","MAX_SAMPLES","maxCubemapTextureSize","MAX_CUBE_MAP_TEXTURE_SIZE","maxRenderTextureSize","MAX_RENDERBUFFER_SIZE","MAX_VERTEX_ATTRIBS","maxVaryingVectors","MAX_VARYING_VECTORS","maxFragmentUniformVectors","MAX_FRAGMENT_UNIFORM_VECTORS","maxVertexUniformVectors","MAX_VERTEX_UNIFORM_VECTORS","getExtension","standardDerivatives","maxAnisotropy","astc","bptc","s3tc","s3tc_srgb","pvrtc","etc1","etc2","textureAnisotropicFilterExtension","uintIndices","fragmentDepthSupported","timerQuery","supportOcclusionQuery","canUseTimestampForTimerQuery","drawBuffersExtension","maxMSAASamples","colorBufferFloat","colorBufferHalfFloat","textureFloat","textureHalfFloat","textureHalfFloatRender","textureFloatLinearFiltering","textureFloatRender","textureHalfFloatLinearFiltering","vertexArrayObject","instancedArrays","textureLOD","texelFetch","blendMinMax","multiview","oculusMultiview","depthTextureExtension","canUseGLInstanceID","canUseGLVertexID","supportComputeShaders","supportSRGBBuffers","supportTransformFeedbacks","textureMaxLevel","texture2DArrayMaxLayerCount","MAX_ARRAY_TEXTURE_LAYERS","disableMorphTargetTexture","_glVersion","VERSION","rendererInfo","_glRenderer","UNMASKED_RENDERER_WEBGL","_glVendor","UNMASKED_VENDOR_WEBGL","VENDOR","RENDERER","HALF_FLOAT_OES","RGBA16F","RGBA32F","DEPTH24_STENCIL8","getQuery","getQueryEXT","bind","TIMESTAMP_EXT","QUERY_COUNTER_BITS_EXT","MAX_TEXTURE_MAX_ANISOTROPY_EXT","_canRenderToFloatFramebuffer","COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR","COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT","COMPRESSED_SRGB_S3TC_DXT1_EXT","COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT","COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT","COMPRESSED_SRGB8_ETC2","COMPRESSED_SRGB8_ALPHA8_ETC2_EAC","_canRenderToHalfFloatFramebuffer","drawBuffers","drawBuffersWEBGL","DRAW_FRAMEBUFFER","FRAMEBUFFER","UNSIGNED_INT_24_8","UNSIGNED_INT_24_8_WEBGL","vertexArrayObjectExtension","createVertexArray","createVertexArrayOES","bindVertexArray","bindVertexArrayOES","deleteVertexArray","deleteVertexArrayOES","instanceExtension","drawArraysInstanced","drawArraysInstancedANGLE","drawElementsInstanced","drawElementsInstancedANGLE","vertexAttribDivisor","vertexAttribDivisorANGLE","getShaderPrecisionFormat","vertexhighp","VERTEX_SHADER","HIGH_FLOAT","fragmenthighp","FRAGMENT_SHADER","precision","blendMinMaxExtension","MAX","MAX_EXT","MIN","MIN_EXT","_glSRGBExtensionValues","SRGB","WebGL2RenderingContext","SRGB8","SRGB8_ALPHA8","sRGBExtension","SRGB_EXT","SRGB_ALPHA_EXT","forceSRGBBufferSupportState","LEQUAL","slot","push","_features","forceBitmapOverHTMLImageElement","supportRenderAndCopyToLodForFloatTextures","supportDepthStencilTexture","supportShadowSamplers","uniformBufferHardCheckMatrix","allowTexturePrefiltering","trackUbosInFrame","checkUbosContentBeforeUpload","supportCSM","basisNeedsPOT","support3DTextures","needTypeSuffixInShaderConstants","supportMSAA","supportSSAO2","supportExtendedTextureFormats","supportSwitchCaseInShader","supportSyncTextureRead","needsInvertingBitmap","useUBOBindingCache","needShaderCodeInlining","needToAlwaysBindUniformBuffers","supportRenderPasses","supportSpriteInstancing","forceVertexBufferStrideMultiple4Bytes","_collectUbosUpdatedInFrame","getClassName","isStencilEnable","_prepareWorkingCanvas","_workingCanvas","context","_workingContext","resetTextureCache","Object","prototype","hasOwnProperty","getInfo","getGlInfo","vendor","renderer","setHardwareScalingLevel","level","getHardwareScalingLevel","getLoadedTexturesCache","getCaps","stopRenderLoop","renderFunction","_cancelFrame","index","splice","_frameHandler","cancelAnimationFrame","getHostWindow","clearTimeout","_renderLoop","shouldRender","beginFrame","endFrame","_queueNewFrame","_boundRenderFunction","getRenderingCanvas","getAudioContext","getAudioDestination","ownerDocument","defaultView","getRenderWidth","arguments","_currentRenderTarget","framebufferWidth","drawingBufferWidth","getRenderHeight","framebufferHeight","drawingBufferHeight","bindedRenderFunction","requester","QueueNewFrame","runRenderLoop","clear","color","backBuffer","depth","useStencilGlobalOnly","stencilStateComposer","applyStates","setBackBufferColor","textureFormat","texture","format","textureType","type","_TempClearColorUint32","r","g","b","a","clearBufferuiv","COLOR","_TempClearColorInt32","clearBufferiv","clearColor","COLOR_BUFFER_BIT","GEQUAL","clearDepth","DEPTH_BUFFER_BIT","clearStencil","STENCIL_BUFFER_BIT","_viewport","viewport","setViewport","requiredWidth","requiredHeight","flushFramebuffer","forceSetSize","changeRatio","boundingRect","getBoundingClientRect","clientWidth","clientHeight","innerWidth","innerHeight","setSize","bindFramebuffer","rtWrapper","faceIndex","forceFullscreenViewport","lodLevel","layer","webglRTWrapper","unBindFramebuffer","_bindUnboundFramebuffer","_MSAAFramebuffer","_framebuffer","gl","isMulti","is2DArray","framebufferTextureLayer","COLOR_ATTACHMENT0","_hardwareTexture","underlyingResource","isCube","framebufferTexture2D","TEXTURE_CUBE_MAP_POSITIVE_X","_currentLOD","TEXTURE_2D","depthStencilTexture","_depthStencilTexture","attachment","_depthStencilTextureWithStencil","DEPTH_STENCIL_ATTACHMENT","DEPTH_ATTACHMENT","pow","setState","culling","zOffset","force","reverseSide","zOffsetUnits","cull","cullFace","BACK","FRONT","setZOffset","setZOffsetUnits","frontFace","CW","CCW","stencilMaterial","getDepthBuffer","setDepthBuffer","enable","getZOffset","getZOffsetUnits","framebuffer","_currentFrameBufferIsDefaultFrameBuffer","generateMipmaps","_bindTextureDirectly","generateMipmap","disableGenerateMipMaps","onBeforeUnbind","unBindMultiColorAttachmentFramebuffer","READ_FRAMEBUFFER","blitFramebuffer","NEAREST","generateMipMaps","flush","restoreDefaultFramebuffer","_resetVertexBufferBinding","bindArrayBuffer","_cachedVertexBuffers","createVertexBuffer","data","_updatable","_label","_createVertexBuffer","STATIC_DRAW","usage","vbo","createBuffer","dataBuffer","bufferData","ARRAY_BUFFER","Float32Array","references","createDynamicVertexBuffer","DYNAMIC_DRAW","_resetIndexBufferBinding","bindIndexBuffer","_cachedIndexBuffer","createIndexBuffer","indices","updatable","_normalizeIndexData","ELEMENT_ARRAY_BUFFER","is32Bits","BYTES_PER_ELEMENT","Uint32Array","Uint16Array","buffer","_unbindVertexArrayObject","_bindBuffer","bindUniformBlock","pipelineContext","blockName","program","uniformLocation","getUniformBlockIndex","uniformBlockBinding","bindBuffer","updateArrayBuffer","bufferSubData","_vertexAttribPointer","indx","size","normalized","stride","offset","pointer","changed","active","UNSIGNED_INT","INT","vertexAttribIPointer","vertexAttribPointer","_bindIndexBufferWithCache","indexBuffer","_bindVertexBuffersAttributes","vertexBuffers","overrideVertexBuffers","getAttributesNames","unbindAllAttributes","order","getAttributeLocation","ai","vertexBuffer","enableVertexAttribArray","getBuffer","getSize","byteStride","byteOffset","getIsInstanced","getInstanceDivisor","recordVertexArrayObject","vao","bindVertexArrayObject","_cachedVertexArrayObject","bindBuffersDirectly","vertexDeclaration","vertexStrideSize","_cachedEffectForVertexBuffers","attributesCount","getAttributesCount","FLOAT","bindBuffers","unbindInstanceAttributes","boundBuffer","ul","instancesBuffer","offsetLocation","releaseVertexArrayObject","_releaseBuffer","_deleteBuffer","deleteBuffer","updateAndBindInstancesBuffer","offsetLocations","bindInstancesBuffer","attributesInfo","computeStride","attributeSize","_currentEffect","getAttributeLocationByName","attributeName","attributeType","divisor","disableInstanceAttributeByName","attributeLocation","disableInstanceAttribute","shouldClean","disableAttributeByIndex","disableVertexAttribArray","draw","useTriangles","indexStart","indexCount","instancesCount","drawElementsType","drawPointClouds","verticesStart","verticesCount","drawArraysType","drawUnIndexed","fillMode","_reportDrawCall","drawMode","_drawMode","indexFormat","UNSIGNED_SHORT","mult","drawElements","drawArrays","TRIANGLES","POINTS","LINES","LINE_LOOP","LINE_STRIP","TRIANGLE_STRIP","TRIANGLE_FAN","_releaseEffect","_key","getPipelineContext","_deletePipelineContext","webGLPipelineContext","__SPECTOR_rebuildProgram","deleteProgram","_getGlobalDefines","defines","s","createEffect","baseName","attributesNamesOrOptions","uniformsNamesOrEngine","samplers","fallbacks","onCompiled","onError","indexParameters","GLSL","vertex","vertexElement","vertexToken","vertexSource","fragment","fragmentElement","fragmentToken","fragmentSource","globalDefines","fullDefines","compiledEffect","_ConcatenateShader","source","_compileShader","shaderVersion","_compileRawShader","shader","createShader","error","NO_ERROR","tempError","getError","isContextLost","shaderSource","compileShader","_getShaderSource","getShaderSource","createRawShaderProgram","vertexCode","fragmentCode","transformFeedbackVaryings","vertexShader","fragmentShader","_createShaderProgram","createShaderProgram","inlineShaderCode","code","createPipelineContext","shaderProcessingContext","engine","isParallelCompiled","createMaterialContext","createDrawContext","shaderProgram","createProgram","attachShader","linkProgram","_finalizePipelineContext","getProgramParameter","LINK_STATUS","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","vertexCompilationError","fragmentCompilationError","getProgramInfoLog","programLinkError","validateProgram","VALIDATE_STATUS","programValidationError","deleteShader","_preparePipelineContext","vertexSourceCode","fragmentSourceCode","createAsRaw","rawVertexSourceCode","rawFragmentSourceCode","rebuildRebind","webGLRenderingState","_isRenderingStateCompiled","COMPLETION_STATUS_KHR","_executeWhenRenderingStateIsCompiled","action","oldHandler","getUniforms","uniformsNames","results","getUniformLocation","getAttributes","attributesNames","getAttribLocation","enableEffect","IsWrapper","bindSamplers","onBind","_onBindObservable","setInt","uniform","uniform1i","setInt2","uniform2i","setInt3","uniform3i","setInt4","uniform4i","setIntArray","array","uniform1iv","setIntArray2","uniform2iv","setIntArray3","uniform3iv","setIntArray4","uniform4iv","setUInt","uniform1ui","setUInt2","uniform2ui","setUInt3","uniform3ui","setUInt4","uniform4ui","setUIntArray","uniform1uiv","setUIntArray2","uniform2uiv","setUIntArray3","uniform3uiv","setUIntArray4","uniform4uiv","setArray","uniform1fv","setArray2","uniform2fv","setArray3","uniform3fv","setArray4","uniform4fv","setMatrices","matrices","uniformMatrix4fv","setMatrix3x3","matrix","uniformMatrix3fv","setMatrix2x2","uniformMatrix2fv","setFloat","uniform1f","setFloat2","uniform2f","setFloat3","uniform3f","setFloat4","uniform4f","apply","colorMask","setColorWrite","getColorWrite","depthCullingState","alphaState","stencilState","clearInternalTexturesCache","bruteForce","_currentProgram","reset","UNPACK_PREMULTIPLY_ALPHA_WEBGL","_getSamplingParameters","samplingMode","magFilter","minFilter","LINEAR","LINEAR_MIPMAP_NEAREST","LINEAR_MIPMAP_LINEAR","NEAREST_MIPMAP_LINEAR","NEAREST_MIPMAP_NEAREST","mag","_createTexture","createTexture","_createHardwareTexture","_createInternalTexture","Unknown","label","useSRGBBuffer","samples","layers","filters","TEXTURE_2D_ARRAY","sizedFormat","_getRGBABufferInternalSizedFormat","internalFormat","_getInternalFormat","_getWebGLTextureType","texImage3D","texImage2D","texParameteri","TEXTURE_MAG_FILTER","TEXTURE_MIN_FILTER","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","_useSRGBBuffer","baseWidth","baseHeight","_getUseSRGBBuffer","noMipmap","_createTextureBase","url","invertY","scene","onLoad","prepareTexture","prepareTextureProcessFunction","fallback","forcedExtension","mimeType","loaderOptions","fromData","substr","fromBlob","isBase64","Url","substring","originalUrl","_originalUrl","lastDot","lastIndexOf","extension","toLowerCase","loader","split","availableLoader","_TextureLoaders","canLoad","addPendingData","_buffer","onLoadObserver","onLoadedObservable","add","onInternalError","message","removePendingData","remove","UseFallbackTexture","FallbackTexture","onErrorObservable","callback","loadData","loadMipmap","isCompressed","done","loadFailed","ArrayBuffer","isView","_loadFile","offlineProvider","request","responseURL","onload","img","decoding","close","_FileToolsLoadImage","imageOrientation","Blob","_prepareWebGLTexture","potWidth","potHeight","continuationCallback","isPot","tip","_getTexImageParametersForCreateTexture","drawImage","Temp","_rescaleTexture","_releaseTexture","babylonFormat","fileExtension","UNSIGNED_BYTE","input","imageBitmapOptions","destination","onComplete","_unpackFlipY","UNPACK_FLIP_Y_WEBGL","_getUnpackAlignement","UNPACK_ALIGNMENT","_getTextureTarget","TEXTURE_CUBE_MAP","is3D","TEXTURE_3D","isMultiview","updateTextureSamplingMode","useMipMaps","_setTextureParameterInteger","updateTextureDimensions","updateTextureWrappingMode","wrapU","wrapV","wrapR","_getTextureWrapMode","_cachedWrapU","_cachedWrapV","TEXTURE_WRAP_R","_cachedWrapR","_setupDepthStencilTexture","generateStencil","bilinearFiltering","comparisonFunction","_comparisonFunction","samplingParameters","TEXTURE_COMPARE_FUNC","TEXTURE_COMPARE_MODE","COMPARE_REF_TO_TEXTURE","_uploadCompressedDataToTextureDirectly","lod","compressedTexImage2D","_uploadDataToTextureDirectly","imageData","babylonInternalFormat","useTextureWidthAndHeight","lodMaxWidth","round","LOG2E","lodMaxHeight","max","updateTextureData","xOffset","yOffset","targetForBinding","texSubImage2D","_uploadArrayBufferViewToTexture","bindTarget","_prepareWebGLTextureContinuation","processFunction","GetExponentOfTwo","_setupFramebufferDepthAttachments","generateStencilBuffer","generateDepthBuffer","_createRenderBuffer","DEPTH_STENCIL","depthFormat","DEPTH_COMPONENT16","DEPTH_COMPONENT32F","STENCIL_INDEX8","STENCIL_ATTACHMENT","msInternalFormat","unbindBuffer","renderBuffer","createRenderbuffer","_updateRenderBuffer","bindRenderbuffer","RENDERBUFFER","renderbufferStorage","framebufferRenderbuffer","_deleteTexture","unbindAllTextures","_lodTextureHigh","dispose","_lodTextureMid","_lodTextureLow","_irradianceTexture","_releaseRenderTargetWrapper","deleteTexture","_setProgram","useProgram","getSamplers","getUniform","_activateCurrentTexture","activeTexture","TEXTURE0","forTextureDataUpdate","wasPreviouslyBound","isTextureForRendering","_associatedChannel","bindTexture","_bindSamplerUniformToChannel","_bindTexture","channel","setTexture","_setTexture","sourceSlot","_currentState","REPEAT","MIRRORED_REPEAT","isPartOfTextureArray","video","videoInternalTexture","getInternalTexture","update","delayLoadState","delayLoad","needToBind","_cachedCoordinatesMode","coordinatesMode","textureWrapMode","_setAnisotropicLevel","anisotropicFilteringLevel","setTextureArray","textures","_textureUnits","Int32Array","anisotropicFilterExtension","_cachedAnisotropicFilteringLevel","_setTextureParameterFloat","TEXTURE_MAX_ANISOTROPY_EXT","parameter","texParameterf","releaseEffects","deleteFramebuffer","releaseComputeEffects","removeEventListener","abort","loseContextOnDispose","loseContext","attachContextLostEvent","attachContextRestoredEvent","_canRenderToFramebuffer","successful","RGBA","fb","createFramebuffer","status","checkFramebufferStatus","FRAMEBUFFER_COMPLETE","readFormat","readType","readPixels","UNSIGNED_SHORT_4_4_4_4","UNSIGNED_SHORT_5_5_5_1","UNSIGNED_SHORT_5_6_5","BYTE","SHORT","HALF_FLOAT","UNSIGNED_INT_2_10_10_10_REV","UNSIGNED_INT_10F_11F_11F_REV","UNSIGNED_INT_5_9_9_9_REV","FLOAT_32_UNSIGNED_INT_24_8_REV","ALPHA","LUMINANCE","LUMINANCE_ALPHA","RED","RG","RGB","RED_INTEGER","RG_INTEGER","RGB_INTEGER","RGBA_INTEGER","R8_SNORM","RG8_SNORM","RGB8_SNORM","R8I","RG8I","RGB8I","RGBA8I","RGBA8_SNORM","R8","RG8","RGB8","RGBA8","R8UI","RG8UI","RGB8UI","RGBA8UI","R16I","RG16I","RGB16I","RGBA16I","R16UI","RG16UI","RGB16UI","RGBA16UI","R32I","RG32I","RGB32I","RGBA32I","R32UI","RG32UI","RGB32UI","RGBA32UI","R32F","RG32F","RGB32F","R16F","RG16F","RGB16F","RGB565","R11F_G11F_B10F","RGB9_E5","RGBA4","RGB5_A1","RGB10_A2","RGB10_A2UI","_getRGBAMultiSampleBufferFormat","onSuccess","onProgress","useArrayBuffer","_FileToolsLoadFile","onCompleteObservable","hasAlpha","flushRenderer","numChannels","Promise","resolve","IsSupportedAsync","isSupported","IsSupported","_HasMajorPerformanceCaveat","_IsSupported","tempcanvas","WebGLRenderingContext","HasMajorPerformanceCaveat","failIfMajorPerformanceCaveat","CeilingPOT","FloorPOT","NearestPOT","c","f","pot","func","requestAnimationFrame","getHostDocument","CollisionsEpsilon"],"sourceRoot":""}