{"version":3,"file":"3a1a7810-f430c840c2f7c39b57c3.js","mappings":"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","sources":["webpack://@react-babylonjs/docs/../../node_modules/@babylonjs/core/Engines/thinEngine.js"],"sourcesContent":["import _asyncToGenerator from \"/home/runner/work/react-babylonjs/react-babylonjs/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _createClass from \"/home/runner/work/react-babylonjs/react-babylonjs/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _classCallCheck from \"/home/runner/work/react-babylonjs/react-babylonjs/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _regeneratorRuntime from \"/home/runner/work/react-babylonjs/react-babylonjs/node_modules/@babel/runtime/regenerator/index.js\";\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e2) { throw _e2; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e3) { didErr = true; err = _e3; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\n/* eslint-disable @typescript-eslint/no-unused-vars */\nimport { EngineStore } from \"./engineStore.js\";\nimport { Effect } from \"../Materials/effect.js\";\nimport { _WarnImport } from \"../Misc/devTools.js\";\nimport { Observable } from \"../Misc/observable.js\";\nimport { DepthCullingState } from \"../States/depthCullingState.js\";\nimport { StencilState } from \"../States/stencilState.js\";\nimport { AlphaState } from \"../States/alphaCullingState.js\";\nimport { InternalTexture, InternalTextureSource } from \"../Materials/Textures/internalTexture.js\";\nimport { Logger } from \"../Misc/logger.js\";\nimport { IsDocumentAvailable, IsWindowObjectExist } from \"../Misc/domManagement.js\";\nimport { WebGLShaderProcessor } from \"./WebGL/webGLShaderProcessors.js\";\nimport { WebGL2ShaderProcessor } from \"./WebGL/webGL2ShaderProcessors.js\";\nimport { WebGLDataBuffer } from \"../Meshes/WebGL/webGLDataBuffer.js\";\nimport { WebGLPipelineContext } from \"./WebGL/webGLPipelineContext.js\";\nimport { PerformanceConfigurator } from \"./performanceConfigurator.js\";\nimport { WebGLHardwareTexture } from \"./WebGL/webGLHardwareTexture.js\";\nimport { DrawWrapper } from \"../Materials/drawWrapper.js\";\nimport { StencilStateComposer } from \"../States/stencilStateComposer.js\";\nimport { ShaderLanguage } from \"../Materials/shaderLanguage.js\";\nimport { PrecisionDate } from \"../Misc/precisionDate.js\";\n/**\n * Keeps track of all the buffer info used in engine.\n */\nvar BufferPointer = /*#__PURE__*/_createClass(function BufferPointer() {\n  _classCallCheck(this, BufferPointer);\n});\n/**\n * The base engine class (root of all engines)\n */\nexport var ThinEngine = /*#__PURE__*/function () {\n  /**\n   * Creates a new engine\n   * @param canvasOrContext defines the canvas or WebGL context to use for rendering. If you provide a WebGL context, Babylon.js will not hook events on the canvas (like pointers, keyboards, etc...) so no event observables will be available. This is mostly used when Babylon.js is used as a plugin on a system which already used the WebGL context\n   * @param antialias defines enable antialiasing (default: false)\n   * @param options defines further options to be sent to the getContext() function\n   * @param adaptToDeviceRatio defines whether to adapt to the device's viewport characteristics (default: false)\n   */\n  function ThinEngine(canvasOrContext, antialias, options, adaptToDeviceRatio) {\n    var _this = this;\n    _classCallCheck(this, ThinEngine);\n    var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l;\n    /** @internal */\n    this._name = \"WebGL\";\n    this._isDisposed = false;\n    /**\n     * Gets or sets a boolean that indicates if textures must be forced to power of 2 size even if not required\n     */\n    this.forcePOTTextures = false;\n    /**\n     * Gets a boolean indicating if the engine is currently rendering in fullscreen mode\n     */\n    this.isFullscreen = false;\n    /**\n     * Gets or sets a boolean indicating if back faces must be culled. If false, front faces are culled instead (true by default)\n     * If non null, this takes precedence over the value from the material\n     */\n    this.cullBackFaces = null;\n    /**\n     * Gets or sets a boolean indicating if the engine must keep rendering even if the window is not in foreground\n     */\n    this.renderEvenInBackground = true;\n    /**\n     * Gets or sets a boolean indicating that cache can be kept between frames\n     */\n    this.preventCacheWipeBetweenFrames = false;\n    /** Gets or sets a boolean indicating if the engine should validate programs after compilation */\n    this.validateShaderPrograms = false;\n    this._useReverseDepthBuffer = false;\n    /**\n     * Indicates if the z range in NDC space is 0..1 (value: true) or -1..1 (value: false)\n     */\n    this.isNDCHalfZRange = false;\n    /**\n     * Indicates that the origin of the texture/framebuffer space is the bottom left corner. If false, the origin is top left\n     */\n    this.hasOriginBottomLeft = true;\n    /**\n     * Gets or sets a boolean indicating that uniform buffers must be disabled even if they are supported\n     */\n    this.disableUniformBuffers = false;\n    /**\n     * An event triggered when the engine is disposed.\n     */\n    this.onDisposeObservable = new Observable();\n    this._frameId = 0;\n    /** @internal */\n    this._uniformBuffers = new Array();\n    /** @internal */\n    this._storageBuffers = new Array();\n    /** @internal */\n    this._webGLVersion = 1.0;\n    this._windowIsBackground = false;\n    this._highPrecisionShadersAllowed = true;\n    /** @internal */\n    this._badOS = false;\n    /** @internal */\n    this._badDesktopOS = false;\n    this._renderingQueueLaunched = false;\n    this._activeRenderLoops = new Array();\n    // Lost context\n    /**\n     * Observable signaled when a context lost event is raised\n     */\n    this.onContextLostObservable = new Observable();\n    /**\n     * Observable signaled when a context restored event is raised\n     */\n    this.onContextRestoredObservable = new Observable();\n    this._contextWasLost = false;\n    /** @internal */\n    this._doNotHandleContextLost = false;\n    /**\n     * Gets or sets a boolean indicating that vertex array object must be disabled even if they are supported\n     */\n    this.disableVertexArrayObjects = false;\n    // States\n    /** @internal */\n    this._colorWrite = true;\n    /** @internal */\n    this._colorWriteChanged = true;\n    /** @internal */\n    this._depthCullingState = new DepthCullingState();\n    /** @internal */\n    this._stencilStateComposer = new StencilStateComposer();\n    /** @internal */\n    this._stencilState = new StencilState();\n    /** @internal */\n    this._alphaState = new AlphaState();\n    /** @internal */\n    this._alphaMode = 1;\n    /** @internal */\n    this._alphaEquation = 0;\n    // Cache\n    /** @internal */\n    this._internalTexturesCache = new Array();\n    /** @internal */\n    this._renderTargetWrapperCache = new Array();\n    /** @internal */\n    this._activeChannel = 0;\n    this._currentTextureChannel = -1;\n    /** @internal */\n    this._boundTexturesCache = {};\n    this._compiledEffects = {};\n    this._vertexAttribArraysEnabled = [];\n    this._uintIndicesCurrentlySet = false;\n    this._currentBoundBuffer = new Array();\n    /** @internal */\n    this._currentFramebuffer = null;\n    /** @internal */\n    this._dummyFramebuffer = null;\n    this._currentBufferPointers = new Array();\n    this._currentInstanceLocations = new Array();\n    this._currentInstanceBuffers = new Array();\n    this._vaoRecordInProgress = false;\n    this._mustWipeVertexAttributes = false;\n    this._nextFreeTextureSlots = new Array();\n    this._maxSimultaneousTextures = 0;\n    this._maxMSAASamplesOverride = null;\n    this._activeRequests = new Array();\n    /**\n     * If set to true zooming in and out in the browser will rescale the hardware-scaling correctly.\n     */\n    this.adaptToDeviceRatio = false;\n    /** @internal */\n    this._lastDevicePixelRatio = 1.0;\n    /** @internal */\n    this._transformTextureUrl = null;\n    /**\n     * Gets information about the current host\n     */\n    this.hostInformation = {\n      isMobile: false\n    };\n    /**\n     * Defines whether the engine has been created with the premultipliedAlpha option on or not.\n     */\n    this.premultipliedAlpha = true;\n    /**\n     * Observable event triggered before each texture is initialized\n     */\n    this.onBeforeTextureInitObservable = new Observable();\n    /** @internal */\n    this._isWebGPU = false;\n    this._snapshotRenderingMode = 0;\n    this._viewportCached = {\n      x: 0,\n      y: 0,\n      z: 0,\n      w: 0\n    };\n    this._unpackFlipYCached = null;\n    /**\n     * In case you are sharing the context with other applications, it might\n     * be interested to not cache the unpack flip y state to ensure a consistent\n     * value would be set.\n     */\n    this.enableUnpackFlipYCached = true;\n    this._boundUniforms = {};\n    this.startTime = PrecisionDate.Now;\n    var canvas = null;\n    options = options || {};\n    this._creationOptions = options;\n    // Save this off for use in resize().\n    this.adaptToDeviceRatio = adaptToDeviceRatio !== null && adaptToDeviceRatio !== void 0 ? adaptToDeviceRatio : false;\n    this._stencilStateComposer.stencilGlobal = this._stencilState;\n    PerformanceConfigurator.SetMatrixPrecision(!!options.useHighPrecisionMatrix);\n    options.antialias = antialias !== null && antialias !== void 0 ? antialias : options.antialias;\n    options.deterministicLockstep = (_a = options.deterministicLockstep) !== null && _a !== void 0 ? _a : false;\n    options.lockstepMaxSteps = (_b = options.lockstepMaxSteps) !== null && _b !== void 0 ? _b : 4;\n    options.timeStep = (_c = options.timeStep) !== null && _c !== void 0 ? _c : 1 / 60;\n    options.audioEngine = (_d = options.audioEngine) !== null && _d !== void 0 ? _d : true;\n    options.stencil = (_e = options.stencil) !== null && _e !== void 0 ? _e : true;\n    this._audioContext = (_g = (_f = options.audioEngineOptions) === null || _f === void 0 ? void 0 : _f.audioContext) !== null && _g !== void 0 ? _g : null;\n    this._audioDestination = (_j = (_h = options.audioEngineOptions) === null || _h === void 0 ? void 0 : _h.audioDestination) !== null && _j !== void 0 ? _j : null;\n    this.premultipliedAlpha = (_k = options.premultipliedAlpha) !== null && _k !== void 0 ? _k : true;\n    this.useExactSrgbConversions = (_l = options.useExactSrgbConversions) !== null && _l !== void 0 ? _l : false;\n    this._doNotHandleContextLost = !!options.doNotHandleContextLost;\n    this._isStencilEnable = options.stencil ? true : false;\n    // Viewport\n    adaptToDeviceRatio = adaptToDeviceRatio || options.adaptToDeviceRatio || false;\n    var devicePixelRatio = IsWindowObjectExist() ? window.devicePixelRatio || 1.0 : 1.0;\n    var limitDeviceRatio = options.limitDeviceRatio || devicePixelRatio;\n    this._hardwareScalingLevel = adaptToDeviceRatio ? 1.0 / Math.min(limitDeviceRatio, devicePixelRatio) : 1.0;\n    this._lastDevicePixelRatio = devicePixelRatio;\n    if (!canvasOrContext) {\n      return;\n    }\n    if (canvasOrContext.getContext) {\n      canvas = canvasOrContext;\n      this._renderingCanvas = canvas;\n      if (options.preserveDrawingBuffer === undefined) {\n        options.preserveDrawingBuffer = false;\n      }\n      if (options.xrCompatible === undefined) {\n        options.xrCompatible = true;\n      }\n      // Exceptions\n      if (navigator && navigator.userAgent) {\n        this._setupMobileChecks();\n        var ua = navigator.userAgent;\n        var _iterator = _createForOfIteratorHelper(ThinEngine.ExceptionList),\n          _step;\n        try {\n          for (_iterator.s(); !(_step = _iterator.n()).done;) {\n            var exception = _step.value;\n            var key = exception.key;\n            var targets = exception.targets;\n            var check = new RegExp(key);\n            if (check.test(ua)) {\n              if (exception.capture && exception.captureConstraint) {\n                var capture = exception.capture;\n                var constraint = exception.captureConstraint;\n                var regex = new RegExp(capture);\n                var matches = regex.exec(ua);\n                if (matches && matches.length > 0) {\n                  var capturedValue = parseInt(matches[matches.length - 1]);\n                  if (capturedValue >= constraint) {\n                    continue;\n                  }\n                }\n              }\n              var _iterator2 = _createForOfIteratorHelper(targets),\n                _step2;\n              try {\n                for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n                  var target = _step2.value;\n                  switch (target) {\n                    case \"uniformBuffer\":\n                      this.disableUniformBuffers = true;\n                      break;\n                    case \"vao\":\n                      this.disableVertexArrayObjects = true;\n                      break;\n                    case \"antialias\":\n                      options.antialias = false;\n                      break;\n                    case \"maxMSAASamples\":\n                      this._maxMSAASamplesOverride = 1;\n                      break;\n                  }\n                }\n              } catch (err) {\n                _iterator2.e(err);\n              } finally {\n                _iterator2.f();\n              }\n            }\n          }\n        } catch (err) {\n          _iterator.e(err);\n        } finally {\n          _iterator.f();\n        }\n      }\n      // Context lost\n      if (!this._doNotHandleContextLost) {\n        this._onContextLost = function (evt) {\n          evt.preventDefault();\n          _this._contextWasLost = true;\n          Logger.Warn(\"WebGL context lost.\");\n          _this.onContextLostObservable.notifyObservers(_this);\n        };\n        this._onContextRestored = function () {\n          _this._restoreEngineAfterContextLost(_this._initGLContext.bind(_this));\n        };\n        canvas.addEventListener(\"webglcontextlost\", this._onContextLost, false);\n        canvas.addEventListener(\"webglcontextrestored\", this._onContextRestored, false);\n        options.powerPreference = options.powerPreference || \"high-performance\";\n      }\n      // Detect if we are running on a faulty buggy desktop OS.\n      this._badDesktopOS = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);\n      if (this._badDesktopOS) {\n        options.xrCompatible = false;\n      }\n      // GL\n      if (!options.disableWebGL2Support) {\n        try {\n          this._gl = canvas.getContext(\"webgl2\", options) || canvas.getContext(\"experimental-webgl2\", options);\n          if (this._gl) {\n            this._webGLVersion = 2.0;\n            this._shaderPlatformName = \"WEBGL2\";\n            // Prevent weird browsers to lie (yeah that happens!)\n            if (!this._gl.deleteQuery) {\n              this._webGLVersion = 1.0;\n              this._shaderPlatformName = \"WEBGL1\";\n            }\n          }\n        } catch (e) {\n          // Do nothing\n        }\n      }\n      if (!this._gl) {\n        if (!canvas) {\n          throw new Error(\"The provided canvas is null or undefined.\");\n        }\n        try {\n          this._gl = canvas.getContext(\"webgl\", options) || canvas.getContext(\"experimental-webgl\", options);\n        } catch (e) {\n          throw new Error(\"WebGL not supported\");\n        }\n      }\n      if (!this._gl) {\n        throw new Error(\"WebGL not supported\");\n      }\n    } else {\n      this._gl = canvasOrContext;\n      this._renderingCanvas = this._gl.canvas;\n      if (this._gl.renderbufferStorageMultisample) {\n        this._webGLVersion = 2.0;\n        this._shaderPlatformName = \"WEBGL2\";\n      } else {\n        this._shaderPlatformName = \"WEBGL1\";\n      }\n      var attributes = this._gl.getContextAttributes();\n      if (attributes) {\n        options.stencil = attributes.stencil;\n      }\n    }\n    // Ensures a consistent color space unpacking of textures cross browser.\n    this._gl.pixelStorei(this._gl.UNPACK_COLORSPACE_CONVERSION_WEBGL, this._gl.NONE);\n    if (options.useHighPrecisionFloats !== undefined) {\n      this._highPrecisionShadersAllowed = options.useHighPrecisionFloats;\n    }\n    this.resize();\n    this._initGLContext();\n    this._initFeatures();\n    // Prepare buffer pointers\n    for (var i = 0; i < this._caps.maxVertexAttribs; i++) {\n      this._currentBufferPointers[i] = new BufferPointer();\n    }\n    // Shader processor\n    this._shaderProcessor = this.webGLVersion > 1 ? new WebGL2ShaderProcessor() : new WebGLShaderProcessor();\n    // Detect if we are running on a faulty buggy OS.\n    this._badOS = /iPad/i.test(navigator.userAgent) || /iPhone/i.test(navigator.userAgent);\n    // Starting with iOS 14, we can trust the browser\n    // let matches = navigator.userAgent.match(/Version\\/(\\d+)/);\n    // if (matches && matches.length === 2) {\n    //     if (parseInt(matches[1]) >= 14) {\n    //         this._badOS = false;\n    //     }\n    // }\n    var versionToLog = \"Babylon.js v\".concat(ThinEngine.Version);\n    console.log(versionToLog + \" - \".concat(this.description));\n    // Check setAttribute in case of workers\n    if (this._renderingCanvas && this._renderingCanvas.setAttribute) {\n      this._renderingCanvas.setAttribute(\"data-engine\", versionToLog);\n    }\n  }\n  _createClass(ThinEngine, [{\n    key: \"description\",\n    get:\n    /**\n     * Returns a string describing the current engine\n     */\n    function get() {\n      var description = this.name + this.webGLVersion;\n      if (this._caps.parallelShaderCompile) {\n        description += \" - Parallel shader compilation\";\n      }\n      return description;\n    }\n    /**\n     * Gets or sets the name of the engine\n     */\n  }, {\n    key: \"name\",\n    get: function get() {\n      return this._name;\n    },\n    set: function set(value) {\n      this._name = value;\n    }\n    /**\n     * Returns the version of the engine\n     */\n  }, {\n    key: \"version\",\n    get: function get() {\n      return this._webGLVersion;\n    }\n  }, {\n    key: \"isDisposed\",\n    get: function get() {\n      return this._isDisposed;\n    }\n    /**\n     * Gets or sets the relative url used to load shaders if using the engine in non-minified mode\n     */\n  }, {\n    key: \"_getShaderProcessor\",\n    value:\n    /**\n     * @internal\n     */\n    function _getShaderProcessor(shaderLanguage) {\n      return this._shaderProcessor;\n    }\n    /**\n     * Gets or sets a boolean indicating if depth buffer should be reverse, going from far to near.\n     * This can provide greater z depth for distant objects.\n     */\n  }, {\n    key: \"useReverseDepthBuffer\",\n    get: function get() {\n      return this._useReverseDepthBuffer;\n    },\n    set: function set(useReverse) {\n      if (useReverse === this._useReverseDepthBuffer) {\n        return;\n      }\n      this._useReverseDepthBuffer = useReverse;\n      if (useReverse) {\n        this._depthCullingState.depthFunc = 518;\n      } else {\n        this._depthCullingState.depthFunc = 515;\n      }\n    }\n    /**\n     * Gets the current frame id\n     */\n  }, {\n    key: \"frameId\",\n    get: function get() {\n      return this._frameId;\n    }\n    /**\n     * Gets a boolean indicating that the engine supports uniform buffers\n     * @see https://doc.babylonjs.com/setup/support/webGL2#uniform-buffer-objets\n     */\n  }, {\n    key: \"supportsUniformBuffers\",\n    get: function get() {\n      return this.webGLVersion > 1 && !this.disableUniformBuffers;\n    }\n    /**\n     * Gets the options used for engine creation\n     * @returns EngineOptions object\n     */\n  }, {\n    key: \"getCreationOptions\",\n    value: function getCreationOptions() {\n      return this._creationOptions;\n    }\n    /** @internal */\n  }, {\n    key: \"_shouldUseHighPrecisionShader\",\n    get: function get() {\n      return !!(this._caps.highPrecisionShaderSupported && this._highPrecisionShadersAllowed);\n    }\n    /**\n     * Gets a boolean indicating that only power of 2 textures are supported\n     * Please note that you can still use non power of 2 textures but in this case the engine will forcefully convert them\n     */\n  }, {\n    key: \"needPOTTextures\",\n    get: function get() {\n      return this._webGLVersion < 2 || this.forcePOTTextures;\n    }\n    /**\n     * Gets the list of current active render loop functions\n     * @returns an array with the current render loop functions\n     */\n  }, {\n    key: \"activeRenderLoops\",\n    get: function get() {\n      return this._activeRenderLoops;\n    }\n    /**\n     * Gets or sets a boolean indicating if resources should be retained to be able to handle context lost events\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/scene/optimize_your_scene#handling-webgl-context-lost\n     */\n  }, {\n    key: \"doNotHandleContextLost\",\n    get: function get() {\n      return this._doNotHandleContextLost;\n    },\n    set: function set(value) {\n      this._doNotHandleContextLost = value;\n    }\n  }, {\n    key: \"_supportsHardwareTextureRescaling\",\n    get: function get() {\n      return false;\n    }\n    /**\n     * sets the object from which width and height will be taken from when getting render width and height\n     * Will fallback to the gl object\n     * @param dimensions the framebuffer width and height that will be used.\n     */\n  }, {\n    key: \"framebufferDimensionsObject\",\n    set: function set(dimensions) {\n      this._framebufferDimensionsObject = dimensions;\n    }\n    /**\n     * Gets the current viewport\n     */\n  }, {\n    key: \"currentViewport\",\n    get: function get() {\n      return this._cachedViewport;\n    }\n    /**\n     * Gets the default empty texture\n     */\n  }, {\n    key: \"emptyTexture\",\n    get: function get() {\n      if (!this._emptyTexture) {\n        this._emptyTexture = this.createRawTexture(new Uint8Array(4), 1, 1, 5, false, false, 1);\n      }\n      return this._emptyTexture;\n    }\n    /**\n     * Gets the default empty 3D texture\n     */\n  }, {\n    key: \"emptyTexture3D\",\n    get: function get() {\n      if (!this._emptyTexture3D) {\n        this._emptyTexture3D = this.createRawTexture3D(new Uint8Array(4), 1, 1, 1, 5, false, false, 1);\n      }\n      return this._emptyTexture3D;\n    }\n    /**\n     * Gets the default empty 2D array texture\n     */\n  }, {\n    key: \"emptyTexture2DArray\",\n    get: function get() {\n      if (!this._emptyTexture2DArray) {\n        this._emptyTexture2DArray = this.createRawTexture2DArray(new Uint8Array(4), 1, 1, 1, 5, false, false, 1);\n      }\n      return this._emptyTexture2DArray;\n    }\n    /**\n     * Gets the default empty cube texture\n     */\n  }, {\n    key: \"emptyCubeTexture\",\n    get: function get() {\n      if (!this._emptyCubeTexture) {\n        var faceData = new Uint8Array(4);\n        var cubeData = [faceData, faceData, faceData, faceData, faceData, faceData];\n        this._emptyCubeTexture = this.createRawCubeTexture(cubeData, 1, 5, 0, false, false, 1);\n      }\n      return this._emptyCubeTexture;\n    }\n    /**\n     * Gets a boolean indicating if the engine runs in WebGPU or not.\n     */\n  }, {\n    key: \"isWebGPU\",\n    get: function get() {\n      return this._isWebGPU;\n    }\n    /**\n     * Gets the shader platform name used by the effects.\n     */\n  }, {\n    key: \"shaderPlatformName\",\n    get: function get() {\n      return this._shaderPlatformName;\n    }\n    /**\n     * Enables or disables the snapshot rendering mode\n     * Note that the WebGL engine does not support snapshot rendering so setting the value won't have any effect for this engine\n     */\n  }, {\n    key: \"snapshotRendering\",\n    get: function get() {\n      return false;\n    },\n    set: function set(activate) {\n      // WebGL engine does not support snapshot rendering\n    }\n    /**\n     * Gets or sets the snapshot rendering mode\n     */\n  }, {\n    key: \"snapshotRenderingMode\",\n    get: function get() {\n      return this._snapshotRenderingMode;\n    },\n    set: function set(mode) {\n      this._snapshotRenderingMode = mode;\n    }\n    /**\n     * Creates a new snapshot at the next frame using the current snapshotRenderingMode\n     */\n  }, {\n    key: \"snapshotRenderingReset\",\n    value: function snapshotRenderingReset() {\n      this.snapshotRendering = false;\n    }\n  }, {\n    key: \"createCanvas\",\n    value:\n    /**\n     * Create a canvas. This method is overridden by other engines\n     * @param width width\n     * @param height height\n     * @returns ICanvas interface\n     */\n    function createCanvas(width, height) {\n      return ThinEngine._CreateCanvas(width, height);\n    }\n    /**\n     * Create an image to use with canvas\n     * @returns IImage interface\n     */\n  }, {\n    key: \"createCanvasImage\",\n    value: function createCanvasImage() {\n      return document.createElement(\"img\");\n    }\n  }, {\n    key: \"_setupMobileChecks\",\n    value: function _setupMobileChecks() {\n      var _this2 = this;\n      if (!(navigator && navigator.userAgent)) {\n        return;\n      }\n      // Function to check if running on mobile device\n      this._checkForMobile = function () {\n        var currentUA = navigator.userAgent;\n        _this2.hostInformation.isMobile = currentUA.indexOf(\"Mobile\") !== -1 ||\n        // Needed for iOS 13+ detection on iPad (inspired by solution from https://stackoverflow.com/questions/9038625/detect-if-device-is-ios)\n        currentUA.indexOf(\"Mac\") !== -1 && IsDocumentAvailable() && \"ontouchend\" in document;\n      };\n      // Set initial isMobile value\n      this._checkForMobile();\n      // Set up event listener to check when window is resized (used to get emulator activation to work properly)\n      if (IsWindowObjectExist()) {\n        window.addEventListener(\"resize\", this._checkForMobile);\n      }\n    }\n  }, {\n    key: \"_restoreEngineAfterContextLost\",\n    value: function _restoreEngineAfterContextLost(initEngine) {\n      var _this3 = this;\n      // Adding a timeout to avoid race condition at browser level\n      setTimeout( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var _a, depthTest, depthFunc, depthMask, stencilTest;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              _this3._dummyFramebuffer = null;\n              depthTest = _this3._depthCullingState.depthTest; // backup those values because the call to initEngine / wipeCaches will reset them\n              depthFunc = _this3._depthCullingState.depthFunc;\n              depthMask = _this3._depthCullingState.depthMask;\n              stencilTest = _this3._stencilState.stencilTest; // Rebuild context\n              _context.next = 7;\n              return initEngine();\n            case 7:\n              // Ensure webgl and engine states are matching\n              _this3.wipeCaches(true);\n              // Rebuild effects\n              _this3._rebuildEffects();\n              (_a = _this3._rebuildComputeEffects) === null || _a === void 0 ? void 0 : _a.call(_this3);\n              // Note:\n              //  The call to _rebuildBuffers must be made before the call to _rebuildInternalTextures because in the process of _rebuildBuffers the buffers used by the post process managers will be rebuilt\n              //  and we may need to use the post process manager of the scene during _rebuildInternalTextures (in WebGL1, non-POT textures are rescaled using a post process + post process manager of the scene)\n              // Rebuild buffers\n              _this3._rebuildBuffers();\n              // Rebuild textures\n              _this3._rebuildInternalTextures();\n              // Rebuild textures\n              _this3._rebuildRenderTargetWrappers();\n              // Reset engine states after all the buffer/textures/... have been rebuilt\n              _this3.wipeCaches(true);\n              _this3._depthCullingState.depthTest = depthTest;\n              _this3._depthCullingState.depthFunc = depthFunc;\n              _this3._depthCullingState.depthMask = depthMask;\n              _this3._stencilState.stencilTest = stencilTest;\n              Logger.Warn(_this3.name + \" context successfully restored.\");\n              _this3.onContextRestoredObservable.notifyObservers(_this3);\n              _this3._contextWasLost = false;\n            case 21:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee);\n      })), 0);\n    }\n    /**\n     * Shared initialization across engines types.\n     * @param canvas The canvas associated with this instance of the engine.\n     */\n  }, {\n    key: \"_sharedInit\",\n    value: function _sharedInit(canvas) {\n      this._renderingCanvas = canvas;\n    }\n    /**\n     * @internal\n     */\n  }, {\n    key: \"_getShaderProcessingContext\",\n    value: function _getShaderProcessingContext(shaderLanguage) {\n      return null;\n    }\n  }, {\n    key: \"_rebuildInternalTextures\",\n    value: function _rebuildInternalTextures() {\n      var currentState = this._internalTexturesCache.slice(); // Do a copy because the rebuild will add proxies\n      var _iterator3 = _createForOfIteratorHelper(currentState),\n        _step3;\n      try {\n        for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n          var internalTexture = _step3.value;\n          internalTexture._rebuild();\n        }\n      } catch (err) {\n        _iterator3.e(err);\n      } finally {\n        _iterator3.f();\n      }\n    }\n  }, {\n    key: \"_rebuildRenderTargetWrappers\",\n    value: function _rebuildRenderTargetWrappers() {\n      var currentState = this._renderTargetWrapperCache.slice(); // Do a copy because the rebuild will add proxies\n      var _iterator4 = _createForOfIteratorHelper(currentState),\n        _step4;\n      try {\n        for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {\n          var renderTargetWrapper = _step4.value;\n          renderTargetWrapper._rebuild();\n        }\n      } catch (err) {\n        _iterator4.e(err);\n      } finally {\n        _iterator4.f();\n      }\n    }\n  }, {\n    key: \"_rebuildEffects\",\n    value: function _rebuildEffects() {\n      for (var key in this._compiledEffects) {\n        var effect = this._compiledEffects[key];\n        effect._pipelineContext = null; // because _prepareEffect will try to dispose this pipeline before recreating it and that would lead to webgl errors\n        effect._wasPreviouslyReady = false;\n        effect._prepareEffect();\n      }\n      Effect.ResetCache();\n    }\n    /**\n     * Gets a boolean indicating if all created effects are ready\n     * @returns true if all effects are ready\n     */\n  }, {\n    key: \"areAllEffectsReady\",\n    value: function areAllEffectsReady() {\n      for (var key in this._compiledEffects) {\n        var effect = this._compiledEffects[key];\n        if (!effect.isReady()) {\n          return false;\n        }\n      }\n      return true;\n    }\n  }, {\n    key: \"_rebuildBuffers\",\n    value: function _rebuildBuffers() {\n      // Uniforms\n      var _iterator5 = _createForOfIteratorHelper(this._uniformBuffers),\n        _step5;\n      try {\n        for (_iterator5.s(); !(_step5 = _iterator5.n()).done;) {\n          var uniformBuffer = _step5.value;\n          uniformBuffer._rebuild();\n        }\n        // Storage buffers\n      } catch (err) {\n        _iterator5.e(err);\n      } finally {\n        _iterator5.f();\n      }\n      var _iterator6 = _createForOfIteratorHelper(this._storageBuffers),\n        _step6;\n      try {\n        for (_iterator6.s(); !(_step6 = _iterator6.n()).done;) {\n          var storageBuffer = _step6.value;\n          storageBuffer._rebuild();\n        }\n      } catch (err) {\n        _iterator6.e(err);\n      } finally {\n        _iterator6.f();\n      }\n    }\n  }, {\n    key: \"_initGLContext\",\n    value: function _initGLContext() {\n      var _a;\n      // Caps\n      this._caps = {\n        maxTexturesImageUnits: this._gl.getParameter(this._gl.MAX_TEXTURE_IMAGE_UNITS),\n        maxCombinedTexturesImageUnits: this._gl.getParameter(this._gl.MAX_COMBINED_TEXTURE_IMAGE_UNITS),\n        maxVertexTextureImageUnits: this._gl.getParameter(this._gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS),\n        maxTextureSize: this._gl.getParameter(this._gl.MAX_TEXTURE_SIZE),\n        maxSamples: this._webGLVersion > 1 ? this._gl.getParameter(this._gl.MAX_SAMPLES) : 1,\n        maxCubemapTextureSize: this._gl.getParameter(this._gl.MAX_CUBE_MAP_TEXTURE_SIZE),\n        maxRenderTextureSize: this._gl.getParameter(this._gl.MAX_RENDERBUFFER_SIZE),\n        maxVertexAttribs: this._gl.getParameter(this._gl.MAX_VERTEX_ATTRIBS),\n        maxVaryingVectors: this._gl.getParameter(this._gl.MAX_VARYING_VECTORS),\n        maxFragmentUniformVectors: this._gl.getParameter(this._gl.MAX_FRAGMENT_UNIFORM_VECTORS),\n        maxVertexUniformVectors: this._gl.getParameter(this._gl.MAX_VERTEX_UNIFORM_VECTORS),\n        parallelShaderCompile: this._gl.getExtension(\"KHR_parallel_shader_compile\") || undefined,\n        standardDerivatives: this._webGLVersion > 1 || this._gl.getExtension(\"OES_standard_derivatives\") !== null,\n        maxAnisotropy: 1,\n        astc: this._gl.getExtension(\"WEBGL_compressed_texture_astc\") || this._gl.getExtension(\"WEBKIT_WEBGL_compressed_texture_astc\"),\n        bptc: this._gl.getExtension(\"EXT_texture_compression_bptc\") || this._gl.getExtension(\"WEBKIT_EXT_texture_compression_bptc\"),\n        s3tc: this._gl.getExtension(\"WEBGL_compressed_texture_s3tc\") || this._gl.getExtension(\"WEBKIT_WEBGL_compressed_texture_s3tc\"),\n        // eslint-disable-next-line @typescript-eslint/naming-convention\n        s3tc_srgb: this._gl.getExtension(\"WEBGL_compressed_texture_s3tc_srgb\") || this._gl.getExtension(\"WEBKIT_WEBGL_compressed_texture_s3tc_srgb\"),\n        pvrtc: this._gl.getExtension(\"WEBGL_compressed_texture_pvrtc\") || this._gl.getExtension(\"WEBKIT_WEBGL_compressed_texture_pvrtc\"),\n        etc1: this._gl.getExtension(\"WEBGL_compressed_texture_etc1\") || this._gl.getExtension(\"WEBKIT_WEBGL_compressed_texture_etc1\"),\n        etc2: this._gl.getExtension(\"WEBGL_compressed_texture_etc\") || this._gl.getExtension(\"WEBKIT_WEBGL_compressed_texture_etc\") || this._gl.getExtension(\"WEBGL_compressed_texture_es3_0\"),\n        textureAnisotropicFilterExtension: this._gl.getExtension(\"EXT_texture_filter_anisotropic\") || this._gl.getExtension(\"WEBKIT_EXT_texture_filter_anisotropic\") || this._gl.getExtension(\"MOZ_EXT_texture_filter_anisotropic\"),\n        uintIndices: this._webGLVersion > 1 || this._gl.getExtension(\"OES_element_index_uint\") !== null,\n        fragmentDepthSupported: this._webGLVersion > 1 || this._gl.getExtension(\"EXT_frag_depth\") !== null,\n        highPrecisionShaderSupported: false,\n        timerQuery: this._gl.getExtension(\"EXT_disjoint_timer_query_webgl2\") || this._gl.getExtension(\"EXT_disjoint_timer_query\"),\n        supportOcclusionQuery: this._webGLVersion > 1,\n        canUseTimestampForTimerQuery: false,\n        drawBuffersExtension: false,\n        maxMSAASamples: 1,\n        colorBufferFloat: !!(this._webGLVersion > 1 && this._gl.getExtension(\"EXT_color_buffer_float\")),\n        textureFloat: this._webGLVersion > 1 || this._gl.getExtension(\"OES_texture_float\") ? true : false,\n        textureHalfFloat: this._webGLVersion > 1 || this._gl.getExtension(\"OES_texture_half_float\") ? true : false,\n        textureHalfFloatRender: false,\n        textureFloatLinearFiltering: false,\n        textureFloatRender: false,\n        textureHalfFloatLinearFiltering: false,\n        vertexArrayObject: false,\n        instancedArrays: false,\n        textureLOD: this._webGLVersion > 1 || this._gl.getExtension(\"EXT_shader_texture_lod\") ? true : false,\n        texelFetch: this._webGLVersion !== 1,\n        blendMinMax: false,\n        multiview: this._gl.getExtension(\"OVR_multiview2\"),\n        oculusMultiview: this._gl.getExtension(\"OCULUS_multiview\"),\n        depthTextureExtension: false,\n        canUseGLInstanceID: this._webGLVersion > 1,\n        canUseGLVertexID: this._webGLVersion > 1,\n        supportComputeShaders: false,\n        supportSRGBBuffers: false,\n        supportTransformFeedbacks: this._webGLVersion > 1,\n        textureMaxLevel: this._webGLVersion > 1,\n        texture2DArrayMaxLayerCount: this._webGLVersion > 1 ? this._gl.getParameter(this._gl.MAX_ARRAY_TEXTURE_LAYERS) : 128,\n        disableMorphTargetTexture: false\n      };\n      // Infos\n      this._glVersion = this._gl.getParameter(this._gl.VERSION);\n      var rendererInfo = this._gl.getExtension(\"WEBGL_debug_renderer_info\");\n      if (rendererInfo != null) {\n        this._glRenderer = this._gl.getParameter(rendererInfo.UNMASKED_RENDERER_WEBGL);\n        this._glVendor = this._gl.getParameter(rendererInfo.UNMASKED_VENDOR_WEBGL);\n      }\n      if (!this._glVendor) {\n        this._glVendor = this._gl.getParameter(this._gl.VENDOR) || \"Unknown vendor\";\n      }\n      if (!this._glRenderer) {\n        this._glRenderer = this._gl.getParameter(this._gl.RENDERER) || \"Unknown renderer\";\n      }\n      // Constants\n      if (this._gl.HALF_FLOAT_OES !== 0x8d61) {\n        this._gl.HALF_FLOAT_OES = 0x8d61; // Half floating-point type (16-bit).\n      }\n\n      if (this._gl.RGBA16F !== 0x881a) {\n        this._gl.RGBA16F = 0x881a; // RGBA 16-bit floating-point color-renderable internal sized format.\n      }\n\n      if (this._gl.RGBA32F !== 0x8814) {\n        this._gl.RGBA32F = 0x8814; // RGBA 32-bit floating-point color-renderable internal sized format.\n      }\n\n      if (this._gl.DEPTH24_STENCIL8 !== 35056) {\n        this._gl.DEPTH24_STENCIL8 = 35056;\n      }\n      // Extensions\n      if (this._caps.timerQuery) {\n        if (this._webGLVersion === 1) {\n          this._gl.getQuery = this._caps.timerQuery.getQueryEXT.bind(this._caps.timerQuery);\n        }\n        this._caps.canUseTimestampForTimerQuery = ((_a = this._gl.getQuery(this._caps.timerQuery.TIMESTAMP_EXT, this._caps.timerQuery.QUERY_COUNTER_BITS_EXT)) !== null && _a !== void 0 ? _a : 0) > 0;\n      }\n      this._caps.maxAnisotropy = this._caps.textureAnisotropicFilterExtension ? this._gl.getParameter(this._caps.textureAnisotropicFilterExtension.MAX_TEXTURE_MAX_ANISOTROPY_EXT) : 0;\n      this._caps.textureFloatLinearFiltering = this._caps.textureFloat && this._gl.getExtension(\"OES_texture_float_linear\") ? true : false;\n      this._caps.textureFloatRender = this._caps.textureFloat && this._canRenderToFloatFramebuffer() ? true : false;\n      this._caps.textureHalfFloatLinearFiltering = this._webGLVersion > 1 || this._caps.textureHalfFloat && this._gl.getExtension(\"OES_texture_half_float_linear\") ? true : false;\n      // Compressed formats\n      if (this._caps.astc) {\n        this._gl.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR = this._caps.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR;\n      }\n      if (this._caps.bptc) {\n        this._gl.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT = this._caps.bptc.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT;\n      }\n      if (this._caps.s3tc_srgb) {\n        this._gl.COMPRESSED_SRGB_S3TC_DXT1_EXT = this._caps.s3tc_srgb.COMPRESSED_SRGB_S3TC_DXT1_EXT;\n        this._gl.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT = this._caps.s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;\n        this._gl.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT = this._caps.s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT;\n      }\n      if (this._caps.etc2) {\n        this._gl.COMPRESSED_SRGB8_ETC2 = this._caps.etc2.COMPRESSED_SRGB8_ETC2;\n        this._gl.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC = this._caps.etc2.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC;\n      }\n      // Checks if some of the format renders first to allow the use of webgl inspector.\n      if (this._webGLVersion > 1) {\n        if (this._gl.HALF_FLOAT_OES !== 0x140b) {\n          this._gl.HALF_FLOAT_OES = 0x140b;\n        }\n      }\n      this._caps.textureHalfFloatRender = this._caps.textureHalfFloat && this._canRenderToHalfFloatFramebuffer();\n      // Draw buffers\n      if (this._webGLVersion > 1) {\n        this._caps.drawBuffersExtension = true;\n        this._caps.maxMSAASamples = this._maxMSAASamplesOverride !== null ? this._maxMSAASamplesOverride : this._gl.getParameter(this._gl.MAX_SAMPLES);\n      } else {\n        var drawBuffersExtension = this._gl.getExtension(\"WEBGL_draw_buffers\");\n        if (drawBuffersExtension !== null) {\n          this._caps.drawBuffersExtension = true;\n          this._gl.drawBuffers = drawBuffersExtension.drawBuffersWEBGL.bind(drawBuffersExtension);\n          this._gl.DRAW_FRAMEBUFFER = this._gl.FRAMEBUFFER;\n          for (var i = 0; i < 16; i++) {\n            this._gl[\"COLOR_ATTACHMENT\" + i + \"_WEBGL\"] = drawBuffersExtension[\"COLOR_ATTACHMENT\" + i + \"_WEBGL\"];\n          }\n        }\n      }\n      // Depth Texture\n      if (this._webGLVersion > 1) {\n        this._caps.depthTextureExtension = true;\n      } else {\n        var depthTextureExtension = this._gl.getExtension(\"WEBGL_depth_texture\");\n        if (depthTextureExtension != null) {\n          this._caps.depthTextureExtension = true;\n          this._gl.UNSIGNED_INT_24_8 = depthTextureExtension.UNSIGNED_INT_24_8_WEBGL;\n        }\n      }\n      // Vertex array object\n      if (this.disableVertexArrayObjects) {\n        this._caps.vertexArrayObject = false;\n      } else if (this._webGLVersion > 1) {\n        this._caps.vertexArrayObject = true;\n      } else {\n        var vertexArrayObjectExtension = this._gl.getExtension(\"OES_vertex_array_object\");\n        if (vertexArrayObjectExtension != null) {\n          this._caps.vertexArrayObject = true;\n          this._gl.createVertexArray = vertexArrayObjectExtension.createVertexArrayOES.bind(vertexArrayObjectExtension);\n          this._gl.bindVertexArray = vertexArrayObjectExtension.bindVertexArrayOES.bind(vertexArrayObjectExtension);\n          this._gl.deleteVertexArray = vertexArrayObjectExtension.deleteVertexArrayOES.bind(vertexArrayObjectExtension);\n        }\n      }\n      // Instances count\n      if (this._webGLVersion > 1) {\n        this._caps.instancedArrays = true;\n      } else {\n        var instanceExtension = this._gl.getExtension(\"ANGLE_instanced_arrays\");\n        if (instanceExtension != null) {\n          this._caps.instancedArrays = true;\n          this._gl.drawArraysInstanced = instanceExtension.drawArraysInstancedANGLE.bind(instanceExtension);\n          this._gl.drawElementsInstanced = instanceExtension.drawElementsInstancedANGLE.bind(instanceExtension);\n          this._gl.vertexAttribDivisor = instanceExtension.vertexAttribDivisorANGLE.bind(instanceExtension);\n        } else {\n          this._caps.instancedArrays = false;\n        }\n      }\n      if (this._gl.getShaderPrecisionFormat) {\n        var vertexhighp = this._gl.getShaderPrecisionFormat(this._gl.VERTEX_SHADER, this._gl.HIGH_FLOAT);\n        var fragmenthighp = this._gl.getShaderPrecisionFormat(this._gl.FRAGMENT_SHADER, this._gl.HIGH_FLOAT);\n        if (vertexhighp && fragmenthighp) {\n          this._caps.highPrecisionShaderSupported = vertexhighp.precision !== 0 && fragmenthighp.precision !== 0;\n        }\n      }\n      if (this._webGLVersion > 1) {\n        this._caps.blendMinMax = true;\n      } else {\n        var blendMinMaxExtension = this._gl.getExtension(\"EXT_blend_minmax\");\n        if (blendMinMaxExtension != null) {\n          this._caps.blendMinMax = true;\n          this._gl.MAX = blendMinMaxExtension.MAX_EXT;\n          this._gl.MIN = blendMinMaxExtension.MIN_EXT;\n        }\n      }\n      // sRGB buffers\n      // only run this if not already set to true (in the constructor, for example)\n      if (!this._caps.supportSRGBBuffers) {\n        if (this._webGLVersion > 1) {\n          this._caps.supportSRGBBuffers = true;\n          this._glSRGBExtensionValues = {\n            SRGB: WebGL2RenderingContext.SRGB,\n            SRGB8: WebGL2RenderingContext.SRGB8,\n            SRGB8_ALPHA8: WebGL2RenderingContext.SRGB8_ALPHA8\n          };\n        } else {\n          var sRGBExtension = this._gl.getExtension(\"EXT_sRGB\");\n          if (sRGBExtension != null) {\n            this._caps.supportSRGBBuffers = true;\n            this._glSRGBExtensionValues = {\n              SRGB: sRGBExtension.SRGB_EXT,\n              SRGB8: sRGBExtension.SRGB_ALPHA_EXT,\n              SRGB8_ALPHA8: sRGBExtension.SRGB_ALPHA_EXT\n            };\n          }\n        }\n        // take into account the forced state that was provided in options\n        // When the issue in angle/chrome is fixed the flag should be taken into account only when it is explicitly defined\n        this._caps.supportSRGBBuffers = this._caps.supportSRGBBuffers && !!(this._creationOptions && this._creationOptions.forceSRGBBufferSupportState);\n      }\n      // Depth buffer\n      this._depthCullingState.depthTest = true;\n      this._depthCullingState.depthFunc = this._gl.LEQUAL;\n      this._depthCullingState.depthMask = true;\n      // Texture maps\n      this._maxSimultaneousTextures = this._caps.maxCombinedTexturesImageUnits;\n      for (var slot = 0; slot < this._maxSimultaneousTextures; slot++) {\n        this._nextFreeTextureSlots.push(slot);\n      }\n      if (this._glRenderer === \"Mali-G72\") {\n        // Overcome a bug when using a texture to store morph targets on Mali-G72\n        this._caps.disableMorphTargetTexture = true;\n      }\n    }\n  }, {\n    key: \"_initFeatures\",\n    value: function _initFeatures() {\n      this._features = {\n        forceBitmapOverHTMLImageElement: false,\n        supportRenderAndCopyToLodForFloatTextures: this._webGLVersion !== 1,\n        supportDepthStencilTexture: this._webGLVersion !== 1,\n        supportShadowSamplers: this._webGLVersion !== 1,\n        uniformBufferHardCheckMatrix: false,\n        allowTexturePrefiltering: this._webGLVersion !== 1,\n        trackUbosInFrame: false,\n        checkUbosContentBeforeUpload: false,\n        supportCSM: this._webGLVersion !== 1,\n        basisNeedsPOT: this._webGLVersion === 1,\n        support3DTextures: this._webGLVersion !== 1,\n        needTypeSuffixInShaderConstants: this._webGLVersion !== 1,\n        supportMSAA: this._webGLVersion !== 1,\n        supportSSAO2: this._webGLVersion !== 1,\n        supportExtendedTextureFormats: this._webGLVersion !== 1,\n        supportSwitchCaseInShader: this._webGLVersion !== 1,\n        supportSyncTextureRead: true,\n        needsInvertingBitmap: true,\n        useUBOBindingCache: true,\n        needShaderCodeInlining: false,\n        needToAlwaysBindUniformBuffers: false,\n        supportRenderPasses: false,\n        supportSpriteInstancing: true,\n        _collectUbosUpdatedInFrame: false\n      };\n    }\n    /**\n     * Gets version of the current webGL context\n     * Keep it for back compat - use version instead\n     */\n  }, {\n    key: \"webGLVersion\",\n    get: function get() {\n      return this._webGLVersion;\n    }\n    /**\n     * Gets a string identifying the name of the class\n     * @returns \"Engine\" string\n     */\n  }, {\n    key: \"getClassName\",\n    value: function getClassName() {\n      return \"ThinEngine\";\n    }\n    /**\n     * Returns true if the stencil buffer has been enabled through the creation option of the context.\n     */\n  }, {\n    key: \"isStencilEnable\",\n    get: function get() {\n      return this._isStencilEnable;\n    }\n    /** @internal */\n  }, {\n    key: \"_prepareWorkingCanvas\",\n    value: function _prepareWorkingCanvas() {\n      if (this._workingCanvas) {\n        return;\n      }\n      this._workingCanvas = this.createCanvas(1, 1);\n      var context = this._workingCanvas.getContext(\"2d\");\n      if (context) {\n        this._workingContext = context;\n      }\n    }\n    /**\n     * Reset the texture cache to empty state\n     */\n  }, {\n    key: \"resetTextureCache\",\n    value: function resetTextureCache() {\n      for (var key in this._boundTexturesCache) {\n        if (!Object.prototype.hasOwnProperty.call(this._boundTexturesCache, key)) {\n          continue;\n        }\n        this._boundTexturesCache[key] = null;\n      }\n      this._currentTextureChannel = -1;\n    }\n    /**\n     * Gets an object containing information about the current engine context\n     * @returns an object containing the vendor, the renderer and the version of the current engine context\n     */\n  }, {\n    key: \"getInfo\",\n    value: function getInfo() {\n      return this.getGlInfo();\n    }\n    /**\n     * Gets an object containing information about the current webGL context\n     * @returns an object containing the vendor, the renderer and the version of the current webGL context\n     */\n  }, {\n    key: \"getGlInfo\",\n    value: function getGlInfo() {\n      return {\n        vendor: this._glVendor,\n        renderer: this._glRenderer,\n        version: this._glVersion\n      };\n    }\n    /**\n     * Defines the hardware scaling level.\n     * By default the hardware scaling level is computed from the window device ratio.\n     * if level = 1 then the engine will render at the exact resolution of the canvas. If level = 0.5 then the engine will render at twice the size of the canvas.\n     * @param level defines the level to use\n     */\n  }, {\n    key: \"setHardwareScalingLevel\",\n    value: function setHardwareScalingLevel(level) {\n      this._hardwareScalingLevel = level;\n      this.resize();\n    }\n    /**\n     * Gets the current hardware scaling level.\n     * By default the hardware scaling level is computed from the window device ratio.\n     * if level = 1 then the engine will render at the exact resolution of the canvas. If level = 0.5 then the engine will render at twice the size of the canvas.\n     * @returns a number indicating the current hardware scaling level\n     */\n  }, {\n    key: \"getHardwareScalingLevel\",\n    value: function getHardwareScalingLevel() {\n      return this._hardwareScalingLevel;\n    }\n    /**\n     * Gets the list of loaded textures\n     * @returns an array containing all loaded textures\n     */\n  }, {\n    key: \"getLoadedTexturesCache\",\n    value: function getLoadedTexturesCache() {\n      return this._internalTexturesCache;\n    }\n    /**\n     * Gets the object containing all engine capabilities\n     * @returns the EngineCapabilities object\n     */\n  }, {\n    key: \"getCaps\",\n    value: function getCaps() {\n      return this._caps;\n    }\n    /**\n     * stop executing a render loop function and remove it from the execution array\n     * @param renderFunction defines the function to be removed. If not provided all functions will be removed.\n     */\n  }, {\n    key: \"stopRenderLoop\",\n    value: function stopRenderLoop(renderFunction) {\n      if (!renderFunction) {\n        this._activeRenderLoops.length = 0;\n        return;\n      }\n      var index = this._activeRenderLoops.indexOf(renderFunction);\n      if (index >= 0) {\n        this._activeRenderLoops.splice(index, 1);\n      }\n    }\n    /** @internal */\n  }, {\n    key: \"_renderLoop\",\n    value: function _renderLoop() {\n      if (!this._contextWasLost) {\n        var shouldRender = true;\n        if (this._isDisposed || !this.renderEvenInBackground && this._windowIsBackground) {\n          shouldRender = false;\n        }\n        if (shouldRender) {\n          // Start new frame\n          this.beginFrame();\n          for (var index = 0; index < this._activeRenderLoops.length; index++) {\n            var renderFunction = this._activeRenderLoops[index];\n            renderFunction();\n          }\n          // Present\n          this.endFrame();\n        }\n      }\n      if (this._activeRenderLoops.length > 0) {\n        this._frameHandler = this._queueNewFrame(this._boundRenderFunction, this.getHostWindow());\n      } else {\n        this._renderingQueueLaunched = false;\n      }\n    }\n    /**\n     * Gets the HTML canvas attached with the current webGL context\n     * @returns a HTML canvas\n     */\n  }, {\n    key: \"getRenderingCanvas\",\n    value: function getRenderingCanvas() {\n      return this._renderingCanvas;\n    }\n    /**\n     * Gets the audio context specified in engine initialization options\n     * @returns an Audio Context\n     */\n  }, {\n    key: \"getAudioContext\",\n    value: function getAudioContext() {\n      return this._audioContext;\n    }\n    /**\n     * Gets the audio destination specified in engine initialization options\n     * @returns an audio destination node\n     */\n  }, {\n    key: \"getAudioDestination\",\n    value: function getAudioDestination() {\n      return this._audioDestination;\n    }\n    /**\n     * Gets host window\n     * @returns the host window object\n     */\n  }, {\n    key: \"getHostWindow\",\n    value: function getHostWindow() {\n      if (!IsWindowObjectExist()) {\n        return null;\n      }\n      if (this._renderingCanvas && this._renderingCanvas.ownerDocument && this._renderingCanvas.ownerDocument.defaultView) {\n        return this._renderingCanvas.ownerDocument.defaultView;\n      }\n      return window;\n    }\n    /**\n     * Gets the current render width\n     * @param useScreen defines if screen size must be used (or the current render target if any)\n     * @returns a number defining the current render width\n     */\n  }, {\n    key: \"getRenderWidth\",\n    value: function getRenderWidth() {\n      var useScreen = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      if (!useScreen && this._currentRenderTarget) {\n        return this._currentRenderTarget.width;\n      }\n      return this._framebufferDimensionsObject ? this._framebufferDimensionsObject.framebufferWidth : this._gl.drawingBufferWidth;\n    }\n    /**\n     * Gets the current render height\n     * @param useScreen defines if screen size must be used (or the current render target if any)\n     * @returns a number defining the current render height\n     */\n  }, {\n    key: \"getRenderHeight\",\n    value: function getRenderHeight() {\n      var useScreen = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      if (!useScreen && this._currentRenderTarget) {\n        return this._currentRenderTarget.height;\n      }\n      return this._framebufferDimensionsObject ? this._framebufferDimensionsObject.framebufferHeight : this._gl.drawingBufferHeight;\n    }\n    /**\n     * Can be used to override the current requestAnimationFrame requester.\n     * @internal\n     */\n  }, {\n    key: \"_queueNewFrame\",\n    value: function _queueNewFrame(bindedRenderFunction, requester) {\n      return ThinEngine.QueueNewFrame(bindedRenderFunction, requester);\n    }\n    /**\n     * Register and execute a render loop. The engine can have more than one render function\n     * @param renderFunction defines the function to continuously execute\n     */\n  }, {\n    key: \"runRenderLoop\",\n    value: function runRenderLoop(renderFunction) {\n      if (this._activeRenderLoops.indexOf(renderFunction) !== -1) {\n        return;\n      }\n      this._activeRenderLoops.push(renderFunction);\n      if (!this._renderingQueueLaunched) {\n        this._renderingQueueLaunched = true;\n        this._boundRenderFunction = this._renderLoop.bind(this);\n        this._frameHandler = this._queueNewFrame(this._boundRenderFunction, this.getHostWindow());\n      }\n    }\n    /**\n     * Clear the current render buffer or the current render target (if any is set up)\n     * @param color defines the color to use\n     * @param backBuffer defines if the back buffer must be cleared\n     * @param depth defines if the depth buffer must be cleared\n     * @param stencil defines if the stencil buffer must be cleared\n     */\n  }, {\n    key: \"clear\",\n    value: function clear(color, backBuffer, depth) {\n      var stencil = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n      var useStencilGlobalOnly = this.stencilStateComposer.useStencilGlobalOnly;\n      this.stencilStateComposer.useStencilGlobalOnly = true; // make sure the stencil mask is coming from the global stencil and not from a material (effect) which would currently be in effect\n      this.applyStates();\n      this.stencilStateComposer.useStencilGlobalOnly = useStencilGlobalOnly;\n      var mode = 0;\n      if (backBuffer && color) {\n        this._gl.clearColor(color.r, color.g, color.b, color.a !== undefined ? color.a : 1.0);\n        mode |= this._gl.COLOR_BUFFER_BIT;\n      }\n      if (depth) {\n        if (this.useReverseDepthBuffer) {\n          this._depthCullingState.depthFunc = this._gl.GEQUAL;\n          this._gl.clearDepth(0.0);\n        } else {\n          this._gl.clearDepth(1.0);\n        }\n        mode |= this._gl.DEPTH_BUFFER_BIT;\n      }\n      if (stencil) {\n        this._gl.clearStencil(0);\n        mode |= this._gl.STENCIL_BUFFER_BIT;\n      }\n      this._gl.clear(mode);\n    }\n    /**\n     * @internal\n     */\n  }, {\n    key: \"_viewport\",\n    value: function _viewport(x, y, width, height) {\n      if (x !== this._viewportCached.x || y !== this._viewportCached.y || width !== this._viewportCached.z || height !== this._viewportCached.w) {\n        this._viewportCached.x = x;\n        this._viewportCached.y = y;\n        this._viewportCached.z = width;\n        this._viewportCached.w = height;\n        this._gl.viewport(x, y, width, height);\n      }\n    }\n    /**\n     * Set the WebGL's viewport\n     * @param viewport defines the viewport element to be used\n     * @param requiredWidth defines the width required for rendering. If not provided the rendering canvas' width is used\n     * @param requiredHeight defines the height required for rendering. If not provided the rendering canvas' height is used\n     */\n  }, {\n    key: \"setViewport\",\n    value: function setViewport(viewport, requiredWidth, requiredHeight) {\n      var width = requiredWidth || this.getRenderWidth();\n      var height = requiredHeight || this.getRenderHeight();\n      var x = viewport.x || 0;\n      var y = viewport.y || 0;\n      this._cachedViewport = viewport;\n      this._viewport(x * width, y * height, width * viewport.width, height * viewport.height);\n    }\n    /**\n     * Begin a new frame\n     */\n  }, {\n    key: \"beginFrame\",\n    value: function beginFrame() {}\n    /**\n     * Enf the current frame\n     */\n  }, {\n    key: \"endFrame\",\n    value: function endFrame() {\n      // Force a flush in case we are using a bad OS.\n      if (this._badOS) {\n        this.flushFramebuffer();\n      }\n      this._frameId++;\n    }\n    /**\n     * Resize the view according to the canvas' size\n     * @param forceSetSize true to force setting the sizes of the underlying canvas\n     */\n  }, {\n    key: \"resize\",\n    value: function resize() {\n      var forceSetSize = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      var width;\n      var height;\n      // Requery hardware scaling level to handle zoomed-in resizing.\n      if (this.adaptToDeviceRatio) {\n        var devicePixelRatio = IsWindowObjectExist() ? window.devicePixelRatio || 1.0 : 1.0;\n        var changeRatio = this._lastDevicePixelRatio / devicePixelRatio;\n        this._lastDevicePixelRatio = devicePixelRatio;\n        this._hardwareScalingLevel *= changeRatio;\n      }\n      if (IsWindowObjectExist()) {\n        if (this._renderingCanvas) {\n          var boundingRect = this._renderingCanvas.getBoundingClientRect ? this._renderingCanvas.getBoundingClientRect() : {\n            // fallback to last solution in case the function doesn't exist\n            width: this._renderingCanvas.width * this._hardwareScalingLevel,\n            height: this._renderingCanvas.height * this._hardwareScalingLevel\n          };\n          width = this._renderingCanvas.clientWidth || boundingRect.width;\n          height = this._renderingCanvas.clientHeight || boundingRect.height;\n        } else {\n          width = window.innerWidth;\n          height = window.innerHeight;\n        }\n      } else {\n        width = this._renderingCanvas ? this._renderingCanvas.width : 100;\n        height = this._renderingCanvas ? this._renderingCanvas.height : 100;\n      }\n      this.setSize(width / this._hardwareScalingLevel, height / this._hardwareScalingLevel, forceSetSize);\n    }\n    /**\n     * Force a specific size of the canvas\n     * @param width defines the new canvas' width\n     * @param height defines the new canvas' height\n     * @param forceSetSize true to force setting the sizes of the underlying canvas\n     * @returns true if the size was changed\n     */\n  }, {\n    key: \"setSize\",\n    value: function setSize(width, height) {\n      var forceSetSize = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n      if (!this._renderingCanvas) {\n        return false;\n      }\n      width = width | 0;\n      height = height | 0;\n      if (!forceSetSize && this._renderingCanvas.width === width && this._renderingCanvas.height === height) {\n        return false;\n      }\n      this._renderingCanvas.width = width;\n      this._renderingCanvas.height = height;\n      return true;\n    }\n    /**\n     * Binds the frame buffer to the specified texture.\n     * @param rtWrapper The render target wrapper to render to\n     * @param faceIndex The face of the texture to render to in case of cube texture and if the render target wrapper is not a multi render target\n     * @param requiredWidth The width of the target to render to\n     * @param requiredHeight The height of the target to render to\n     * @param forceFullscreenViewport Forces the viewport to be the entire texture/screen if true\n     * @param lodLevel Defines the lod level to bind to the frame buffer\n     * @param layer Defines the 2d array index to bind to the frame buffer if the render target wrapper is not a multi render target\n     */\n  }, {\n    key: \"bindFramebuffer\",\n    value: function bindFramebuffer(rtWrapper) {\n      var faceIndex = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n      var requiredWidth = arguments.length > 2 ? arguments[2] : undefined;\n      var requiredHeight = arguments.length > 3 ? arguments[3] : undefined;\n      var forceFullscreenViewport = arguments.length > 4 ? arguments[4] : undefined;\n      var lodLevel = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : 0;\n      var layer = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : 0;\n      var _a, _b, _c, _d, _e;\n      var webglRTWrapper = rtWrapper;\n      if (this._currentRenderTarget) {\n        this.unBindFramebuffer(this._currentRenderTarget);\n      }\n      this._currentRenderTarget = rtWrapper;\n      this._bindUnboundFramebuffer(webglRTWrapper._MSAAFramebuffer ? webglRTWrapper._MSAAFramebuffer : webglRTWrapper._framebuffer);\n      var gl = this._gl;\n      if (!rtWrapper.isMulti) {\n        if (rtWrapper.is2DArray) {\n          gl.framebufferTextureLayer(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, (_a = rtWrapper.texture._hardwareTexture) === null || _a === void 0 ? void 0 : _a.underlyingResource, lodLevel, layer);\n        } else if (rtWrapper.isCube) {\n          gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_CUBE_MAP_POSITIVE_X + faceIndex, (_b = rtWrapper.texture._hardwareTexture) === null || _b === void 0 ? void 0 : _b.underlyingResource, lodLevel);\n        }\n      }\n      var depthStencilTexture = rtWrapper._depthStencilTexture;\n      if (depthStencilTexture) {\n        var attachment = rtWrapper._depthStencilTextureWithStencil ? gl.DEPTH_STENCIL_ATTACHMENT : gl.DEPTH_ATTACHMENT;\n        if (rtWrapper.is2DArray) {\n          gl.framebufferTextureLayer(gl.FRAMEBUFFER, attachment, (_c = depthStencilTexture._hardwareTexture) === null || _c === void 0 ? void 0 : _c.underlyingResource, lodLevel, layer);\n        } else if (rtWrapper.isCube) {\n          gl.framebufferTexture2D(gl.FRAMEBUFFER, attachment, gl.TEXTURE_CUBE_MAP_POSITIVE_X + faceIndex, (_d = depthStencilTexture._hardwareTexture) === null || _d === void 0 ? void 0 : _d.underlyingResource, lodLevel);\n        } else {\n          gl.framebufferTexture2D(gl.FRAMEBUFFER, attachment, gl.TEXTURE_2D, (_e = depthStencilTexture._hardwareTexture) === null || _e === void 0 ? void 0 : _e.underlyingResource, lodLevel);\n        }\n      }\n      if (this._cachedViewport && !forceFullscreenViewport) {\n        this.setViewport(this._cachedViewport, requiredWidth, requiredHeight);\n      } else {\n        if (!requiredWidth) {\n          requiredWidth = rtWrapper.width;\n          if (lodLevel) {\n            requiredWidth = requiredWidth / Math.pow(2, lodLevel);\n          }\n        }\n        if (!requiredHeight) {\n          requiredHeight = rtWrapper.height;\n          if (lodLevel) {\n            requiredHeight = requiredHeight / Math.pow(2, lodLevel);\n          }\n        }\n        this._viewport(0, 0, requiredWidth, requiredHeight);\n      }\n      this.wipeCaches();\n    }\n    /**\n     * Set various states to the webGL context\n     * @param culling defines culling state: true to enable culling, false to disable it\n     * @param zOffset defines the value to apply to zOffset (0 by default)\n     * @param force defines if states must be applied even if cache is up to date\n     * @param reverseSide defines if culling must be reversed (CCW if false, CW if true)\n     * @param cullBackFaces true to cull back faces, false to cull front faces (if culling is enabled)\n     * @param stencil stencil states to set\n     * @param zOffsetUnits defines the value to apply to zOffsetUnits (0 by default)\n     */\n  }, {\n    key: \"setState\",\n    value: function setState(culling) {\n      var zOffset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n      var force = arguments.length > 2 ? arguments[2] : undefined;\n      var reverseSide = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n      var cullBackFaces = arguments.length > 4 ? arguments[4] : undefined;\n      var stencil = arguments.length > 5 ? arguments[5] : undefined;\n      var zOffsetUnits = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : 0;\n      var _a, _b;\n      // Culling\n      if (this._depthCullingState.cull !== culling || force) {\n        this._depthCullingState.cull = culling;\n      }\n      // Cull face\n      var cullFace = ((_b = (_a = this.cullBackFaces) !== null && _a !== void 0 ? _a : cullBackFaces) !== null && _b !== void 0 ? _b : true) ? this._gl.BACK : this._gl.FRONT;\n      if (this._depthCullingState.cullFace !== cullFace || force) {\n        this._depthCullingState.cullFace = cullFace;\n      }\n      // Z offset\n      this.setZOffset(zOffset);\n      this.setZOffsetUnits(zOffsetUnits);\n      // Front face\n      var frontFace = reverseSide ? this._gl.CW : this._gl.CCW;\n      if (this._depthCullingState.frontFace !== frontFace || force) {\n        this._depthCullingState.frontFace = frontFace;\n      }\n      this._stencilStateComposer.stencilMaterial = stencil;\n    }\n    /**\n     * Gets a boolean indicating if depth testing is enabled\n     * @returns the current state\n     */\n  }, {\n    key: \"getDepthBuffer\",\n    value: function getDepthBuffer() {\n      return this._depthCullingState.depthTest;\n    }\n    /**\n     * Enable or disable depth buffering\n     * @param enable defines the state to set\n     */\n  }, {\n    key: \"setDepthBuffer\",\n    value: function setDepthBuffer(enable) {\n      this._depthCullingState.depthTest = enable;\n    }\n    /**\n     * Set the z offset Factor to apply to current rendering\n     * @param value defines the offset to apply\n     */\n  }, {\n    key: \"setZOffset\",\n    value: function setZOffset(value) {\n      this._depthCullingState.zOffset = this.useReverseDepthBuffer ? -value : value;\n    }\n    /**\n     * Gets the current value of the zOffset Factor\n     * @returns the current zOffset Factor state\n     */\n  }, {\n    key: \"getZOffset\",\n    value: function getZOffset() {\n      var zOffset = this._depthCullingState.zOffset;\n      return this.useReverseDepthBuffer ? -zOffset : zOffset;\n    }\n    /**\n     * Set the z offset Units to apply to current rendering\n     * @param value defines the offset to apply\n     */\n  }, {\n    key: \"setZOffsetUnits\",\n    value: function setZOffsetUnits(value) {\n      this._depthCullingState.zOffsetUnits = this.useReverseDepthBuffer ? -value : value;\n    }\n    /**\n     * Gets the current value of the zOffset Units\n     * @returns the current zOffset Units state\n     */\n  }, {\n    key: \"getZOffsetUnits\",\n    value: function getZOffsetUnits() {\n      var zOffsetUnits = this._depthCullingState.zOffsetUnits;\n      return this.useReverseDepthBuffer ? -zOffsetUnits : zOffsetUnits;\n    }\n    /**\n     * @internal\n     */\n  }, {\n    key: \"_bindUnboundFramebuffer\",\n    value: function _bindUnboundFramebuffer(framebuffer) {\n      if (this._currentFramebuffer !== framebuffer) {\n        this._gl.bindFramebuffer(this._gl.FRAMEBUFFER, framebuffer);\n        this._currentFramebuffer = framebuffer;\n      }\n    }\n    /** @internal */\n  }, {\n    key: \"_currentFrameBufferIsDefaultFrameBuffer\",\n    value: function _currentFrameBufferIsDefaultFrameBuffer() {\n      return this._currentFramebuffer === null;\n    }\n    /**\n     * Generates the mipmaps for a texture\n     * @param texture texture to generate the mipmaps for\n     */\n  }, {\n    key: \"generateMipmaps\",\n    value: function generateMipmaps(texture) {\n      this._bindTextureDirectly(this._gl.TEXTURE_2D, texture, true);\n      this._gl.generateMipmap(this._gl.TEXTURE_2D);\n      this._bindTextureDirectly(this._gl.TEXTURE_2D, null);\n    }\n    /**\n     * Unbind the current render target texture from the webGL context\n     * @param texture defines the render target wrapper to unbind\n     * @param disableGenerateMipMaps defines a boolean indicating that mipmaps must not be generated\n     * @param onBeforeUnbind defines a function which will be called before the effective unbind\n     */\n  }, {\n    key: \"unBindFramebuffer\",\n    value: function unBindFramebuffer(texture) {\n      var disableGenerateMipMaps = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      var onBeforeUnbind = arguments.length > 2 ? arguments[2] : undefined;\n      var _a;\n      var webglRTWrapper = texture;\n      this._currentRenderTarget = null;\n      // If MSAA, we need to bitblt back to main texture\n      var gl = this._gl;\n      if (webglRTWrapper._MSAAFramebuffer) {\n        if (texture.isMulti) {\n          // This texture is part of a MRT texture, we need to treat all attachments\n          this.unBindMultiColorAttachmentFramebuffer(texture, disableGenerateMipMaps, onBeforeUnbind);\n          return;\n        }\n        gl.bindFramebuffer(gl.READ_FRAMEBUFFER, webglRTWrapper._MSAAFramebuffer);\n        gl.bindFramebuffer(gl.DRAW_FRAMEBUFFER, webglRTWrapper._framebuffer);\n        gl.blitFramebuffer(0, 0, texture.width, texture.height, 0, 0, texture.width, texture.height, gl.COLOR_BUFFER_BIT, gl.NEAREST);\n      }\n      if (((_a = texture.texture) === null || _a === void 0 ? void 0 : _a.generateMipMaps) && !disableGenerateMipMaps && !texture.isCube) {\n        this.generateMipmaps(texture.texture);\n      }\n      if (onBeforeUnbind) {\n        if (webglRTWrapper._MSAAFramebuffer) {\n          // Bind the correct framebuffer\n          this._bindUnboundFramebuffer(webglRTWrapper._framebuffer);\n        }\n        onBeforeUnbind();\n      }\n      this._bindUnboundFramebuffer(null);\n    }\n    /**\n     * Force a webGL flush (ie. a flush of all waiting webGL commands)\n     */\n  }, {\n    key: \"flushFramebuffer\",\n    value: function flushFramebuffer() {\n      this._gl.flush();\n    }\n    /**\n     * Unbind the current render target and bind the default framebuffer\n     */\n  }, {\n    key: \"restoreDefaultFramebuffer\",\n    value: function restoreDefaultFramebuffer() {\n      if (this._currentRenderTarget) {\n        this.unBindFramebuffer(this._currentRenderTarget);\n      } else {\n        this._bindUnboundFramebuffer(null);\n      }\n      if (this._cachedViewport) {\n        this.setViewport(this._cachedViewport);\n      }\n      this.wipeCaches();\n    }\n    // VBOs\n    /** @internal */\n  }, {\n    key: \"_resetVertexBufferBinding\",\n    value: function _resetVertexBufferBinding() {\n      this.bindArrayBuffer(null);\n      this._cachedVertexBuffers = null;\n    }\n    /**\n     * Creates a vertex buffer\n     * @param data the data for the vertex buffer\n     * @returns the new WebGL static buffer\n     */\n  }, {\n    key: \"createVertexBuffer\",\n    value: function createVertexBuffer(data) {\n      return this._createVertexBuffer(data, this._gl.STATIC_DRAW);\n    }\n  }, {\n    key: \"_createVertexBuffer\",\n    value: function _createVertexBuffer(data, usage) {\n      var vbo = this._gl.createBuffer();\n      if (!vbo) {\n        throw new Error(\"Unable to create vertex buffer\");\n      }\n      var dataBuffer = new WebGLDataBuffer(vbo);\n      this.bindArrayBuffer(dataBuffer);\n      if (data instanceof Array) {\n        this._gl.bufferData(this._gl.ARRAY_BUFFER, new Float32Array(data), usage);\n      } else {\n        this._gl.bufferData(this._gl.ARRAY_BUFFER, data, usage);\n      }\n      this._resetVertexBufferBinding();\n      dataBuffer.references = 1;\n      return dataBuffer;\n    }\n    /**\n     * Creates a dynamic vertex buffer\n     * @param data the data for the dynamic vertex buffer\n     * @returns the new WebGL dynamic buffer\n     */\n  }, {\n    key: \"createDynamicVertexBuffer\",\n    value: function createDynamicVertexBuffer(data) {\n      return this._createVertexBuffer(data, this._gl.DYNAMIC_DRAW);\n    }\n  }, {\n    key: \"_resetIndexBufferBinding\",\n    value: function _resetIndexBufferBinding() {\n      this.bindIndexBuffer(null);\n      this._cachedIndexBuffer = null;\n    }\n    /**\n     * Creates a new index buffer\n     * @param indices defines the content of the index buffer\n     * @param updatable defines if the index buffer must be updatable\n     * @returns a new webGL buffer\n     */\n  }, {\n    key: \"createIndexBuffer\",\n    value: function createIndexBuffer(indices, updatable) {\n      var vbo = this._gl.createBuffer();\n      var dataBuffer = new WebGLDataBuffer(vbo);\n      if (!vbo) {\n        throw new Error(\"Unable to create index buffer\");\n      }\n      this.bindIndexBuffer(dataBuffer);\n      var data = this._normalizeIndexData(indices);\n      this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER, data, updatable ? this._gl.DYNAMIC_DRAW : this._gl.STATIC_DRAW);\n      this._resetIndexBufferBinding();\n      dataBuffer.references = 1;\n      dataBuffer.is32Bits = data.BYTES_PER_ELEMENT === 4;\n      return dataBuffer;\n    }\n  }, {\n    key: \"_normalizeIndexData\",\n    value: function _normalizeIndexData(indices) {\n      var bytesPerElement = indices.BYTES_PER_ELEMENT;\n      if (bytesPerElement === 2) {\n        return indices;\n      }\n      // Check 32 bit support\n      if (this._caps.uintIndices) {\n        if (indices instanceof Uint32Array) {\n          return indices;\n        } else {\n          // number[] or Int32Array, check if 32 bit is necessary\n          for (var index = 0; index < indices.length; index++) {\n            if (indices[index] >= 65535) {\n              return new Uint32Array(indices);\n            }\n          }\n          return new Uint16Array(indices);\n        }\n      }\n      // No 32 bit support, force conversion to 16 bit (values greater 16 bit are lost)\n      return new Uint16Array(indices);\n    }\n    /**\n     * Bind a webGL buffer to the webGL context\n     * @param buffer defines the buffer to bind\n     */\n  }, {\n    key: \"bindArrayBuffer\",\n    value: function bindArrayBuffer(buffer) {\n      if (!this._vaoRecordInProgress) {\n        this._unbindVertexArrayObject();\n      }\n      this._bindBuffer(buffer, this._gl.ARRAY_BUFFER);\n    }\n    /**\n     * Bind a specific block at a given index in a specific shader program\n     * @param pipelineContext defines the pipeline context to use\n     * @param blockName defines the block name\n     * @param index defines the index where to bind the block\n     */\n  }, {\n    key: \"bindUniformBlock\",\n    value: function bindUniformBlock(pipelineContext, blockName, index) {\n      var program = pipelineContext.program;\n      var uniformLocation = this._gl.getUniformBlockIndex(program, blockName);\n      this._gl.uniformBlockBinding(program, uniformLocation, index);\n    }\n    // eslint-disable-next-line @typescript-eslint/naming-convention\n  }, {\n    key: \"bindIndexBuffer\",\n    value: function bindIndexBuffer(buffer) {\n      if (!this._vaoRecordInProgress) {\n        this._unbindVertexArrayObject();\n      }\n      this._bindBuffer(buffer, this._gl.ELEMENT_ARRAY_BUFFER);\n    }\n  }, {\n    key: \"_bindBuffer\",\n    value: function _bindBuffer(buffer, target) {\n      if (this._vaoRecordInProgress || this._currentBoundBuffer[target] !== buffer) {\n        this._gl.bindBuffer(target, buffer ? buffer.underlyingResource : null);\n        this._currentBoundBuffer[target] = buffer;\n      }\n    }\n    /**\n     * update the bound buffer with the given data\n     * @param data defines the data to update\n     */\n  }, {\n    key: \"updateArrayBuffer\",\n    value: function updateArrayBuffer(data) {\n      this._gl.bufferSubData(this._gl.ARRAY_BUFFER, 0, data);\n    }\n  }, {\n    key: \"_vertexAttribPointer\",\n    value: function _vertexAttribPointer(buffer, indx, size, type, normalized, stride, offset) {\n      var pointer = this._currentBufferPointers[indx];\n      if (!pointer) {\n        return;\n      }\n      var changed = false;\n      if (!pointer.active) {\n        changed = true;\n        pointer.active = true;\n        pointer.index = indx;\n        pointer.size = size;\n        pointer.type = type;\n        pointer.normalized = normalized;\n        pointer.stride = stride;\n        pointer.offset = offset;\n        pointer.buffer = buffer;\n      } else {\n        if (pointer.buffer !== buffer) {\n          pointer.buffer = buffer;\n          changed = true;\n        }\n        if (pointer.size !== size) {\n          pointer.size = size;\n          changed = true;\n        }\n        if (pointer.type !== type) {\n          pointer.type = type;\n          changed = true;\n        }\n        if (pointer.normalized !== normalized) {\n          pointer.normalized = normalized;\n          changed = true;\n        }\n        if (pointer.stride !== stride) {\n          pointer.stride = stride;\n          changed = true;\n        }\n        if (pointer.offset !== offset) {\n          pointer.offset = offset;\n          changed = true;\n        }\n      }\n      if (changed || this._vaoRecordInProgress) {\n        this.bindArrayBuffer(buffer);\n        if (type === this._gl.UNSIGNED_INT || type === this._gl.INT) {\n          this._gl.vertexAttribIPointer(indx, size, type, stride, offset);\n        } else {\n          this._gl.vertexAttribPointer(indx, size, type, normalized, stride, offset);\n        }\n      }\n    }\n    /**\n     * @internal\n     */\n  }, {\n    key: \"_bindIndexBufferWithCache\",\n    value: function _bindIndexBufferWithCache(indexBuffer) {\n      if (indexBuffer == null) {\n        return;\n      }\n      if (this._cachedIndexBuffer !== indexBuffer) {\n        this._cachedIndexBuffer = indexBuffer;\n        this.bindIndexBuffer(indexBuffer);\n        this._uintIndicesCurrentlySet = indexBuffer.is32Bits;\n      }\n    }\n  }, {\n    key: \"_bindVertexBuffersAttributes\",\n    value: function _bindVertexBuffersAttributes(vertexBuffers, effect, overrideVertexBuffers) {\n      var attributes = effect.getAttributesNames();\n      if (!this._vaoRecordInProgress) {\n        this._unbindVertexArrayObject();\n      }\n      this.unbindAllAttributes();\n      for (var index = 0; index < attributes.length; index++) {\n        var order = effect.getAttributeLocation(index);\n        if (order >= 0) {\n          var ai = attributes[index];\n          var vertexBuffer = null;\n          if (overrideVertexBuffers) {\n            vertexBuffer = overrideVertexBuffers[ai];\n          }\n          if (!vertexBuffer) {\n            vertexBuffer = vertexBuffers[ai];\n          }\n          if (!vertexBuffer) {\n            continue;\n          }\n          this._gl.enableVertexAttribArray(order);\n          if (!this._vaoRecordInProgress) {\n            this._vertexAttribArraysEnabled[order] = true;\n          }\n          var buffer = vertexBuffer.getBuffer();\n          if (buffer) {\n            this._vertexAttribPointer(buffer, order, vertexBuffer.getSize(), vertexBuffer.type, vertexBuffer.normalized, vertexBuffer.byteStride, vertexBuffer.byteOffset);\n            if (vertexBuffer.getIsInstanced()) {\n              this._gl.vertexAttribDivisor(order, vertexBuffer.getInstanceDivisor());\n              if (!this._vaoRecordInProgress) {\n                this._currentInstanceLocations.push(order);\n                this._currentInstanceBuffers.push(buffer);\n              }\n            }\n          }\n        }\n      }\n    }\n    /**\n     * Records a vertex array object\n     * @see https://doc.babylonjs.com/setup/support/webGL2#vertex-array-objects\n     * @param vertexBuffers defines the list of vertex buffers to store\n     * @param indexBuffer defines the index buffer to store\n     * @param effect defines the effect to store\n     * @param overrideVertexBuffers defines optional list of avertex buffers that overrides the entries in vertexBuffers\n     * @returns the new vertex array object\n     */\n  }, {\n    key: \"recordVertexArrayObject\",\n    value: function recordVertexArrayObject(vertexBuffers, indexBuffer, effect, overrideVertexBuffers) {\n      var vao = this._gl.createVertexArray();\n      if (!vao) {\n        throw new Error(\"Unable to create VAO\");\n      }\n      this._vaoRecordInProgress = true;\n      this._gl.bindVertexArray(vao);\n      this._mustWipeVertexAttributes = true;\n      this._bindVertexBuffersAttributes(vertexBuffers, effect, overrideVertexBuffers);\n      this.bindIndexBuffer(indexBuffer);\n      this._vaoRecordInProgress = false;\n      this._gl.bindVertexArray(null);\n      return vao;\n    }\n    /**\n     * Bind a specific vertex array object\n     * @see https://doc.babylonjs.com/setup/support/webGL2#vertex-array-objects\n     * @param vertexArrayObject defines the vertex array object to bind\n     * @param indexBuffer defines the index buffer to bind\n     */\n  }, {\n    key: \"bindVertexArrayObject\",\n    value: function bindVertexArrayObject(vertexArrayObject, indexBuffer) {\n      if (this._cachedVertexArrayObject !== vertexArrayObject) {\n        this._cachedVertexArrayObject = vertexArrayObject;\n        this._gl.bindVertexArray(vertexArrayObject);\n        this._cachedVertexBuffers = null;\n        this._cachedIndexBuffer = null;\n        this._uintIndicesCurrentlySet = indexBuffer != null && indexBuffer.is32Bits;\n        this._mustWipeVertexAttributes = true;\n      }\n    }\n    /**\n     * Bind webGl buffers directly to the webGL context\n     * @param vertexBuffer defines the vertex buffer to bind\n     * @param indexBuffer defines the index buffer to bind\n     * @param vertexDeclaration defines the vertex declaration to use with the vertex buffer\n     * @param vertexStrideSize defines the vertex stride of the vertex buffer\n     * @param effect defines the effect associated with the vertex buffer\n     */\n  }, {\n    key: \"bindBuffersDirectly\",\n    value: function bindBuffersDirectly(vertexBuffer, indexBuffer, vertexDeclaration, vertexStrideSize, effect) {\n      if (this._cachedVertexBuffers !== vertexBuffer || this._cachedEffectForVertexBuffers !== effect) {\n        this._cachedVertexBuffers = vertexBuffer;\n        this._cachedEffectForVertexBuffers = effect;\n        var attributesCount = effect.getAttributesCount();\n        this._unbindVertexArrayObject();\n        this.unbindAllAttributes();\n        var offset = 0;\n        for (var index = 0; index < attributesCount; index++) {\n          if (index < vertexDeclaration.length) {\n            var order = effect.getAttributeLocation(index);\n            if (order >= 0) {\n              this._gl.enableVertexAttribArray(order);\n              this._vertexAttribArraysEnabled[order] = true;\n              this._vertexAttribPointer(vertexBuffer, order, vertexDeclaration[index], this._gl.FLOAT, false, vertexStrideSize, offset);\n            }\n            offset += vertexDeclaration[index] * 4;\n          }\n        }\n      }\n      this._bindIndexBufferWithCache(indexBuffer);\n    }\n  }, {\n    key: \"_unbindVertexArrayObject\",\n    value: function _unbindVertexArrayObject() {\n      if (!this._cachedVertexArrayObject) {\n        return;\n      }\n      this._cachedVertexArrayObject = null;\n      this._gl.bindVertexArray(null);\n    }\n    /**\n     * Bind a list of vertex buffers to the webGL context\n     * @param vertexBuffers defines the list of vertex buffers to bind\n     * @param indexBuffer defines the index buffer to bind\n     * @param effect defines the effect associated with the vertex buffers\n     * @param overrideVertexBuffers defines optional list of avertex buffers that overrides the entries in vertexBuffers\n     */\n  }, {\n    key: \"bindBuffers\",\n    value: function bindBuffers(vertexBuffers, indexBuffer, effect, overrideVertexBuffers) {\n      if (this._cachedVertexBuffers !== vertexBuffers || this._cachedEffectForVertexBuffers !== effect) {\n        this._cachedVertexBuffers = vertexBuffers;\n        this._cachedEffectForVertexBuffers = effect;\n        this._bindVertexBuffersAttributes(vertexBuffers, effect, overrideVertexBuffers);\n      }\n      this._bindIndexBufferWithCache(indexBuffer);\n    }\n    /**\n     * Unbind all instance attributes\n     */\n  }, {\n    key: \"unbindInstanceAttributes\",\n    value: function unbindInstanceAttributes() {\n      var boundBuffer;\n      for (var i = 0, ul = this._currentInstanceLocations.length; i < ul; i++) {\n        var instancesBuffer = this._currentInstanceBuffers[i];\n        if (boundBuffer != instancesBuffer && instancesBuffer.references) {\n          boundBuffer = instancesBuffer;\n          this.bindArrayBuffer(instancesBuffer);\n        }\n        var offsetLocation = this._currentInstanceLocations[i];\n        this._gl.vertexAttribDivisor(offsetLocation, 0);\n      }\n      this._currentInstanceBuffers.length = 0;\n      this._currentInstanceLocations.length = 0;\n    }\n    /**\n     * Release and free the memory of a vertex array object\n     * @param vao defines the vertex array object to delete\n     */\n  }, {\n    key: \"releaseVertexArrayObject\",\n    value: function releaseVertexArrayObject(vao) {\n      this._gl.deleteVertexArray(vao);\n    }\n    /**\n     * @internal\n     */\n  }, {\n    key: \"_releaseBuffer\",\n    value: function _releaseBuffer(buffer) {\n      buffer.references--;\n      if (buffer.references === 0) {\n        this._deleteBuffer(buffer);\n        return true;\n      }\n      return false;\n    }\n  }, {\n    key: \"_deleteBuffer\",\n    value: function _deleteBuffer(buffer) {\n      this._gl.deleteBuffer(buffer.underlyingResource);\n    }\n    /**\n     * Update the content of a webGL buffer used with instantiation and bind it to the webGL context\n     * @param instancesBuffer defines the webGL buffer to update and bind\n     * @param data defines the data to store in the buffer\n     * @param offsetLocations defines the offsets or attributes information used to determine where data must be stored in the buffer\n     */\n  }, {\n    key: \"updateAndBindInstancesBuffer\",\n    value: function updateAndBindInstancesBuffer(instancesBuffer, data, offsetLocations) {\n      this.bindArrayBuffer(instancesBuffer);\n      if (data) {\n        this._gl.bufferSubData(this._gl.ARRAY_BUFFER, 0, data);\n      }\n      if (offsetLocations[0].index !== undefined) {\n        this.bindInstancesBuffer(instancesBuffer, offsetLocations, true);\n      } else {\n        for (var index = 0; index < 4; index++) {\n          var offsetLocation = offsetLocations[index];\n          if (!this._vertexAttribArraysEnabled[offsetLocation]) {\n            this._gl.enableVertexAttribArray(offsetLocation);\n            this._vertexAttribArraysEnabled[offsetLocation] = true;\n          }\n          this._vertexAttribPointer(instancesBuffer, offsetLocation, 4, this._gl.FLOAT, false, 64, index * 16);\n          this._gl.vertexAttribDivisor(offsetLocation, 1);\n          this._currentInstanceLocations.push(offsetLocation);\n          this._currentInstanceBuffers.push(instancesBuffer);\n        }\n      }\n    }\n    /**\n     * Bind the content of a webGL buffer used with instantiation\n     * @param instancesBuffer defines the webGL buffer to bind\n     * @param attributesInfo defines the offsets or attributes information used to determine where data must be stored in the buffer\n     * @param computeStride defines Whether to compute the strides from the info or use the default 0\n     */\n  }, {\n    key: \"bindInstancesBuffer\",\n    value: function bindInstancesBuffer(instancesBuffer, attributesInfo) {\n      var computeStride = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n      this.bindArrayBuffer(instancesBuffer);\n      var stride = 0;\n      if (computeStride) {\n        for (var i = 0; i < attributesInfo.length; i++) {\n          var ai = attributesInfo[i];\n          stride += ai.attributeSize * 4;\n        }\n      }\n      for (var _i = 0; _i < attributesInfo.length; _i++) {\n        var _ai = attributesInfo[_i];\n        if (_ai.index === undefined) {\n          _ai.index = this._currentEffect.getAttributeLocationByName(_ai.attributeName);\n        }\n        if (_ai.index < 0) {\n          continue;\n        }\n        if (!this._vertexAttribArraysEnabled[_ai.index]) {\n          this._gl.enableVertexAttribArray(_ai.index);\n          this._vertexAttribArraysEnabled[_ai.index] = true;\n        }\n        this._vertexAttribPointer(instancesBuffer, _ai.index, _ai.attributeSize, _ai.attributeType || this._gl.FLOAT, _ai.normalized || false, stride, _ai.offset);\n        this._gl.vertexAttribDivisor(_ai.index, _ai.divisor === undefined ? 1 : _ai.divisor);\n        this._currentInstanceLocations.push(_ai.index);\n        this._currentInstanceBuffers.push(instancesBuffer);\n      }\n    }\n    /**\n     * Disable the instance attribute corresponding to the name in parameter\n     * @param name defines the name of the attribute to disable\n     */\n  }, {\n    key: \"disableInstanceAttributeByName\",\n    value: function disableInstanceAttributeByName(name) {\n      if (!this._currentEffect) {\n        return;\n      }\n      var attributeLocation = this._currentEffect.getAttributeLocationByName(name);\n      this.disableInstanceAttribute(attributeLocation);\n    }\n    /**\n     * Disable the instance attribute corresponding to the location in parameter\n     * @param attributeLocation defines the attribute location of the attribute to disable\n     */\n  }, {\n    key: \"disableInstanceAttribute\",\n    value: function disableInstanceAttribute(attributeLocation) {\n      var shouldClean = false;\n      var index;\n      while ((index = this._currentInstanceLocations.indexOf(attributeLocation)) !== -1) {\n        this._currentInstanceLocations.splice(index, 1);\n        this._currentInstanceBuffers.splice(index, 1);\n        shouldClean = true;\n        index = this._currentInstanceLocations.indexOf(attributeLocation);\n      }\n      if (shouldClean) {\n        this._gl.vertexAttribDivisor(attributeLocation, 0);\n        this.disableAttributeByIndex(attributeLocation);\n      }\n    }\n    /**\n     * Disable the attribute corresponding to the location in parameter\n     * @param attributeLocation defines the attribute location of the attribute to disable\n     */\n  }, {\n    key: \"disableAttributeByIndex\",\n    value: function disableAttributeByIndex(attributeLocation) {\n      this._gl.disableVertexAttribArray(attributeLocation);\n      this._vertexAttribArraysEnabled[attributeLocation] = false;\n      this._currentBufferPointers[attributeLocation].active = false;\n    }\n    /**\n     * Send a draw order\n     * @param useTriangles defines if triangles must be used to draw (else wireframe will be used)\n     * @param indexStart defines the starting index\n     * @param indexCount defines the number of index to draw\n     * @param instancesCount defines the number of instances to draw (if instantiation is enabled)\n     */\n  }, {\n    key: \"draw\",\n    value: function draw(useTriangles, indexStart, indexCount, instancesCount) {\n      this.drawElementsType(useTriangles ? 0 : 1, indexStart, indexCount, instancesCount);\n    }\n    /**\n     * Draw a list of points\n     * @param verticesStart defines the index of first vertex to draw\n     * @param verticesCount defines the count of vertices to draw\n     * @param instancesCount defines the number of instances to draw (if instantiation is enabled)\n     */\n  }, {\n    key: \"drawPointClouds\",\n    value: function drawPointClouds(verticesStart, verticesCount, instancesCount) {\n      this.drawArraysType(2, verticesStart, verticesCount, instancesCount);\n    }\n    /**\n     * Draw a list of unindexed primitives\n     * @param useTriangles defines if triangles must be used to draw (else wireframe will be used)\n     * @param verticesStart defines the index of first vertex to draw\n     * @param verticesCount defines the count of vertices to draw\n     * @param instancesCount defines the number of instances to draw (if instantiation is enabled)\n     */\n  }, {\n    key: \"drawUnIndexed\",\n    value: function drawUnIndexed(useTriangles, verticesStart, verticesCount, instancesCount) {\n      this.drawArraysType(useTriangles ? 0 : 1, verticesStart, verticesCount, instancesCount);\n    }\n    /**\n     * Draw a list of indexed primitives\n     * @param fillMode defines the primitive to use\n     * @param indexStart defines the starting index\n     * @param indexCount defines the number of index to draw\n     * @param instancesCount defines the number of instances to draw (if instantiation is enabled)\n     */\n  }, {\n    key: \"drawElementsType\",\n    value: function drawElementsType(fillMode, indexStart, indexCount, instancesCount) {\n      // Apply states\n      this.applyStates();\n      this._reportDrawCall();\n      // Render\n      var drawMode = this._drawMode(fillMode);\n      var indexFormat = this._uintIndicesCurrentlySet ? this._gl.UNSIGNED_INT : this._gl.UNSIGNED_SHORT;\n      var mult = this._uintIndicesCurrentlySet ? 4 : 2;\n      if (instancesCount) {\n        this._gl.drawElementsInstanced(drawMode, indexCount, indexFormat, indexStart * mult, instancesCount);\n      } else {\n        this._gl.drawElements(drawMode, indexCount, indexFormat, indexStart * mult);\n      }\n    }\n    /**\n     * Draw a list of unindexed primitives\n     * @param fillMode defines the primitive to use\n     * @param verticesStart defines the index of first vertex to draw\n     * @param verticesCount defines the count of vertices to draw\n     * @param instancesCount defines the number of instances to draw (if instantiation is enabled)\n     */\n  }, {\n    key: \"drawArraysType\",\n    value: function drawArraysType(fillMode, verticesStart, verticesCount, instancesCount) {\n      // Apply states\n      this.applyStates();\n      this._reportDrawCall();\n      var drawMode = this._drawMode(fillMode);\n      if (instancesCount) {\n        this._gl.drawArraysInstanced(drawMode, verticesStart, verticesCount, instancesCount);\n      } else {\n        this._gl.drawArrays(drawMode, verticesStart, verticesCount);\n      }\n    }\n  }, {\n    key: \"_drawMode\",\n    value: function _drawMode(fillMode) {\n      switch (fillMode) {\n        // Triangle views\n        case 0:\n          return this._gl.TRIANGLES;\n        case 2:\n          return this._gl.POINTS;\n        case 1:\n          return this._gl.LINES;\n        // Draw modes\n        case 3:\n          return this._gl.POINTS;\n        case 4:\n          return this._gl.LINES;\n        case 5:\n          return this._gl.LINE_LOOP;\n        case 6:\n          return this._gl.LINE_STRIP;\n        case 7:\n          return this._gl.TRIANGLE_STRIP;\n        case 8:\n          return this._gl.TRIANGLE_FAN;\n        default:\n          return this._gl.TRIANGLES;\n      }\n    }\n    /** @internal */\n  }, {\n    key: \"_reportDrawCall\",\n    value: function _reportDrawCall() {\n      // Will be implemented by children\n    }\n    // Shaders\n    /**\n     * @internal\n     */\n  }, {\n    key: \"_releaseEffect\",\n    value: function _releaseEffect(effect) {\n      if (this._compiledEffects[effect._key]) {\n        delete this._compiledEffects[effect._key];\n      }\n      var pipelineContext = effect.getPipelineContext();\n      if (pipelineContext) {\n        this._deletePipelineContext(pipelineContext);\n      }\n    }\n    /**\n     * @internal\n     */\n  }, {\n    key: \"_deletePipelineContext\",\n    value: function _deletePipelineContext(pipelineContext) {\n      var webGLPipelineContext = pipelineContext;\n      if (webGLPipelineContext && webGLPipelineContext.program) {\n        webGLPipelineContext.program.__SPECTOR_rebuildProgram = null;\n        this._gl.deleteProgram(webGLPipelineContext.program);\n      }\n    }\n    /** @internal */\n  }, {\n    key: \"_getGlobalDefines\",\n    value: function _getGlobalDefines(defines) {\n      if (defines) {\n        if (this.isNDCHalfZRange) {\n          defines[\"IS_NDC_HALF_ZRANGE\"] = \"\";\n        } else {\n          delete defines[\"IS_NDC_HALF_ZRANGE\"];\n        }\n        if (this.useReverseDepthBuffer) {\n          defines[\"USE_REVERSE_DEPTHBUFFER\"] = \"\";\n        } else {\n          delete defines[\"USE_REVERSE_DEPTHBUFFER\"];\n        }\n        if (this.useExactSrgbConversions) {\n          defines[\"USE_EXACT_SRGB_CONVERSIONS\"] = \"\";\n        } else {\n          delete defines[\"USE_EXACT_SRGB_CONVERSIONS\"];\n        }\n        return;\n      } else {\n        var s = \"\";\n        if (this.isNDCHalfZRange) {\n          s += \"#define IS_NDC_HALF_ZRANGE\";\n        }\n        if (this.useReverseDepthBuffer) {\n          if (s) {\n            s += \"\\n\";\n          }\n          s += \"#define USE_REVERSE_DEPTHBUFFER\";\n        }\n        if (this.useExactSrgbConversions) {\n          if (s) {\n            s += \"\\n\";\n          }\n          s += \"#define USE_EXACT_SRGB_CONVERSIONS\";\n        }\n        return s;\n      }\n    }\n    /**\n     * Create a new effect (used to store vertex/fragment shaders)\n     * @param baseName defines the base name of the effect (The name of file without .fragment.fx or .vertex.fx)\n     * @param attributesNamesOrOptions defines either a list of attribute names or an IEffectCreationOptions object\n     * @param uniformsNamesOrEngine defines either a list of uniform names or the engine to use\n     * @param samplers defines an array of string used to represent textures\n     * @param defines defines the string containing the defines to use to compile the shaders\n     * @param fallbacks defines the list of potential fallbacks to use if shader compilation fails\n     * @param onCompiled defines a function to call when the effect creation is successful\n     * @param onError defines a function to call when the effect creation has failed\n     * @param indexParameters defines an object containing the index values to use to compile shaders (like the maximum number of simultaneous lights)\n     * @param shaderLanguage the language the shader is written in (default: GLSL)\n     * @returns the new Effect\n     */\n  }, {\n    key: \"createEffect\",\n    value: function createEffect(baseName, attributesNamesOrOptions, uniformsNamesOrEngine, samplers, defines, fallbacks, onCompiled, onError, indexParameters) {\n      var shaderLanguage = arguments.length > 9 && arguments[9] !== undefined ? arguments[9] : ShaderLanguage.GLSL;\n      var _a;\n      var vertex = baseName.vertexElement || baseName.vertex || baseName.vertexToken || baseName.vertexSource || baseName;\n      var fragment = baseName.fragmentElement || baseName.fragment || baseName.fragmentToken || baseName.fragmentSource || baseName;\n      var globalDefines = this._getGlobalDefines();\n      var fullDefines = (_a = defines !== null && defines !== void 0 ? defines : attributesNamesOrOptions.defines) !== null && _a !== void 0 ? _a : \"\";\n      if (globalDefines) {\n        fullDefines += globalDefines;\n      }\n      var name = vertex + \"+\" + fragment + \"@\" + fullDefines;\n      if (this._compiledEffects[name]) {\n        var compiledEffect = this._compiledEffects[name];\n        if (onCompiled && compiledEffect.isReady()) {\n          onCompiled(compiledEffect);\n        }\n        return compiledEffect;\n      }\n      var effect = new Effect(baseName, attributesNamesOrOptions, uniformsNamesOrEngine, samplers, this, defines, fallbacks, onCompiled, onError, indexParameters, name, shaderLanguage);\n      this._compiledEffects[name] = effect;\n      return effect;\n    }\n    // eslint-disable-next-line @typescript-eslint/naming-convention\n  }, {\n    key: \"_compileShader\",\n    value: function _compileShader(source, type, defines, shaderVersion) {\n      return this._compileRawShader(ThinEngine._ConcatenateShader(source, defines, shaderVersion), type);\n    }\n  }, {\n    key: \"_compileRawShader\",\n    value: function _compileRawShader(source, type) {\n      var gl = this._gl;\n      var shader = gl.createShader(type === \"vertex\" ? gl.VERTEX_SHADER : gl.FRAGMENT_SHADER);\n      if (!shader) {\n        var error = gl.NO_ERROR;\n        var tempError = gl.NO_ERROR;\n        while ((tempError = gl.getError()) !== gl.NO_ERROR) {\n          error = tempError;\n        }\n        throw new Error(\"Something went wrong while creating a gl \".concat(type, \" shader object. gl error=\").concat(error, \", gl isContextLost=\").concat(gl.isContextLost(), \", _contextWasLost=\").concat(this._contextWasLost));\n      }\n      gl.shaderSource(shader, source);\n      gl.compileShader(shader);\n      return shader;\n    }\n    /**\n     * @internal\n     */\n  }, {\n    key: \"_getShaderSource\",\n    value: function _getShaderSource(shader) {\n      return this._gl.getShaderSource(shader);\n    }\n    /**\n     * Directly creates a webGL program\n     * @param pipelineContext  defines the pipeline context to attach to\n     * @param vertexCode defines the vertex shader code to use\n     * @param fragmentCode defines the fragment shader code to use\n     * @param context defines the webGL context to use (if not set, the current one will be used)\n     * @param transformFeedbackVaryings defines the list of transform feedback varyings to use\n     * @returns the new webGL program\n     */\n  }, {\n    key: \"createRawShaderProgram\",\n    value: function createRawShaderProgram(pipelineContext, vertexCode, fragmentCode, context) {\n      var transformFeedbackVaryings = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : null;\n      context = context || this._gl;\n      var vertexShader = this._compileRawShader(vertexCode, \"vertex\");\n      var fragmentShader = this._compileRawShader(fragmentCode, \"fragment\");\n      return this._createShaderProgram(pipelineContext, vertexShader, fragmentShader, context, transformFeedbackVaryings);\n    }\n    /**\n     * Creates a webGL program\n     * @param pipelineContext  defines the pipeline context to attach to\n     * @param vertexCode  defines the vertex shader code to use\n     * @param fragmentCode defines the fragment shader code to use\n     * @param defines defines the string containing the defines to use to compile the shaders\n     * @param context defines the webGL context to use (if not set, the current one will be used)\n     * @param transformFeedbackVaryings defines the list of transform feedback varyings to use\n     * @returns the new webGL program\n     */\n  }, {\n    key: \"createShaderProgram\",\n    value: function createShaderProgram(pipelineContext, vertexCode, fragmentCode, defines, context) {\n      var transformFeedbackVaryings = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : null;\n      context = context || this._gl;\n      var shaderVersion = this._webGLVersion > 1 ? \"#version 300 es\\n#define WEBGL2 \\n\" : \"\";\n      var vertexShader = this._compileShader(vertexCode, \"vertex\", defines, shaderVersion);\n      var fragmentShader = this._compileShader(fragmentCode, \"fragment\", defines, shaderVersion);\n      return this._createShaderProgram(pipelineContext, vertexShader, fragmentShader, context, transformFeedbackVaryings);\n    }\n    /**\n     * Inline functions in shader code that are marked to be inlined\n     * @param code code to inline\n     * @returns inlined code\n     */\n  }, {\n    key: \"inlineShaderCode\",\n    value: function inlineShaderCode(code) {\n      // no inlining needed in the WebGL engine\n      return code;\n    }\n    /**\n     * Creates a new pipeline context\n     * @param shaderProcessingContext defines the shader processing context used during the processing if available\n     * @returns the new pipeline\n     */\n  }, {\n    key: \"createPipelineContext\",\n    value: function createPipelineContext(shaderProcessingContext) {\n      var pipelineContext = new WebGLPipelineContext();\n      pipelineContext.engine = this;\n      if (this._caps.parallelShaderCompile) {\n        pipelineContext.isParallelCompiled = true;\n      }\n      return pipelineContext;\n    }\n    /**\n     * Creates a new material context\n     * @returns the new context\n     */\n  }, {\n    key: \"createMaterialContext\",\n    value: function createMaterialContext() {\n      return undefined;\n    }\n    /**\n     * Creates a new draw context\n     * @returns the new context\n     */\n  }, {\n    key: \"createDrawContext\",\n    value: function createDrawContext() {\n      return undefined;\n    }\n  }, {\n    key: \"_createShaderProgram\",\n    value: function _createShaderProgram(pipelineContext, vertexShader, fragmentShader, context) {\n      var transformFeedbackVaryings = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : null;\n      var shaderProgram = context.createProgram();\n      pipelineContext.program = shaderProgram;\n      if (!shaderProgram) {\n        throw new Error(\"Unable to create program\");\n      }\n      context.attachShader(shaderProgram, vertexShader);\n      context.attachShader(shaderProgram, fragmentShader);\n      context.linkProgram(shaderProgram);\n      pipelineContext.context = context;\n      pipelineContext.vertexShader = vertexShader;\n      pipelineContext.fragmentShader = fragmentShader;\n      if (!pipelineContext.isParallelCompiled) {\n        this._finalizePipelineContext(pipelineContext);\n      }\n      return shaderProgram;\n    }\n  }, {\n    key: \"_finalizePipelineContext\",\n    value: function _finalizePipelineContext(pipelineContext) {\n      var context = pipelineContext.context;\n      var vertexShader = pipelineContext.vertexShader;\n      var fragmentShader = pipelineContext.fragmentShader;\n      var program = pipelineContext.program;\n      var linked = context.getProgramParameter(program, context.LINK_STATUS);\n      if (!linked) {\n        // Get more info\n        // Vertex\n        if (!this._gl.getShaderParameter(vertexShader, this._gl.COMPILE_STATUS)) {\n          var log = this._gl.getShaderInfoLog(vertexShader);\n          if (log) {\n            pipelineContext.vertexCompilationError = log;\n            throw new Error(\"VERTEX SHADER \" + log);\n          }\n        }\n        // Fragment\n        if (!this._gl.getShaderParameter(fragmentShader, this._gl.COMPILE_STATUS)) {\n          var _log = this._gl.getShaderInfoLog(fragmentShader);\n          if (_log) {\n            pipelineContext.fragmentCompilationError = _log;\n            throw new Error(\"FRAGMENT SHADER \" + _log);\n          }\n        }\n        var error = context.getProgramInfoLog(program);\n        if (error) {\n          pipelineContext.programLinkError = error;\n          throw new Error(error);\n        }\n      }\n      if (this.validateShaderPrograms) {\n        context.validateProgram(program);\n        var validated = context.getProgramParameter(program, context.VALIDATE_STATUS);\n        if (!validated) {\n          var _error = context.getProgramInfoLog(program);\n          if (_error) {\n            pipelineContext.programValidationError = _error;\n            throw new Error(_error);\n          }\n        }\n      }\n      context.deleteShader(vertexShader);\n      context.deleteShader(fragmentShader);\n      pipelineContext.vertexShader = undefined;\n      pipelineContext.fragmentShader = undefined;\n      if (pipelineContext.onCompiled) {\n        pipelineContext.onCompiled();\n        pipelineContext.onCompiled = undefined;\n      }\n    }\n    /**\n     * @internal\n     */\n  }, {\n    key: \"_preparePipelineContext\",\n    value: function _preparePipelineContext(pipelineContext, vertexSourceCode, fragmentSourceCode, createAsRaw, rawVertexSourceCode, rawFragmentSourceCode, rebuildRebind, defines, transformFeedbackVaryings, key) {\n      var webGLRenderingState = pipelineContext;\n      if (createAsRaw) {\n        webGLRenderingState.program = this.createRawShaderProgram(webGLRenderingState, vertexSourceCode, fragmentSourceCode, undefined, transformFeedbackVaryings);\n      } else {\n        webGLRenderingState.program = this.createShaderProgram(webGLRenderingState, vertexSourceCode, fragmentSourceCode, defines, undefined, transformFeedbackVaryings);\n      }\n      webGLRenderingState.program.__SPECTOR_rebuildProgram = rebuildRebind;\n    }\n    /**\n     * @internal\n     */\n  }, {\n    key: \"_isRenderingStateCompiled\",\n    value: function _isRenderingStateCompiled(pipelineContext) {\n      var webGLPipelineContext = pipelineContext;\n      if (this._gl.getProgramParameter(webGLPipelineContext.program, this._caps.parallelShaderCompile.COMPLETION_STATUS_KHR)) {\n        this._finalizePipelineContext(webGLPipelineContext);\n        return true;\n      }\n      return false;\n    }\n    /**\n     * @internal\n     */\n  }, {\n    key: \"_executeWhenRenderingStateIsCompiled\",\n    value: function _executeWhenRenderingStateIsCompiled(pipelineContext, action) {\n      var webGLPipelineContext = pipelineContext;\n      if (!webGLPipelineContext.isParallelCompiled) {\n        action();\n        return;\n      }\n      var oldHandler = webGLPipelineContext.onCompiled;\n      if (oldHandler) {\n        webGLPipelineContext.onCompiled = function () {\n          oldHandler();\n          action();\n        };\n      } else {\n        webGLPipelineContext.onCompiled = action;\n      }\n    }\n    /**\n     * Gets the list of webGL uniform locations associated with a specific program based on a list of uniform names\n     * @param pipelineContext defines the pipeline context to use\n     * @param uniformsNames defines the list of uniform names\n     * @returns an array of webGL uniform locations\n     */\n  }, {\n    key: \"getUniforms\",\n    value: function getUniforms(pipelineContext, uniformsNames) {\n      var results = new Array();\n      var webGLPipelineContext = pipelineContext;\n      for (var index = 0; index < uniformsNames.length; index++) {\n        results.push(this._gl.getUniformLocation(webGLPipelineContext.program, uniformsNames[index]));\n      }\n      return results;\n    }\n    /**\n     * Gets the list of active attributes for a given webGL program\n     * @param pipelineContext defines the pipeline context to use\n     * @param attributesNames defines the list of attribute names to get\n     * @returns an array of indices indicating the offset of each attribute\n     */\n  }, {\n    key: \"getAttributes\",\n    value: function getAttributes(pipelineContext, attributesNames) {\n      var results = [];\n      var webGLPipelineContext = pipelineContext;\n      for (var index = 0; index < attributesNames.length; index++) {\n        try {\n          results.push(this._gl.getAttribLocation(webGLPipelineContext.program, attributesNames[index]));\n        } catch (e) {\n          results.push(-1);\n        }\n      }\n      return results;\n    }\n    /**\n     * Activates an effect, making it the current one (ie. the one used for rendering)\n     * @param effect defines the effect to activate\n     */\n  }, {\n    key: \"enableEffect\",\n    value: function enableEffect(effect) {\n      effect = effect !== null && DrawWrapper.IsWrapper(effect) ? effect.effect : effect; // get only the effect, we don't need a Wrapper in the WebGL engine\n      if (!effect || effect === this._currentEffect) {\n        return;\n      }\n      this._stencilStateComposer.stencilMaterial = undefined;\n      effect = effect;\n      // Use program\n      this.bindSamplers(effect);\n      this._currentEffect = effect;\n      if (effect.onBind) {\n        effect.onBind(effect);\n      }\n      if (effect._onBindObservable) {\n        effect._onBindObservable.notifyObservers(effect);\n      }\n    }\n    /**\n     * Set the value of an uniform to a number (int)\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param value defines the int number to store\n     * @returns true if the value was set\n     */\n  }, {\n    key: \"setInt\",\n    value: function setInt(uniform, value) {\n      if (!uniform) {\n        return false;\n      }\n      this._gl.uniform1i(uniform, value);\n      return true;\n    }\n    /**\n     * Set the value of an uniform to a int2\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param x defines the 1st component of the value\n     * @param y defines the 2nd component of the value\n     * @returns true if the value was set\n     */\n  }, {\n    key: \"setInt2\",\n    value: function setInt2(uniform, x, y) {\n      if (!uniform) {\n        return false;\n      }\n      this._gl.uniform2i(uniform, x, y);\n      return true;\n    }\n    /**\n     * Set the value of an uniform to a int3\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param x defines the 1st component of the value\n     * @param y defines the 2nd component of the value\n     * @param z defines the 3rd component of the value\n     * @returns true if the value was set\n     */\n  }, {\n    key: \"setInt3\",\n    value: function setInt3(uniform, x, y, z) {\n      if (!uniform) {\n        return false;\n      }\n      this._gl.uniform3i(uniform, x, y, z);\n      return true;\n    }\n    /**\n     * Set the value of an uniform to a int4\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param x defines the 1st component of the value\n     * @param y defines the 2nd component of the value\n     * @param z defines the 3rd component of the value\n     * @param w defines the 4th component of the value\n     * @returns true if the value was set\n     */\n  }, {\n    key: \"setInt4\",\n    value: function setInt4(uniform, x, y, z, w) {\n      if (!uniform) {\n        return false;\n      }\n      this._gl.uniform4i(uniform, x, y, z, w);\n      return true;\n    }\n    /**\n     * Set the value of an uniform to an array of int32\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param array defines the array of int32 to store\n     * @returns true if the value was set\n     */\n  }, {\n    key: \"setIntArray\",\n    value: function setIntArray(uniform, array) {\n      if (!uniform) {\n        return false;\n      }\n      this._gl.uniform1iv(uniform, array);\n      return true;\n    }\n    /**\n     * Set the value of an uniform to an array of int32 (stored as vec2)\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param array defines the array of int32 to store\n     * @returns true if the value was set\n     */\n  }, {\n    key: \"setIntArray2\",\n    value: function setIntArray2(uniform, array) {\n      if (!uniform || array.length % 2 !== 0) {\n        return false;\n      }\n      this._gl.uniform2iv(uniform, array);\n      return true;\n    }\n    /**\n     * Set the value of an uniform to an array of int32 (stored as vec3)\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param array defines the array of int32 to store\n     * @returns true if the value was set\n     */\n  }, {\n    key: \"setIntArray3\",\n    value: function setIntArray3(uniform, array) {\n      if (!uniform || array.length % 3 !== 0) {\n        return false;\n      }\n      this._gl.uniform3iv(uniform, array);\n      return true;\n    }\n    /**\n     * Set the value of an uniform to an array of int32 (stored as vec4)\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param array defines the array of int32 to store\n     * @returns true if the value was set\n     */\n  }, {\n    key: \"setIntArray4\",\n    value: function setIntArray4(uniform, array) {\n      if (!uniform || array.length % 4 !== 0) {\n        return false;\n      }\n      this._gl.uniform4iv(uniform, array);\n      return true;\n    }\n    /**\n     * Set the value of an uniform to a number (unsigned int)\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param value defines the unsigned int number to store\n     * @returns true if the value was set\n     */\n  }, {\n    key: \"setUInt\",\n    value: function setUInt(uniform, value) {\n      if (!uniform) {\n        return false;\n      }\n      this._gl.uniform1ui(uniform, value);\n      return true;\n    }\n    /**\n     * Set the value of an uniform to a unsigned int2\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param x defines the 1st component of the value\n     * @param y defines the 2nd component of the value\n     * @returns true if the value was set\n     */\n  }, {\n    key: \"setUInt2\",\n    value: function setUInt2(uniform, x, y) {\n      if (!uniform) {\n        return false;\n      }\n      this._gl.uniform2ui(uniform, x, y);\n      return true;\n    }\n    /**\n     * Set the value of an uniform to a unsigned int3\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param x defines the 1st component of the value\n     * @param y defines the 2nd component of the value\n     * @param z defines the 3rd component of the value\n     * @returns true if the value was set\n     */\n  }, {\n    key: \"setUInt3\",\n    value: function setUInt3(uniform, x, y, z) {\n      if (!uniform) {\n        return false;\n      }\n      this._gl.uniform3ui(uniform, x, y, z);\n      return true;\n    }\n    /**\n     * Set the value of an uniform to a unsigned int4\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param x defines the 1st component of the value\n     * @param y defines the 2nd component of the value\n     * @param z defines the 3rd component of the value\n     * @param w defines the 4th component of the value\n     * @returns true if the value was set\n     */\n  }, {\n    key: \"setUInt4\",\n    value: function setUInt4(uniform, x, y, z, w) {\n      if (!uniform) {\n        return false;\n      }\n      this._gl.uniform4ui(uniform, x, y, z, w);\n      return true;\n    }\n    /**\n     * Set the value of an uniform to an array of unsigned int32\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param array defines the array of unsigned int32 to store\n     * @returns true if the value was set\n     */\n  }, {\n    key: \"setUIntArray\",\n    value: function setUIntArray(uniform, array) {\n      if (!uniform) {\n        return false;\n      }\n      this._gl.uniform1uiv(uniform, array);\n      return true;\n    }\n    /**\n     * Set the value of an uniform to an array of unsigned int32 (stored as vec2)\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param array defines the array of unsigned int32 to store\n     * @returns true if the value was set\n     */\n  }, {\n    key: \"setUIntArray2\",\n    value: function setUIntArray2(uniform, array) {\n      if (!uniform || array.length % 2 !== 0) {\n        return false;\n      }\n      this._gl.uniform2uiv(uniform, array);\n      return true;\n    }\n    /**\n     * Set the value of an uniform to an array of unsigned int32 (stored as vec3)\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param array defines the array of unsigned int32 to store\n     * @returns true if the value was set\n     */\n  }, {\n    key: \"setUIntArray3\",\n    value: function setUIntArray3(uniform, array) {\n      if (!uniform || array.length % 3 !== 0) {\n        return false;\n      }\n      this._gl.uniform3uiv(uniform, array);\n      return true;\n    }\n    /**\n     * Set the value of an uniform to an array of unsigned int32 (stored as vec4)\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param array defines the array of unsigned int32 to store\n     * @returns true if the value was set\n     */\n  }, {\n    key: \"setUIntArray4\",\n    value: function setUIntArray4(uniform, array) {\n      if (!uniform || array.length % 4 !== 0) {\n        return false;\n      }\n      this._gl.uniform4uiv(uniform, array);\n      return true;\n    }\n    /**\n     * Set the value of an uniform to an array of number\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param array defines the array of number to store\n     * @returns true if the value was set\n     */\n  }, {\n    key: \"setArray\",\n    value: function setArray(uniform, array) {\n      if (!uniform) {\n        return false;\n      }\n      if (array.length < 1) {\n        return false;\n      }\n      this._gl.uniform1fv(uniform, array);\n      return true;\n    }\n    /**\n     * Set the value of an uniform to an array of number (stored as vec2)\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param array defines the array of number to store\n     * @returns true if the value was set\n     */\n  }, {\n    key: \"setArray2\",\n    value: function setArray2(uniform, array) {\n      if (!uniform || array.length % 2 !== 0) {\n        return false;\n      }\n      this._gl.uniform2fv(uniform, array);\n      return true;\n    }\n    /**\n     * Set the value of an uniform to an array of number (stored as vec3)\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param array defines the array of number to store\n     * @returns true if the value was set\n     */\n  }, {\n    key: \"setArray3\",\n    value: function setArray3(uniform, array) {\n      if (!uniform || array.length % 3 !== 0) {\n        return false;\n      }\n      this._gl.uniform3fv(uniform, array);\n      return true;\n    }\n    /**\n     * Set the value of an uniform to an array of number (stored as vec4)\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param array defines the array of number to store\n     * @returns true if the value was set\n     */\n  }, {\n    key: \"setArray4\",\n    value: function setArray4(uniform, array) {\n      if (!uniform || array.length % 4 !== 0) {\n        return false;\n      }\n      this._gl.uniform4fv(uniform, array);\n      return true;\n    }\n    /**\n     * Set the value of an uniform to an array of float32 (stored as matrices)\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param matrices defines the array of float32 to store\n     * @returns true if the value was set\n     */\n  }, {\n    key: \"setMatrices\",\n    value: function setMatrices(uniform, matrices) {\n      if (!uniform) {\n        return false;\n      }\n      this._gl.uniformMatrix4fv(uniform, false, matrices);\n      return true;\n    }\n    /**\n     * Set the value of an uniform to a matrix (3x3)\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param matrix defines the Float32Array representing the 3x3 matrix to store\n     * @returns true if the value was set\n     */\n  }, {\n    key: \"setMatrix3x3\",\n    value: function setMatrix3x3(uniform, matrix) {\n      if (!uniform) {\n        return false;\n      }\n      this._gl.uniformMatrix3fv(uniform, false, matrix);\n      return true;\n    }\n    /**\n     * Set the value of an uniform to a matrix (2x2)\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param matrix defines the Float32Array representing the 2x2 matrix to store\n     * @returns true if the value was set\n     */\n  }, {\n    key: \"setMatrix2x2\",\n    value: function setMatrix2x2(uniform, matrix) {\n      if (!uniform) {\n        return false;\n      }\n      this._gl.uniformMatrix2fv(uniform, false, matrix);\n      return true;\n    }\n    /**\n     * Set the value of an uniform to a number (float)\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param value defines the float number to store\n     * @returns true if the value was transferred\n     */\n  }, {\n    key: \"setFloat\",\n    value: function setFloat(uniform, value) {\n      if (!uniform) {\n        return false;\n      }\n      this._gl.uniform1f(uniform, value);\n      return true;\n    }\n    /**\n     * Set the value of an uniform to a vec2\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param x defines the 1st component of the value\n     * @param y defines the 2nd component of the value\n     * @returns true if the value was set\n     */\n  }, {\n    key: \"setFloat2\",\n    value: function setFloat2(uniform, x, y) {\n      if (!uniform) {\n        return false;\n      }\n      this._gl.uniform2f(uniform, x, y);\n      return true;\n    }\n    /**\n     * Set the value of an uniform to a vec3\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param x defines the 1st component of the value\n     * @param y defines the 2nd component of the value\n     * @param z defines the 3rd component of the value\n     * @returns true if the value was set\n     */\n  }, {\n    key: \"setFloat3\",\n    value: function setFloat3(uniform, x, y, z) {\n      if (!uniform) {\n        return false;\n      }\n      this._gl.uniform3f(uniform, x, y, z);\n      return true;\n    }\n    /**\n     * Set the value of an uniform to a vec4\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param x defines the 1st component of the value\n     * @param y defines the 2nd component of the value\n     * @param z defines the 3rd component of the value\n     * @param w defines the 4th component of the value\n     * @returns true if the value was set\n     */\n  }, {\n    key: \"setFloat4\",\n    value: function setFloat4(uniform, x, y, z, w) {\n      if (!uniform) {\n        return false;\n      }\n      this._gl.uniform4f(uniform, x, y, z, w);\n      return true;\n    }\n    // States\n    /**\n     * Apply all cached states (depth, culling, stencil and alpha)\n     */\n  }, {\n    key: \"applyStates\",\n    value: function applyStates() {\n      this._depthCullingState.apply(this._gl);\n      this._stencilStateComposer.apply(this._gl);\n      this._alphaState.apply(this._gl);\n      if (this._colorWriteChanged) {\n        this._colorWriteChanged = false;\n        var enable = this._colorWrite;\n        this._gl.colorMask(enable, enable, enable, enable);\n      }\n    }\n    /**\n     * Enable or disable color writing\n     * @param enable defines the state to set\n     */\n  }, {\n    key: \"setColorWrite\",\n    value: function setColorWrite(enable) {\n      if (enable !== this._colorWrite) {\n        this._colorWriteChanged = true;\n        this._colorWrite = enable;\n      }\n    }\n    /**\n     * Gets a boolean indicating if color writing is enabled\n     * @returns the current color writing state\n     */\n  }, {\n    key: \"getColorWrite\",\n    value: function getColorWrite() {\n      return this._colorWrite;\n    }\n    /**\n     * Gets the depth culling state manager\n     */\n  }, {\n    key: \"depthCullingState\",\n    get: function get() {\n      return this._depthCullingState;\n    }\n    /**\n     * Gets the alpha state manager\n     */\n  }, {\n    key: \"alphaState\",\n    get: function get() {\n      return this._alphaState;\n    }\n    /**\n     * Gets the stencil state manager\n     */\n  }, {\n    key: \"stencilState\",\n    get: function get() {\n      return this._stencilState;\n    }\n    /**\n     * Gets the stencil state composer\n     */\n  }, {\n    key: \"stencilStateComposer\",\n    get: function get() {\n      return this._stencilStateComposer;\n    }\n    // Textures\n    /**\n     * Clears the list of texture accessible through engine.\n     * This can help preventing texture load conflict due to name collision.\n     */\n  }, {\n    key: \"clearInternalTexturesCache\",\n    value: function clearInternalTexturesCache() {\n      this._internalTexturesCache.length = 0;\n    }\n    /**\n     * Force the entire cache to be cleared\n     * You should not have to use this function unless your engine needs to share the webGL context with another engine\n     * @param bruteForce defines a boolean to force clearing ALL caches (including stencil, detoh and alpha states)\n     */\n  }, {\n    key: \"wipeCaches\",\n    value: function wipeCaches(bruteForce) {\n      if (this.preventCacheWipeBetweenFrames && !bruteForce) {\n        return;\n      }\n      this._currentEffect = null;\n      this._viewportCached.x = 0;\n      this._viewportCached.y = 0;\n      this._viewportCached.z = 0;\n      this._viewportCached.w = 0;\n      // Done before in case we clean the attributes\n      this._unbindVertexArrayObject();\n      if (bruteForce) {\n        this._currentProgram = null;\n        this.resetTextureCache();\n        this._stencilStateComposer.reset();\n        this._depthCullingState.reset();\n        this._depthCullingState.depthFunc = this._gl.LEQUAL;\n        this._alphaState.reset();\n        this._alphaMode = 1;\n        this._alphaEquation = 0;\n        this._colorWrite = true;\n        this._colorWriteChanged = true;\n        this._unpackFlipYCached = null;\n        this._gl.pixelStorei(this._gl.UNPACK_COLORSPACE_CONVERSION_WEBGL, this._gl.NONE);\n        this._gl.pixelStorei(this._gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, 0);\n        this._mustWipeVertexAttributes = true;\n        this.unbindAllAttributes();\n      }\n      this._resetVertexBufferBinding();\n      this._cachedIndexBuffer = null;\n      this._cachedEffectForVertexBuffers = null;\n      this.bindIndexBuffer(null);\n    }\n    /**\n     * @internal\n     */\n  }, {\n    key: \"_getSamplingParameters\",\n    value: function _getSamplingParameters(samplingMode, generateMipMaps) {\n      var gl = this._gl;\n      var magFilter = gl.NEAREST;\n      var minFilter = gl.NEAREST;\n      switch (samplingMode) {\n        case 11:\n          magFilter = gl.LINEAR;\n          if (generateMipMaps) {\n            minFilter = gl.LINEAR_MIPMAP_NEAREST;\n          } else {\n            minFilter = gl.LINEAR;\n          }\n          break;\n        case 3:\n          magFilter = gl.LINEAR;\n          if (generateMipMaps) {\n            minFilter = gl.LINEAR_MIPMAP_LINEAR;\n          } else {\n            minFilter = gl.LINEAR;\n          }\n          break;\n        case 8:\n          magFilter = gl.NEAREST;\n          if (generateMipMaps) {\n            minFilter = gl.NEAREST_MIPMAP_LINEAR;\n          } else {\n            minFilter = gl.NEAREST;\n          }\n          break;\n        case 4:\n          magFilter = gl.NEAREST;\n          if (generateMipMaps) {\n            minFilter = gl.NEAREST_MIPMAP_NEAREST;\n          } else {\n            minFilter = gl.NEAREST;\n          }\n          break;\n        case 5:\n          magFilter = gl.NEAREST;\n          if (generateMipMaps) {\n            minFilter = gl.LINEAR_MIPMAP_NEAREST;\n          } else {\n            minFilter = gl.LINEAR;\n          }\n          break;\n        case 6:\n          magFilter = gl.NEAREST;\n          if (generateMipMaps) {\n            minFilter = gl.LINEAR_MIPMAP_LINEAR;\n          } else {\n            minFilter = gl.LINEAR;\n          }\n          break;\n        case 7:\n          magFilter = gl.NEAREST;\n          minFilter = gl.LINEAR;\n          break;\n        case 1:\n          magFilter = gl.NEAREST;\n          minFilter = gl.NEAREST;\n          break;\n        case 9:\n          magFilter = gl.LINEAR;\n          if (generateMipMaps) {\n            minFilter = gl.NEAREST_MIPMAP_NEAREST;\n          } else {\n            minFilter = gl.NEAREST;\n          }\n          break;\n        case 10:\n          magFilter = gl.LINEAR;\n          if (generateMipMaps) {\n            minFilter = gl.NEAREST_MIPMAP_LINEAR;\n          } else {\n            minFilter = gl.NEAREST;\n          }\n          break;\n        case 2:\n          magFilter = gl.LINEAR;\n          minFilter = gl.LINEAR;\n          break;\n        case 12:\n          magFilter = gl.LINEAR;\n          minFilter = gl.NEAREST;\n          break;\n      }\n      return {\n        min: minFilter,\n        mag: magFilter\n      };\n    }\n    /** @internal */\n  }, {\n    key: \"_createTexture\",\n    value: function _createTexture() {\n      var texture = this._gl.createTexture();\n      if (!texture) {\n        throw new Error(\"Unable to create texture\");\n      }\n      return texture;\n    }\n    /** @internal */\n  }, {\n    key: \"_createHardwareTexture\",\n    value: function _createHardwareTexture() {\n      return new WebGLHardwareTexture(this._createTexture(), this._gl);\n    }\n    /**\n     * Creates an internal texture without binding it to a framebuffer\n     * @internal\n     * @param size defines the size of the texture\n     * @param options defines the options used to create the texture\n     * @param delayGPUTextureCreation true to delay the texture creation the first time it is really needed. false to create it right away\n     * @param source source type of the texture\n     * @returns a new internal texture\n     */\n  }, {\n    key: \"_createInternalTexture\",\n    value: function _createInternalTexture(size, options) {\n      var delayGPUTextureCreation = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n      var source = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : InternalTextureSource.Unknown;\n      var _a;\n      var generateMipMaps = false;\n      var type = 0;\n      var samplingMode = 3;\n      var format = 5;\n      var useSRGBBuffer = false;\n      var samples = 1;\n      var label;\n      if (options !== undefined && typeof options === \"object\") {\n        generateMipMaps = !!options.generateMipMaps;\n        type = options.type === undefined ? 0 : options.type;\n        samplingMode = options.samplingMode === undefined ? 3 : options.samplingMode;\n        format = options.format === undefined ? 5 : options.format;\n        useSRGBBuffer = options.useSRGBBuffer === undefined ? false : options.useSRGBBuffer;\n        samples = (_a = options.samples) !== null && _a !== void 0 ? _a : 1;\n        label = options.label;\n      } else {\n        generateMipMaps = !!options;\n      }\n      useSRGBBuffer && (useSRGBBuffer = this._caps.supportSRGBBuffers && (this.webGLVersion > 1 || this.isWebGPU));\n      if (type === 1 && !this._caps.textureFloatLinearFiltering) {\n        // if floating point linear (gl.FLOAT) then force to NEAREST_SAMPLINGMODE\n        samplingMode = 1;\n      } else if (type === 2 && !this._caps.textureHalfFloatLinearFiltering) {\n        // if floating point linear (HALF_FLOAT) then force to NEAREST_SAMPLINGMODE\n        samplingMode = 1;\n      }\n      if (type === 1 && !this._caps.textureFloat) {\n        type = 0;\n        Logger.Warn(\"Float textures are not supported. Type forced to TEXTURETYPE_UNSIGNED_BYTE\");\n      }\n      var gl = this._gl;\n      var texture = new InternalTexture(this, source);\n      var width = size.width || size;\n      var height = size.height || size;\n      var layers = size.layers || 0;\n      var filters = this._getSamplingParameters(samplingMode, generateMipMaps);\n      var target = layers !== 0 ? gl.TEXTURE_2D_ARRAY : gl.TEXTURE_2D;\n      var sizedFormat = this._getRGBABufferInternalSizedFormat(type, format, useSRGBBuffer);\n      var internalFormat = this._getInternalFormat(format);\n      var textureType = this._getWebGLTextureType(type);\n      // Bind\n      this._bindTextureDirectly(target, texture);\n      if (layers !== 0) {\n        texture.is2DArray = true;\n        gl.texImage3D(target, 0, sizedFormat, width, height, layers, 0, internalFormat, textureType, null);\n      } else {\n        gl.texImage2D(target, 0, sizedFormat, width, height, 0, internalFormat, textureType, null);\n      }\n      gl.texParameteri(target, gl.TEXTURE_MAG_FILTER, filters.mag);\n      gl.texParameteri(target, gl.TEXTURE_MIN_FILTER, filters.min);\n      gl.texParameteri(target, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n      gl.texParameteri(target, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n      // MipMaps\n      if (generateMipMaps) {\n        this._gl.generateMipmap(target);\n      }\n      this._bindTextureDirectly(target, null);\n      texture._useSRGBBuffer = useSRGBBuffer;\n      texture.baseWidth = width;\n      texture.baseHeight = height;\n      texture.width = width;\n      texture.height = height;\n      texture.depth = layers;\n      texture.isReady = true;\n      texture.samples = samples;\n      texture.generateMipMaps = generateMipMaps;\n      texture.samplingMode = samplingMode;\n      texture.type = type;\n      texture.format = format;\n      texture.label = label;\n      this._internalTexturesCache.push(texture);\n      return texture;\n    }\n    /**\n     * @internal\n     */\n  }, {\n    key: \"_getUseSRGBBuffer\",\n    value: function _getUseSRGBBuffer(useSRGBBuffer, noMipmap) {\n      // Generating mipmaps for sRGB textures is not supported in WebGL1 so we must disable the support if mipmaps is enabled\n      return useSRGBBuffer && this._caps.supportSRGBBuffers && (this.webGLVersion > 1 || this.isWebGPU || noMipmap);\n    }\n  }, {\n    key: \"_createTextureBase\",\n    value: function _createTextureBase(url, noMipmap, invertY, scene) {\n      var _this4 = this;\n      var samplingMode = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 3;\n      var onLoad = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : null;\n      var onError = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : null;\n      var prepareTexture = arguments.length > 7 ? arguments[7] : undefined;\n      var prepareTextureProcessFunction = arguments.length > 8 ? arguments[8] : undefined;\n      var buffer = arguments.length > 9 && arguments[9] !== undefined ? arguments[9] : null;\n      var fallback = arguments.length > 10 && arguments[10] !== undefined ? arguments[10] : null;\n      var format = arguments.length > 11 && arguments[11] !== undefined ? arguments[11] : null;\n      var forcedExtension = arguments.length > 12 && arguments[12] !== undefined ? arguments[12] : null;\n      var mimeType = arguments.length > 13 ? arguments[13] : undefined;\n      var loaderOptions = arguments.length > 14 ? arguments[14] : undefined;\n      var useSRGBBuffer = arguments.length > 15 ? arguments[15] : undefined;\n      url = url || \"\";\n      var fromData = url.substr(0, 5) === \"data:\";\n      var fromBlob = url.substr(0, 5) === \"blob:\";\n      var isBase64 = fromData && url.indexOf(\";base64,\") !== -1;\n      var texture = fallback ? fallback : new InternalTexture(this, InternalTextureSource.Url);\n      if (texture !== fallback) {\n        texture.label = url.substring(0, 60); // default label, can be overriden by the caller\n      }\n\n      var originalUrl = url;\n      if (this._transformTextureUrl && !isBase64 && !fallback && !buffer) {\n        url = this._transformTextureUrl(url);\n      }\n      if (originalUrl !== url) {\n        texture._originalUrl = originalUrl;\n      }\n      // establish the file extension, if possible\n      var lastDot = url.lastIndexOf(\".\");\n      var extension = forcedExtension ? forcedExtension : lastDot > -1 ? url.substring(lastDot).toLowerCase() : \"\";\n      var loader = null;\n      // Remove query string\n      var queryStringIndex = extension.indexOf(\"?\");\n      if (queryStringIndex > -1) {\n        extension = extension.split(\"?\")[0];\n      }\n      var _iterator7 = _createForOfIteratorHelper(ThinEngine._TextureLoaders),\n        _step7;\n      try {\n        for (_iterator7.s(); !(_step7 = _iterator7.n()).done;) {\n          var availableLoader = _step7.value;\n          if (availableLoader.canLoad(extension, mimeType)) {\n            loader = availableLoader;\n            break;\n          }\n        }\n      } catch (err) {\n        _iterator7.e(err);\n      } finally {\n        _iterator7.f();\n      }\n      if (scene) {\n        scene.addPendingData(texture);\n      }\n      texture.url = url;\n      texture.generateMipMaps = !noMipmap;\n      texture.samplingMode = samplingMode;\n      texture.invertY = invertY;\n      texture._useSRGBBuffer = this._getUseSRGBBuffer(!!useSRGBBuffer, noMipmap);\n      if (!this._doNotHandleContextLost) {\n        // Keep a link to the buffer only if we plan to handle context lost\n        texture._buffer = buffer;\n      }\n      var onLoadObserver = null;\n      if (onLoad && !fallback) {\n        onLoadObserver = texture.onLoadedObservable.add(onLoad);\n      }\n      if (!fallback) {\n        this._internalTexturesCache.push(texture);\n      }\n      var onInternalError = function onInternalError(message, exception) {\n        if (scene) {\n          scene.removePendingData(texture);\n        }\n        if (url === originalUrl) {\n          if (onLoadObserver) {\n            texture.onLoadedObservable.remove(onLoadObserver);\n          }\n          if (EngineStore.UseFallbackTexture) {\n            _this4._createTextureBase(EngineStore.FallbackTexture, noMipmap, texture.invertY, scene, samplingMode, null, onError, prepareTexture, prepareTextureProcessFunction, buffer, texture);\n          }\n          message = (message || \"Unknown error\") + (EngineStore.UseFallbackTexture ? \" - Fallback texture was used\" : \"\");\n          texture.onErrorObservable.notifyObservers({\n            message: message,\n            exception: exception\n          });\n          if (onError) {\n            onError(message, exception);\n          }\n        } else {\n          // fall back to the original url if the transformed url fails to load\n          Logger.Warn(\"Failed to load \".concat(url, \", falling back to \").concat(originalUrl));\n          _this4._createTextureBase(originalUrl, noMipmap, texture.invertY, scene, samplingMode, onLoad, onError, prepareTexture, prepareTextureProcessFunction, buffer, texture, format, forcedExtension, mimeType, loaderOptions, useSRGBBuffer);\n        }\n      };\n      // processing for non-image formats\n      if (loader) {\n        var callback = function callback(data) {\n          loader.loadData(data, texture, function (width, height, loadMipmap, isCompressed, done, loadFailed) {\n            if (loadFailed) {\n              onInternalError(\"TextureLoader failed to load data\");\n            } else {\n              prepareTexture(texture, extension, scene, {\n                width: width,\n                height: height\n              }, texture.invertY, !loadMipmap, isCompressed, function () {\n                done();\n                return false;\n              }, samplingMode);\n            }\n          }, loaderOptions);\n        };\n        if (!buffer) {\n          this._loadFile(url, function (data) {\n            return callback(new Uint8Array(data));\n          }, undefined, scene ? scene.offlineProvider : undefined, true, function (request, exception) {\n            onInternalError(\"Unable to load \" + (request ? request.responseURL : url, exception));\n          });\n        } else {\n          if (buffer instanceof ArrayBuffer) {\n            callback(new Uint8Array(buffer));\n          } else if (ArrayBuffer.isView(buffer)) {\n            callback(buffer);\n          } else {\n            if (onError) {\n              onError(\"Unable to load: only ArrayBuffer or ArrayBufferView is supported\", null);\n            }\n          }\n        }\n      } else {\n        var onload = function onload(img) {\n          if (fromBlob && !_this4._doNotHandleContextLost) {\n            // We need to store the image if we need to rebuild the texture\n            // in case of a webgl context lost\n            texture._buffer = img;\n          }\n          prepareTexture(texture, extension, scene, img, texture.invertY, noMipmap, false, prepareTextureProcessFunction, samplingMode);\n        };\n        // According to the WebGL spec section 6.10, ImageBitmaps must be inverted on creation.\n        // So, we pass imageOrientation to _FileToolsLoadImage() as it may create an ImageBitmap.\n        if (!fromData || isBase64) {\n          if (buffer && (typeof buffer.decoding === \"string\" || buffer.close)) {\n            onload(buffer);\n          } else {\n            ThinEngine._FileToolsLoadImage(url, onload, onInternalError, scene ? scene.offlineProvider : null, mimeType, texture.invertY && this._features.needsInvertingBitmap ? {\n              imageOrientation: \"flipY\"\n            } : undefined);\n          }\n        } else if (typeof buffer === \"string\" || buffer instanceof ArrayBuffer || ArrayBuffer.isView(buffer) || buffer instanceof Blob) {\n          ThinEngine._FileToolsLoadImage(buffer, onload, onInternalError, scene ? scene.offlineProvider : null, mimeType, texture.invertY && this._features.needsInvertingBitmap ? {\n            imageOrientation: \"flipY\"\n          } : undefined);\n        } else if (buffer) {\n          onload(buffer);\n        }\n      }\n      return texture;\n    }\n    /**\n     * Usually called from Texture.ts.\n     * Passed information to create a WebGLTexture\n     * @param url defines a value which contains one of the following:\n     * * A conventional http URL, e.g. 'http://...' or 'file://...'\n     * * A base64 string of in-line texture data, e.g. 'data:image/jpg;base64,/...'\n     * * An indicator that data being passed using the buffer parameter, e.g. 'data:mytexture.jpg'\n     * @param noMipmap defines a boolean indicating that no mipmaps shall be generated.  Ignored for compressed textures.  They must be in the file\n     * @param invertY when true, image is flipped when loaded.  You probably want true. Certain compressed textures may invert this if their default is inverted (eg. ktx)\n     * @param scene needed for loading to the correct scene\n     * @param samplingMode mode with should be used sample / access the texture (Default: Texture.TRILINEAR_SAMPLINGMODE)\n     * @param onLoad optional callback to be called upon successful completion\n     * @param onError optional callback to be called upon failure\n     * @param buffer a source of a file previously fetched as either a base64 string, an ArrayBuffer (compressed or image format), HTMLImageElement (image format), or a Blob\n     * @param fallback an internal argument in case the function must be called again, due to etc1 not having alpha capabilities\n     * @param format internal format.  Default: RGB when extension is '.jpg' else RGBA.  Ignored for compressed textures\n     * @param forcedExtension defines the extension to use to pick the right loader\n     * @param mimeType defines an optional mime type\n     * @param loaderOptions options to be passed to the loader\n     * @param creationFlags specific flags to use when creating the texture (1 for storage textures, for eg)\n     * @param useSRGBBuffer defines if the texture must be loaded in a sRGB GPU buffer (if supported by the GPU).\n     * @returns a InternalTexture for assignment back into BABYLON.Texture\n     */\n  }, {\n    key: \"createTexture\",\n    value: function createTexture(url, noMipmap, invertY, scene) {\n      var _this5 = this;\n      var samplingMode = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 3;\n      var onLoad = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : null;\n      var onError = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : null;\n      var buffer = arguments.length > 7 && arguments[7] !== undefined ? arguments[7] : null;\n      var fallback = arguments.length > 8 && arguments[8] !== undefined ? arguments[8] : null;\n      var format = arguments.length > 9 && arguments[9] !== undefined ? arguments[9] : null;\n      var forcedExtension = arguments.length > 10 && arguments[10] !== undefined ? arguments[10] : null;\n      var mimeType = arguments.length > 11 ? arguments[11] : undefined;\n      var loaderOptions = arguments.length > 12 ? arguments[12] : undefined;\n      var creationFlags = arguments.length > 13 ? arguments[13] : undefined;\n      var useSRGBBuffer = arguments.length > 14 ? arguments[14] : undefined;\n      return this._createTextureBase(url, noMipmap, invertY, scene, samplingMode, onLoad, onError, this._prepareWebGLTexture.bind(this), function (potWidth, potHeight, img, extension, texture, continuationCallback) {\n        var gl = _this5._gl;\n        var isPot = img.width === potWidth && img.height === potHeight;\n        var internalFormat = format ? _this5._getInternalFormat(format, texture._useSRGBBuffer) : extension === \".jpg\" && !texture._useSRGBBuffer ? gl.RGB : texture._useSRGBBuffer ? _this5._glSRGBExtensionValues.SRGB8_ALPHA8 : gl.RGBA;\n        var texelFormat = format ? _this5._getInternalFormat(format) : extension === \".jpg\" && !texture._useSRGBBuffer ? gl.RGB : gl.RGBA;\n        if (texture._useSRGBBuffer && _this5.webGLVersion === 1) {\n          texelFormat = internalFormat;\n        }\n        if (isPot) {\n          gl.texImage2D(gl.TEXTURE_2D, 0, internalFormat, texelFormat, gl.UNSIGNED_BYTE, img);\n          return false;\n        }\n        var maxTextureSize = _this5._caps.maxTextureSize;\n        if (img.width > maxTextureSize || img.height > maxTextureSize || !_this5._supportsHardwareTextureRescaling) {\n          _this5._prepareWorkingCanvas();\n          if (!_this5._workingCanvas || !_this5._workingContext) {\n            return false;\n          }\n          _this5._workingCanvas.width = potWidth;\n          _this5._workingCanvas.height = potHeight;\n          _this5._workingContext.drawImage(img, 0, 0, img.width, img.height, 0, 0, potWidth, potHeight);\n          gl.texImage2D(gl.TEXTURE_2D, 0, internalFormat, texelFormat, gl.UNSIGNED_BYTE, _this5._workingCanvas);\n          texture.width = potWidth;\n          texture.height = potHeight;\n          return false;\n        } else {\n          // Using shaders when possible to rescale because canvas.drawImage is lossy\n          var source = new InternalTexture(_this5, InternalTextureSource.Temp);\n          _this5._bindTextureDirectly(gl.TEXTURE_2D, source, true);\n          gl.texImage2D(gl.TEXTURE_2D, 0, internalFormat, texelFormat, gl.UNSIGNED_BYTE, img);\n          _this5._rescaleTexture(source, texture, scene, internalFormat, function () {\n            _this5._releaseTexture(source);\n            _this5._bindTextureDirectly(gl.TEXTURE_2D, texture, true);\n            continuationCallback();\n          });\n        }\n        return true;\n      }, buffer, fallback, format, forcedExtension, mimeType, loaderOptions, useSRGBBuffer);\n    }\n    /**\n     * Loads an image as an HTMLImageElement.\n     * @param input url string, ArrayBuffer, or Blob to load\n     * @param onLoad callback called when the image successfully loads\n     * @param onError callback called when the image fails to load\n     * @param offlineProvider offline provider for caching\n     * @param mimeType optional mime type\n     * @param imageBitmapOptions optional the options to use when creating an ImageBitmap\n     * @returns the HTMLImageElement of the loaded image\n     * @internal\n     */\n  }, {\n    key: \"_rescaleTexture\",\n    value:\n    /**\n     * @internal\n     */\n    function _rescaleTexture(source, destination, scene, internalFormat, onComplete) {}\n    /**\n     * Creates a raw texture\n     * @param data defines the data to store in the texture\n     * @param width defines the width of the texture\n     * @param height defines the height of the texture\n     * @param format defines the format of the data\n     * @param generateMipMaps defines if the engine should generate the mip levels\n     * @param invertY defines if data must be stored with Y axis inverted\n     * @param samplingMode defines the required sampling mode (Texture.NEAREST_SAMPLINGMODE by default)\n     * @param compression defines the compression used (null by default)\n     * @param type defines the type fo the data (Engine.TEXTURETYPE_UNSIGNED_INT by default)\n     * @param creationFlags specific flags to use when creating the texture (1 for storage textures, for eg)\n     * @param useSRGBBuffer defines if the texture must be loaded in a sRGB GPU buffer (if supported by the GPU).\n     * @returns the raw texture inside an InternalTexture\n     */\n  }, {\n    key: \"createRawTexture\",\n    value: function createRawTexture(data, width, height, format, generateMipMaps, invertY, samplingMode) {\n      var compression = arguments.length > 7 && arguments[7] !== undefined ? arguments[7] : null;\n      var type = arguments.length > 8 && arguments[8] !== undefined ? arguments[8] : 0;\n      var creationFlags = arguments.length > 9 && arguments[9] !== undefined ? arguments[9] : 0;\n      var useSRGBBuffer = arguments.length > 10 && arguments[10] !== undefined ? arguments[10] : false;\n      throw _WarnImport(\"Engine.RawTexture\");\n    }\n    /**\n     * Creates a new raw cube texture\n     * @param data defines the array of data to use to create each face\n     * @param size defines the size of the textures\n     * @param format defines the format of the data\n     * @param type defines the type of the data (like Engine.TEXTURETYPE_UNSIGNED_INT)\n     * @param generateMipMaps  defines if the engine should generate the mip levels\n     * @param invertY defines if data must be stored with Y axis inverted\n     * @param samplingMode defines the required sampling mode (like Texture.NEAREST_SAMPLINGMODE)\n     * @param compression defines the compression used (null by default)\n     * @returns the cube texture as an InternalTexture\n     */\n  }, {\n    key: \"createRawCubeTexture\",\n    value: function createRawCubeTexture(data, size, format, type, generateMipMaps, invertY, samplingMode) {\n      var compression = arguments.length > 7 && arguments[7] !== undefined ? arguments[7] : null;\n      throw _WarnImport(\"Engine.RawTexture\");\n    }\n    /**\n     * Creates a new raw 3D texture\n     * @param data defines the data used to create the texture\n     * @param width defines the width of the texture\n     * @param height defines the height of the texture\n     * @param depth defines the depth of the texture\n     * @param format defines the format of the texture\n     * @param generateMipMaps defines if the engine must generate mip levels\n     * @param invertY defines if data must be stored with Y axis inverted\n     * @param samplingMode defines the required sampling mode (like Texture.NEAREST_SAMPLINGMODE)\n     * @param compression defines the compressed used (can be null)\n     * @param textureType defines the compressed used (can be null)\n     * @returns a new raw 3D texture (stored in an InternalTexture)\n     */\n  }, {\n    key: \"createRawTexture3D\",\n    value: function createRawTexture3D(data, width, height, depth, format, generateMipMaps, invertY, samplingMode) {\n      var compression = arguments.length > 8 && arguments[8] !== undefined ? arguments[8] : null;\n      var textureType = arguments.length > 9 && arguments[9] !== undefined ? arguments[9] : 0;\n      throw _WarnImport(\"Engine.RawTexture\");\n    }\n    /**\n     * Creates a new raw 2D array texture\n     * @param data defines the data used to create the texture\n     * @param width defines the width of the texture\n     * @param height defines the height of the texture\n     * @param depth defines the number of layers of the texture\n     * @param format defines the format of the texture\n     * @param generateMipMaps defines if the engine must generate mip levels\n     * @param invertY defines if data must be stored with Y axis inverted\n     * @param samplingMode defines the required sampling mode (like Texture.NEAREST_SAMPLINGMODE)\n     * @param compression defines the compressed used (can be null)\n     * @param textureType defines the compressed used (can be null)\n     * @returns a new raw 2D array texture (stored in an InternalTexture)\n     */\n  }, {\n    key: \"createRawTexture2DArray\",\n    value: function createRawTexture2DArray(data, width, height, depth, format, generateMipMaps, invertY, samplingMode) {\n      var compression = arguments.length > 8 && arguments[8] !== undefined ? arguments[8] : null;\n      var textureType = arguments.length > 9 && arguments[9] !== undefined ? arguments[9] : 0;\n      throw _WarnImport(\"Engine.RawTexture\");\n    }\n    /**\n     * @internal\n     */\n  }, {\n    key: \"_unpackFlipY\",\n    value: function _unpackFlipY(value) {\n      if (this._unpackFlipYCached !== value) {\n        this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL, value ? 1 : 0);\n        if (this.enableUnpackFlipYCached) {\n          this._unpackFlipYCached = value;\n        }\n      }\n    }\n    /** @internal */\n  }, {\n    key: \"_getUnpackAlignement\",\n    value: function _getUnpackAlignement() {\n      return this._gl.getParameter(this._gl.UNPACK_ALIGNMENT);\n    }\n  }, {\n    key: \"_getTextureTarget\",\n    value: function _getTextureTarget(texture) {\n      if (texture.isCube) {\n        return this._gl.TEXTURE_CUBE_MAP;\n      } else if (texture.is3D) {\n        return this._gl.TEXTURE_3D;\n      } else if (texture.is2DArray || texture.isMultiview) {\n        return this._gl.TEXTURE_2D_ARRAY;\n      }\n      return this._gl.TEXTURE_2D;\n    }\n    /**\n     * Update the sampling mode of a given texture\n     * @param samplingMode defines the required sampling mode\n     * @param texture defines the texture to update\n     * @param generateMipMaps defines whether to generate mipmaps for the texture\n     */\n  }, {\n    key: \"updateTextureSamplingMode\",\n    value: function updateTextureSamplingMode(samplingMode, texture) {\n      var generateMipMaps = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n      var target = this._getTextureTarget(texture);\n      var filters = this._getSamplingParameters(samplingMode, texture.useMipMaps || generateMipMaps);\n      this._setTextureParameterInteger(target, this._gl.TEXTURE_MAG_FILTER, filters.mag, texture);\n      this._setTextureParameterInteger(target, this._gl.TEXTURE_MIN_FILTER, filters.min);\n      if (generateMipMaps) {\n        texture.generateMipMaps = true;\n        this._gl.generateMipmap(target);\n      }\n      this._bindTextureDirectly(target, null);\n      texture.samplingMode = samplingMode;\n    }\n    /**\n     * Update the dimensions of a texture\n     * @param texture texture to update\n     * @param width new width of the texture\n     * @param height new height of the texture\n     * @param depth new depth of the texture\n     */\n  }, {\n    key: \"updateTextureDimensions\",\n    value: function updateTextureDimensions(texture, width, height) {\n      var depth = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 1;\n    }\n    /**\n     * Update the sampling mode of a given texture\n     * @param texture defines the texture to update\n     * @param wrapU defines the texture wrap mode of the u coordinates\n     * @param wrapV defines the texture wrap mode of the v coordinates\n     * @param wrapR defines the texture wrap mode of the r coordinates\n     */\n  }, {\n    key: \"updateTextureWrappingMode\",\n    value: function updateTextureWrappingMode(texture, wrapU) {\n      var wrapV = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n      var wrapR = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;\n      var target = this._getTextureTarget(texture);\n      if (wrapU !== null) {\n        this._setTextureParameterInteger(target, this._gl.TEXTURE_WRAP_S, this._getTextureWrapMode(wrapU), texture);\n        texture._cachedWrapU = wrapU;\n      }\n      if (wrapV !== null) {\n        this._setTextureParameterInteger(target, this._gl.TEXTURE_WRAP_T, this._getTextureWrapMode(wrapV), texture);\n        texture._cachedWrapV = wrapV;\n      }\n      if ((texture.is2DArray || texture.is3D) && wrapR !== null) {\n        this._setTextureParameterInteger(target, this._gl.TEXTURE_WRAP_R, this._getTextureWrapMode(wrapR), texture);\n        texture._cachedWrapR = wrapR;\n      }\n      this._bindTextureDirectly(target, null);\n    }\n    /**\n     * @internal\n     */\n  }, {\n    key: \"_setupDepthStencilTexture\",\n    value: function _setupDepthStencilTexture(internalTexture, size, generateStencil, bilinearFiltering, comparisonFunction) {\n      var samples = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : 1;\n      var width = size.width || size;\n      var height = size.height || size;\n      var layers = size.layers || 0;\n      internalTexture.baseWidth = width;\n      internalTexture.baseHeight = height;\n      internalTexture.width = width;\n      internalTexture.height = height;\n      internalTexture.is2DArray = layers > 0;\n      internalTexture.depth = layers;\n      internalTexture.isReady = true;\n      internalTexture.samples = samples;\n      internalTexture.generateMipMaps = false;\n      internalTexture.samplingMode = bilinearFiltering ? 2 : 1;\n      internalTexture.type = 0;\n      internalTexture._comparisonFunction = comparisonFunction;\n      var gl = this._gl;\n      var target = this._getTextureTarget(internalTexture);\n      var samplingParameters = this._getSamplingParameters(internalTexture.samplingMode, false);\n      gl.texParameteri(target, gl.TEXTURE_MAG_FILTER, samplingParameters.mag);\n      gl.texParameteri(target, gl.TEXTURE_MIN_FILTER, samplingParameters.min);\n      gl.texParameteri(target, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n      gl.texParameteri(target, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n      // TEXTURE_COMPARE_FUNC/MODE are only availble in WebGL2.\n      if (this.webGLVersion > 1) {\n        if (comparisonFunction === 0) {\n          gl.texParameteri(target, gl.TEXTURE_COMPARE_FUNC, 515);\n          gl.texParameteri(target, gl.TEXTURE_COMPARE_MODE, gl.NONE);\n        } else {\n          gl.texParameteri(target, gl.TEXTURE_COMPARE_FUNC, comparisonFunction);\n          gl.texParameteri(target, gl.TEXTURE_COMPARE_MODE, gl.COMPARE_REF_TO_TEXTURE);\n        }\n      }\n    }\n    /**\n     * @internal\n     */\n  }, {\n    key: \"_uploadCompressedDataToTextureDirectly\",\n    value: function _uploadCompressedDataToTextureDirectly(texture, internalFormat, width, height, data) {\n      var faceIndex = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : 0;\n      var lod = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : 0;\n      var gl = this._gl;\n      var target = gl.TEXTURE_2D;\n      if (texture.isCube) {\n        target = gl.TEXTURE_CUBE_MAP_POSITIVE_X + faceIndex;\n      }\n      if (texture._useSRGBBuffer) {\n        switch (internalFormat) {\n          case 37492:\n          case 36196:\n            // Note, if using ETC1 and sRGB is requested, this will use ETC2 if available.\n            if (this._caps.etc2) {\n              internalFormat = gl.COMPRESSED_SRGB8_ETC2;\n            } else {\n              texture._useSRGBBuffer = false;\n            }\n            break;\n          case 37496:\n            if (this._caps.etc2) {\n              internalFormat = gl.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC;\n            } else {\n              texture._useSRGBBuffer = false;\n            }\n            break;\n          case 36492:\n            internalFormat = gl.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT;\n            break;\n          case 37808:\n            internalFormat = gl.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR;\n            break;\n          case 33776:\n            if (this._caps.s3tc_srgb) {\n              internalFormat = gl.COMPRESSED_SRGB_S3TC_DXT1_EXT;\n            } else {\n              // S3TC sRGB extension not supported\n              texture._useSRGBBuffer = false;\n            }\n            break;\n          case 33777:\n            if (this._caps.s3tc_srgb) {\n              internalFormat = gl.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;\n            } else {\n              // S3TC sRGB extension not supported\n              texture._useSRGBBuffer = false;\n            }\n            break;\n          case 33779:\n            if (this._caps.s3tc_srgb) {\n              internalFormat = gl.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT;\n            } else {\n              // S3TC sRGB extension not supported\n              texture._useSRGBBuffer = false;\n            }\n            break;\n          default:\n            // We don't support a sRGB format corresponding to internalFormat, so revert to non sRGB format\n            texture._useSRGBBuffer = false;\n            break;\n        }\n      }\n      this._gl.compressedTexImage2D(target, lod, internalFormat, width, height, 0, data);\n    }\n    /**\n     * @internal\n     */\n  }, {\n    key: \"_uploadDataToTextureDirectly\",\n    value: function _uploadDataToTextureDirectly(texture, imageData) {\n      var faceIndex = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n      var lod = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n      var babylonInternalFormat = arguments.length > 4 ? arguments[4] : undefined;\n      var useTextureWidthAndHeight = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : false;\n      var gl = this._gl;\n      var textureType = this._getWebGLTextureType(texture.type);\n      var format = this._getInternalFormat(texture.format);\n      var internalFormat = babylonInternalFormat === undefined ? this._getRGBABufferInternalSizedFormat(texture.type, texture.format, texture._useSRGBBuffer) : this._getInternalFormat(babylonInternalFormat, texture._useSRGBBuffer);\n      this._unpackFlipY(texture.invertY);\n      var target = gl.TEXTURE_2D;\n      if (texture.isCube) {\n        target = gl.TEXTURE_CUBE_MAP_POSITIVE_X + faceIndex;\n      }\n      var lodMaxWidth = Math.round(Math.log(texture.width) * Math.LOG2E);\n      var lodMaxHeight = Math.round(Math.log(texture.height) * Math.LOG2E);\n      var width = useTextureWidthAndHeight ? texture.width : Math.pow(2, Math.max(lodMaxWidth - lod, 0));\n      var height = useTextureWidthAndHeight ? texture.height : Math.pow(2, Math.max(lodMaxHeight - lod, 0));\n      gl.texImage2D(target, lod, internalFormat, width, height, 0, format, textureType, imageData);\n    }\n    /**\n     * Update a portion of an internal texture\n     * @param texture defines the texture to update\n     * @param imageData defines the data to store into the texture\n     * @param xOffset defines the x coordinates of the update rectangle\n     * @param yOffset defines the y coordinates of the update rectangle\n     * @param width defines the width of the update rectangle\n     * @param height defines the height of the update rectangle\n     * @param faceIndex defines the face index if texture is a cube (0 by default)\n     * @param lod defines the lod level to update (0 by default)\n     * @param generateMipMaps defines whether to generate mipmaps or not\n     */\n  }, {\n    key: \"updateTextureData\",\n    value: function updateTextureData(texture, imageData, xOffset, yOffset, width, height) {\n      var faceIndex = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : 0;\n      var lod = arguments.length > 7 && arguments[7] !== undefined ? arguments[7] : 0;\n      var generateMipMaps = arguments.length > 8 && arguments[8] !== undefined ? arguments[8] : false;\n      var gl = this._gl;\n      var textureType = this._getWebGLTextureType(texture.type);\n      var format = this._getInternalFormat(texture.format);\n      this._unpackFlipY(texture.invertY);\n      var targetForBinding = gl.TEXTURE_2D;\n      var target = gl.TEXTURE_2D;\n      if (texture.isCube) {\n        target = gl.TEXTURE_CUBE_MAP_POSITIVE_X + faceIndex;\n        targetForBinding = gl.TEXTURE_CUBE_MAP;\n      }\n      this._bindTextureDirectly(targetForBinding, texture, true);\n      gl.texSubImage2D(target, lod, xOffset, yOffset, width, height, format, textureType, imageData);\n      if (generateMipMaps) {\n        this._gl.generateMipmap(target);\n      }\n      this._bindTextureDirectly(targetForBinding, null);\n    }\n    /**\n     * @internal\n     */\n  }, {\n    key: \"_uploadArrayBufferViewToTexture\",\n    value: function _uploadArrayBufferViewToTexture(texture, imageData) {\n      var faceIndex = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n      var lod = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n      var gl = this._gl;\n      var bindTarget = texture.isCube ? gl.TEXTURE_CUBE_MAP : gl.TEXTURE_2D;\n      this._bindTextureDirectly(bindTarget, texture, true);\n      this._uploadDataToTextureDirectly(texture, imageData, faceIndex, lod);\n      this._bindTextureDirectly(bindTarget, null, true);\n    }\n  }, {\n    key: \"_prepareWebGLTextureContinuation\",\n    value: function _prepareWebGLTextureContinuation(texture, scene, noMipmap, isCompressed, samplingMode) {\n      var gl = this._gl;\n      if (!gl) {\n        return;\n      }\n      var filters = this._getSamplingParameters(samplingMode, !noMipmap);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, filters.mag);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, filters.min);\n      if (!noMipmap && !isCompressed) {\n        gl.generateMipmap(gl.TEXTURE_2D);\n      }\n      this._bindTextureDirectly(gl.TEXTURE_2D, null);\n      // this.resetTextureCache();\n      if (scene) {\n        scene.removePendingData(texture);\n      }\n      texture.onLoadedObservable.notifyObservers(texture);\n      texture.onLoadedObservable.clear();\n    }\n  }, {\n    key: \"_prepareWebGLTexture\",\n    value: function _prepareWebGLTexture(texture, extension, scene, img, invertY, noMipmap, isCompressed, processFunction) {\n      var _this6 = this;\n      var samplingMode = arguments.length > 8 && arguments[8] !== undefined ? arguments[8] : 3;\n      var maxTextureSize = this.getCaps().maxTextureSize;\n      var potWidth = Math.min(maxTextureSize, this.needPOTTextures ? ThinEngine.GetExponentOfTwo(img.width, maxTextureSize) : img.width);\n      var potHeight = Math.min(maxTextureSize, this.needPOTTextures ? ThinEngine.GetExponentOfTwo(img.height, maxTextureSize) : img.height);\n      var gl = this._gl;\n      if (!gl) {\n        return;\n      }\n      if (!texture._hardwareTexture) {\n        //  this.resetTextureCache();\n        if (scene) {\n          scene.removePendingData(texture);\n        }\n        return;\n      }\n      this._bindTextureDirectly(gl.TEXTURE_2D, texture, true);\n      this._unpackFlipY(invertY === undefined ? true : invertY ? true : false);\n      texture.baseWidth = img.width;\n      texture.baseHeight = img.height;\n      texture.width = potWidth;\n      texture.height = potHeight;\n      texture.isReady = true;\n      if (processFunction(potWidth, potHeight, img, extension, texture, function () {\n        _this6._prepareWebGLTextureContinuation(texture, scene, noMipmap, isCompressed, samplingMode);\n      })) {\n        // Returning as texture needs extra async steps\n        return;\n      }\n      this._prepareWebGLTextureContinuation(texture, scene, noMipmap, isCompressed, samplingMode);\n    }\n    /**\n     * @internal\n     */\n  }, {\n    key: \"_setupFramebufferDepthAttachments\",\n    value: function _setupFramebufferDepthAttachments(generateStencilBuffer, generateDepthBuffer, width, height) {\n      var samples = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 1;\n      var gl = this._gl;\n      // Create the depth/stencil buffer\n      if (generateStencilBuffer && generateDepthBuffer) {\n        return this._createRenderBuffer(width, height, samples, gl.DEPTH_STENCIL, gl.DEPTH24_STENCIL8, gl.DEPTH_STENCIL_ATTACHMENT);\n      }\n      if (generateDepthBuffer) {\n        var depthFormat = gl.DEPTH_COMPONENT16;\n        if (this._webGLVersion > 1) {\n          depthFormat = gl.DEPTH_COMPONENT32F;\n        }\n        return this._createRenderBuffer(width, height, samples, depthFormat, depthFormat, gl.DEPTH_ATTACHMENT);\n      }\n      if (generateStencilBuffer) {\n        return this._createRenderBuffer(width, height, samples, gl.STENCIL_INDEX8, gl.STENCIL_INDEX8, gl.STENCIL_ATTACHMENT);\n      }\n      return null;\n    }\n    /**\n     * @internal\n     */\n  }, {\n    key: \"_createRenderBuffer\",\n    value: function _createRenderBuffer(width, height, samples, internalFormat, msInternalFormat, attachment) {\n      var unbindBuffer = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : true;\n      var gl = this._gl;\n      var renderBuffer = gl.createRenderbuffer();\n      return this._updateRenderBuffer(renderBuffer, width, height, samples, internalFormat, msInternalFormat, attachment, unbindBuffer);\n    }\n  }, {\n    key: \"_updateRenderBuffer\",\n    value: function _updateRenderBuffer(renderBuffer, width, height, samples, internalFormat, msInternalFormat, attachment) {\n      var unbindBuffer = arguments.length > 7 && arguments[7] !== undefined ? arguments[7] : true;\n      var gl = this._gl;\n      gl.bindRenderbuffer(gl.RENDERBUFFER, renderBuffer);\n      if (samples > 1 && gl.renderbufferStorageMultisample) {\n        gl.renderbufferStorageMultisample(gl.RENDERBUFFER, samples, msInternalFormat, width, height);\n      } else {\n        gl.renderbufferStorage(gl.RENDERBUFFER, internalFormat, width, height);\n      }\n      gl.framebufferRenderbuffer(gl.FRAMEBUFFER, attachment, gl.RENDERBUFFER, renderBuffer);\n      if (unbindBuffer) {\n        gl.bindRenderbuffer(gl.RENDERBUFFER, null);\n      }\n      return renderBuffer;\n    }\n    /**\n     * @internal\n     */\n  }, {\n    key: \"_releaseTexture\",\n    value: function _releaseTexture(texture) {\n      var _a;\n      this._deleteTexture((_a = texture._hardwareTexture) === null || _a === void 0 ? void 0 : _a.underlyingResource);\n      // Unbind channels\n      this.unbindAllTextures();\n      var index = this._internalTexturesCache.indexOf(texture);\n      if (index !== -1) {\n        this._internalTexturesCache.splice(index, 1);\n      }\n      // Integrated fixed lod samplers.\n      if (texture._lodTextureHigh) {\n        texture._lodTextureHigh.dispose();\n      }\n      if (texture._lodTextureMid) {\n        texture._lodTextureMid.dispose();\n      }\n      if (texture._lodTextureLow) {\n        texture._lodTextureLow.dispose();\n      }\n      // Integrated irradiance map.\n      if (texture._irradianceTexture) {\n        texture._irradianceTexture.dispose();\n      }\n    }\n    /**\n     * @internal\n     */\n  }, {\n    key: \"_releaseRenderTargetWrapper\",\n    value: function _releaseRenderTargetWrapper(rtWrapper) {\n      var index = this._renderTargetWrapperCache.indexOf(rtWrapper);\n      if (index !== -1) {\n        this._renderTargetWrapperCache.splice(index, 1);\n      }\n    }\n  }, {\n    key: \"_deleteTexture\",\n    value: function _deleteTexture(texture) {\n      if (texture) {\n        this._gl.deleteTexture(texture);\n      }\n    }\n  }, {\n    key: \"_setProgram\",\n    value: function _setProgram(program) {\n      if (this._currentProgram !== program) {\n        this._gl.useProgram(program);\n        this._currentProgram = program;\n      }\n    }\n    /**\n     * Binds an effect to the webGL context\n     * @param effect defines the effect to bind\n     */\n  }, {\n    key: \"bindSamplers\",\n    value: function bindSamplers(effect) {\n      var webGLPipelineContext = effect.getPipelineContext();\n      this._setProgram(webGLPipelineContext.program);\n      var samplers = effect.getSamplers();\n      for (var index = 0; index < samplers.length; index++) {\n        var uniform = effect.getUniform(samplers[index]);\n        if (uniform) {\n          this._boundUniforms[index] = uniform;\n        }\n      }\n      this._currentEffect = null;\n    }\n  }, {\n    key: \"_activateCurrentTexture\",\n    value: function _activateCurrentTexture() {\n      if (this._currentTextureChannel !== this._activeChannel) {\n        this._gl.activeTexture(this._gl.TEXTURE0 + this._activeChannel);\n        this._currentTextureChannel = this._activeChannel;\n      }\n    }\n    /**\n     * @internal\n     */\n  }, {\n    key: \"_bindTextureDirectly\",\n    value: function _bindTextureDirectly(target, texture) {\n      var forTextureDataUpdate = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n      var force = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n      var _a, _b;\n      var wasPreviouslyBound = false;\n      var isTextureForRendering = texture && texture._associatedChannel > -1;\n      if (forTextureDataUpdate && isTextureForRendering) {\n        this._activeChannel = texture._associatedChannel;\n      }\n      var currentTextureBound = this._boundTexturesCache[this._activeChannel];\n      if (currentTextureBound !== texture || force) {\n        this._activateCurrentTexture();\n        if (texture && texture.isMultiview) {\n          //this._gl.bindTexture(target, texture ? texture._colorTextureArray : null);\n          console.error(target, texture);\n          throw \"_bindTextureDirectly called with a multiview texture!\";\n        } else {\n          this._gl.bindTexture(target, (_b = (_a = texture === null || texture === void 0 ? void 0 : texture._hardwareTexture) === null || _a === void 0 ? void 0 : _a.underlyingResource) !== null && _b !== void 0 ? _b : null);\n        }\n        this._boundTexturesCache[this._activeChannel] = texture;\n        if (texture) {\n          texture._associatedChannel = this._activeChannel;\n        }\n      } else if (forTextureDataUpdate) {\n        wasPreviouslyBound = true;\n        this._activateCurrentTexture();\n      }\n      if (isTextureForRendering && !forTextureDataUpdate) {\n        this._bindSamplerUniformToChannel(texture._associatedChannel, this._activeChannel);\n      }\n      return wasPreviouslyBound;\n    }\n    /**\n     * @internal\n     */\n  }, {\n    key: \"_bindTexture\",\n    value: function _bindTexture(channel, texture, name) {\n      if (channel === undefined) {\n        return;\n      }\n      if (texture) {\n        texture._associatedChannel = channel;\n      }\n      this._activeChannel = channel;\n      var target = texture ? this._getTextureTarget(texture) : this._gl.TEXTURE_2D;\n      this._bindTextureDirectly(target, texture);\n    }\n    /**\n     * Unbind all textures from the webGL context\n     */\n  }, {\n    key: \"unbindAllTextures\",\n    value: function unbindAllTextures() {\n      for (var channel = 0; channel < this._maxSimultaneousTextures; channel++) {\n        this._activeChannel = channel;\n        this._bindTextureDirectly(this._gl.TEXTURE_2D, null);\n        this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP, null);\n        if (this.webGLVersion > 1) {\n          this._bindTextureDirectly(this._gl.TEXTURE_3D, null);\n          this._bindTextureDirectly(this._gl.TEXTURE_2D_ARRAY, null);\n        }\n      }\n    }\n    /**\n     * Sets a texture to the according uniform.\n     * @param channel The texture channel\n     * @param uniform The uniform to set\n     * @param texture The texture to apply\n     * @param name The name of the uniform in the effect\n     */\n  }, {\n    key: \"setTexture\",\n    value: function setTexture(channel, uniform, texture, name) {\n      if (channel === undefined) {\n        return;\n      }\n      if (uniform) {\n        this._boundUniforms[channel] = uniform;\n      }\n      this._setTexture(channel, texture);\n    }\n  }, {\n    key: \"_bindSamplerUniformToChannel\",\n    value: function _bindSamplerUniformToChannel(sourceSlot, destination) {\n      var uniform = this._boundUniforms[sourceSlot];\n      if (!uniform || uniform._currentState === destination) {\n        return;\n      }\n      this._gl.uniform1i(uniform, destination);\n      uniform._currentState = destination;\n    }\n  }, {\n    key: \"_getTextureWrapMode\",\n    value: function _getTextureWrapMode(mode) {\n      switch (mode) {\n        case 1:\n          return this._gl.REPEAT;\n        case 0:\n          return this._gl.CLAMP_TO_EDGE;\n        case 2:\n          return this._gl.MIRRORED_REPEAT;\n      }\n      return this._gl.REPEAT;\n    }\n  }, {\n    key: \"_setTexture\",\n    value: function _setTexture(channel, texture) {\n      var isPartOfTextureArray = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n      var depthStencilTexture = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n      var name = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : \"\";\n      // Not ready?\n      if (!texture) {\n        if (this._boundTexturesCache[channel] != null) {\n          this._activeChannel = channel;\n          this._bindTextureDirectly(this._gl.TEXTURE_2D, null);\n          this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP, null);\n          if (this.webGLVersion > 1) {\n            this._bindTextureDirectly(this._gl.TEXTURE_3D, null);\n            this._bindTextureDirectly(this._gl.TEXTURE_2D_ARRAY, null);\n          }\n        }\n        return false;\n      }\n      // Video\n      if (texture.video) {\n        this._activeChannel = channel;\n        var videoInternalTexture = texture.getInternalTexture();\n        if (videoInternalTexture) {\n          videoInternalTexture._associatedChannel = channel;\n        }\n        texture.update();\n      } else if (texture.delayLoadState === 4) {\n        // Delay loading\n        texture.delayLoad();\n        return false;\n      }\n      var internalTexture;\n      if (depthStencilTexture) {\n        internalTexture = texture.depthStencilTexture;\n      } else if (texture.isReady()) {\n        internalTexture = texture.getInternalTexture();\n      } else if (texture.isCube) {\n        internalTexture = this.emptyCubeTexture;\n      } else if (texture.is3D) {\n        internalTexture = this.emptyTexture3D;\n      } else if (texture.is2DArray) {\n        internalTexture = this.emptyTexture2DArray;\n      } else {\n        internalTexture = this.emptyTexture;\n      }\n      if (!isPartOfTextureArray && internalTexture) {\n        internalTexture._associatedChannel = channel;\n      }\n      var needToBind = true;\n      if (this._boundTexturesCache[channel] === internalTexture) {\n        if (!isPartOfTextureArray) {\n          this._bindSamplerUniformToChannel(internalTexture._associatedChannel, channel);\n        }\n        needToBind = false;\n      }\n      this._activeChannel = channel;\n      var target = this._getTextureTarget(internalTexture);\n      if (needToBind) {\n        this._bindTextureDirectly(target, internalTexture, isPartOfTextureArray);\n      }\n      if (internalTexture && !internalTexture.isMultiview) {\n        // CUBIC_MODE and SKYBOX_MODE both require CLAMP_TO_EDGE.  All other modes use REPEAT.\n        if (internalTexture.isCube && internalTexture._cachedCoordinatesMode !== texture.coordinatesMode) {\n          internalTexture._cachedCoordinatesMode = texture.coordinatesMode;\n          var textureWrapMode = texture.coordinatesMode !== 3 && texture.coordinatesMode !== 5 ? 1 : 0;\n          texture.wrapU = textureWrapMode;\n          texture.wrapV = textureWrapMode;\n        }\n        if (internalTexture._cachedWrapU !== texture.wrapU) {\n          internalTexture._cachedWrapU = texture.wrapU;\n          this._setTextureParameterInteger(target, this._gl.TEXTURE_WRAP_S, this._getTextureWrapMode(texture.wrapU), internalTexture);\n        }\n        if (internalTexture._cachedWrapV !== texture.wrapV) {\n          internalTexture._cachedWrapV = texture.wrapV;\n          this._setTextureParameterInteger(target, this._gl.TEXTURE_WRAP_T, this._getTextureWrapMode(texture.wrapV), internalTexture);\n        }\n        if (internalTexture.is3D && internalTexture._cachedWrapR !== texture.wrapR) {\n          internalTexture._cachedWrapR = texture.wrapR;\n          this._setTextureParameterInteger(target, this._gl.TEXTURE_WRAP_R, this._getTextureWrapMode(texture.wrapR), internalTexture);\n        }\n        this._setAnisotropicLevel(target, internalTexture, texture.anisotropicFilteringLevel);\n      }\n      return true;\n    }\n    /**\n     * Sets an array of texture to the webGL context\n     * @param channel defines the channel where the texture array must be set\n     * @param uniform defines the associated uniform location\n     * @param textures defines the array of textures to bind\n     * @param name name of the channel\n     */\n  }, {\n    key: \"setTextureArray\",\n    value: function setTextureArray(channel, uniform, textures, name) {\n      if (channel === undefined || !uniform) {\n        return;\n      }\n      if (!this._textureUnits || this._textureUnits.length !== textures.length) {\n        this._textureUnits = new Int32Array(textures.length);\n      }\n      for (var i = 0; i < textures.length; i++) {\n        var texture = textures[i].getInternalTexture();\n        if (texture) {\n          this._textureUnits[i] = channel + i;\n          texture._associatedChannel = channel + i;\n        } else {\n          this._textureUnits[i] = -1;\n        }\n      }\n      this._gl.uniform1iv(uniform, this._textureUnits);\n      for (var index = 0; index < textures.length; index++) {\n        this._setTexture(this._textureUnits[index], textures[index], true);\n      }\n    }\n    /**\n     * @internal\n     */\n  }, {\n    key: \"_setAnisotropicLevel\",\n    value: function _setAnisotropicLevel(target, internalTexture, anisotropicFilteringLevel) {\n      var anisotropicFilterExtension = this._caps.textureAnisotropicFilterExtension;\n      if (internalTexture.samplingMode !== 11 && internalTexture.samplingMode !== 3 && internalTexture.samplingMode !== 2) {\n        anisotropicFilteringLevel = 1; // Forcing the anisotropic to 1 because else webgl will force filters to linear\n      }\n\n      if (anisotropicFilterExtension && internalTexture._cachedAnisotropicFilteringLevel !== anisotropicFilteringLevel) {\n        this._setTextureParameterFloat(target, anisotropicFilterExtension.TEXTURE_MAX_ANISOTROPY_EXT, Math.min(anisotropicFilteringLevel, this._caps.maxAnisotropy), internalTexture);\n        internalTexture._cachedAnisotropicFilteringLevel = anisotropicFilteringLevel;\n      }\n    }\n  }, {\n    key: \"_setTextureParameterFloat\",\n    value: function _setTextureParameterFloat(target, parameter, value, texture) {\n      this._bindTextureDirectly(target, texture, true, true);\n      this._gl.texParameterf(target, parameter, value);\n    }\n  }, {\n    key: \"_setTextureParameterInteger\",\n    value: function _setTextureParameterInteger(target, parameter, value, texture) {\n      if (texture) {\n        this._bindTextureDirectly(target, texture, true, true);\n      }\n      this._gl.texParameteri(target, parameter, value);\n    }\n    /**\n     * Unbind all vertex attributes from the webGL context\n     */\n  }, {\n    key: \"unbindAllAttributes\",\n    value: function unbindAllAttributes() {\n      if (this._mustWipeVertexAttributes) {\n        this._mustWipeVertexAttributes = false;\n        for (var i = 0; i < this._caps.maxVertexAttribs; i++) {\n          this.disableAttributeByIndex(i);\n        }\n        return;\n      }\n      for (var _i2 = 0, ul = this._vertexAttribArraysEnabled.length; _i2 < ul; _i2++) {\n        if (_i2 >= this._caps.maxVertexAttribs || !this._vertexAttribArraysEnabled[_i2]) {\n          continue;\n        }\n        this.disableAttributeByIndex(_i2);\n      }\n    }\n    /**\n     * Force the engine to release all cached effects. This means that next effect compilation will have to be done completely even if a similar effect was already compiled\n     */\n  }, {\n    key: \"releaseEffects\",\n    value: function releaseEffects() {\n      for (var name in this._compiledEffects) {\n        var webGLPipelineContext = this._compiledEffects[name].getPipelineContext();\n        this._deletePipelineContext(webGLPipelineContext);\n      }\n      this._compiledEffects = {};\n    }\n    /**\n     * Dispose and release all associated resources\n     */\n  }, {\n    key: \"dispose\",\n    value: function dispose() {\n      var _a;\n      this._isDisposed = true;\n      this.stopRenderLoop();\n      // Clear observables\n      if (this.onBeforeTextureInitObservable) {\n        this.onBeforeTextureInitObservable.clear();\n      }\n      // Empty texture\n      if (this._emptyTexture) {\n        this._releaseTexture(this._emptyTexture);\n        this._emptyTexture = null;\n      }\n      if (this._emptyCubeTexture) {\n        this._releaseTexture(this._emptyCubeTexture);\n        this._emptyCubeTexture = null;\n      }\n      if (this._dummyFramebuffer) {\n        this._gl.deleteFramebuffer(this._dummyFramebuffer);\n      }\n      // Release effects\n      this.releaseEffects();\n      (_a = this.releaseComputeEffects) === null || _a === void 0 ? void 0 : _a.call(this);\n      // Unbind\n      this.unbindAllAttributes();\n      this._boundUniforms = {};\n      // Events\n      if (IsWindowObjectExist()) {\n        if (this._renderingCanvas) {\n          if (!this._doNotHandleContextLost) {\n            this._renderingCanvas.removeEventListener(\"webglcontextlost\", this._onContextLost);\n            this._renderingCanvas.removeEventListener(\"webglcontextrestored\", this._onContextRestored);\n          }\n          window.removeEventListener(\"resize\", this._checkForMobile);\n        }\n      }\n      this._workingCanvas = null;\n      this._workingContext = null;\n      this._currentBufferPointers.length = 0;\n      this._renderingCanvas = null;\n      this._currentProgram = null;\n      this._boundRenderFunction = null;\n      Effect.ResetCache();\n      // Abort active requests\n      var _iterator8 = _createForOfIteratorHelper(this._activeRequests),\n        _step8;\n      try {\n        for (_iterator8.s(); !(_step8 = _iterator8.n()).done;) {\n          var request = _step8.value;\n          request.abort();\n        }\n      } catch (err) {\n        _iterator8.e(err);\n      } finally {\n        _iterator8.f();\n      }\n      this.onDisposeObservable.notifyObservers(this);\n      this.onDisposeObservable.clear();\n    }\n    /**\n     * Attach a new callback raised when context lost event is fired\n     * @param callback defines the callback to call\n     */\n  }, {\n    key: \"attachContextLostEvent\",\n    value: function attachContextLostEvent(callback) {\n      if (this._renderingCanvas) {\n        this._renderingCanvas.addEventListener(\"webglcontextlost\", callback, false);\n      }\n    }\n    /**\n     * Attach a new callback raised when context restored event is fired\n     * @param callback defines the callback to call\n     */\n  }, {\n    key: \"attachContextRestoredEvent\",\n    value: function attachContextRestoredEvent(callback) {\n      if (this._renderingCanvas) {\n        this._renderingCanvas.addEventListener(\"webglcontextrestored\", callback, false);\n      }\n    }\n    /**\n     * Get the current error code of the webGL context\n     * @returns the error code\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/getError\n     */\n  }, {\n    key: \"getError\",\n    value: function getError() {\n      return this._gl.getError();\n    }\n  }, {\n    key: \"_canRenderToFloatFramebuffer\",\n    value: function _canRenderToFloatFramebuffer() {\n      if (this._webGLVersion > 1) {\n        return this._caps.colorBufferFloat;\n      }\n      return this._canRenderToFramebuffer(1);\n    }\n  }, {\n    key: \"_canRenderToHalfFloatFramebuffer\",\n    value: function _canRenderToHalfFloatFramebuffer() {\n      if (this._webGLVersion > 1) {\n        return this._caps.colorBufferFloat;\n      }\n      return this._canRenderToFramebuffer(2);\n    }\n    // Thank you : http://stackoverflow.com/questions/28827511/webgl-ios-render-to-floating-point-texture\n  }, {\n    key: \"_canRenderToFramebuffer\",\n    value: function _canRenderToFramebuffer(type) {\n      var gl = this._gl;\n      //clear existing errors\n      // eslint-disable-next-line no-empty\n      while (gl.getError() !== gl.NO_ERROR) {}\n      var successful = true;\n      var texture = gl.createTexture();\n      gl.bindTexture(gl.TEXTURE_2D, texture);\n      gl.texImage2D(gl.TEXTURE_2D, 0, this._getRGBABufferInternalSizedFormat(type), 1, 1, 0, gl.RGBA, this._getWebGLTextureType(type), null);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n      var fb = gl.createFramebuffer();\n      gl.bindFramebuffer(gl.FRAMEBUFFER, fb);\n      gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, texture, 0);\n      var status = gl.checkFramebufferStatus(gl.FRAMEBUFFER);\n      successful = successful && status === gl.FRAMEBUFFER_COMPLETE;\n      successful = successful && gl.getError() === gl.NO_ERROR;\n      //try render by clearing frame buffer's color buffer\n      if (successful) {\n        gl.clear(gl.COLOR_BUFFER_BIT);\n        successful = successful && gl.getError() === gl.NO_ERROR;\n      }\n      //try reading from frame to ensure render occurs (just creating the FBO is not sufficient to determine if rendering is supported)\n      if (successful) {\n        //in practice it's sufficient to just read from the backbuffer rather than handle potentially issues reading from the texture\n        gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n        var readFormat = gl.RGBA;\n        var readType = gl.UNSIGNED_BYTE;\n        var buffer = new Uint8Array(4);\n        gl.readPixels(0, 0, 1, 1, readFormat, readType, buffer);\n        successful = successful && gl.getError() === gl.NO_ERROR;\n      }\n      //clean up\n      gl.deleteTexture(texture);\n      gl.deleteFramebuffer(fb);\n      gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n      //clear accumulated errors\n      // eslint-disable-next-line no-empty\n      while (!successful && gl.getError() !== gl.NO_ERROR) {}\n      return successful;\n    }\n    /**\n     * @internal\n     */\n  }, {\n    key: \"_getWebGLTextureType\",\n    value: function _getWebGLTextureType(type) {\n      if (this._webGLVersion === 1) {\n        switch (type) {\n          case 1:\n            return this._gl.FLOAT;\n          case 2:\n            return this._gl.HALF_FLOAT_OES;\n          case 0:\n            return this._gl.UNSIGNED_BYTE;\n          case 8:\n            return this._gl.UNSIGNED_SHORT_4_4_4_4;\n          case 9:\n            return this._gl.UNSIGNED_SHORT_5_5_5_1;\n          case 10:\n            return this._gl.UNSIGNED_SHORT_5_6_5;\n        }\n        return this._gl.UNSIGNED_BYTE;\n      }\n      switch (type) {\n        case 3:\n          return this._gl.BYTE;\n        case 0:\n          return this._gl.UNSIGNED_BYTE;\n        case 4:\n          return this._gl.SHORT;\n        case 5:\n          return this._gl.UNSIGNED_SHORT;\n        case 6:\n          return this._gl.INT;\n        case 7:\n          // Refers to UNSIGNED_INT\n          return this._gl.UNSIGNED_INT;\n        case 1:\n          return this._gl.FLOAT;\n        case 2:\n          return this._gl.HALF_FLOAT;\n        case 8:\n          return this._gl.UNSIGNED_SHORT_4_4_4_4;\n        case 9:\n          return this._gl.UNSIGNED_SHORT_5_5_5_1;\n        case 10:\n          return this._gl.UNSIGNED_SHORT_5_6_5;\n        case 11:\n          return this._gl.UNSIGNED_INT_2_10_10_10_REV;\n        case 12:\n          return this._gl.UNSIGNED_INT_24_8;\n        case 13:\n          return this._gl.UNSIGNED_INT_10F_11F_11F_REV;\n        case 14:\n          return this._gl.UNSIGNED_INT_5_9_9_9_REV;\n        case 15:\n          return this._gl.FLOAT_32_UNSIGNED_INT_24_8_REV;\n      }\n      return this._gl.UNSIGNED_BYTE;\n    }\n    /**\n     * @internal\n     */\n  }, {\n    key: \"_getInternalFormat\",\n    value: function _getInternalFormat(format) {\n      var useSRGBBuffer = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      var internalFormat = useSRGBBuffer ? this._glSRGBExtensionValues.SRGB8_ALPHA8 : this._gl.RGBA;\n      switch (format) {\n        case 0:\n          internalFormat = this._gl.ALPHA;\n          break;\n        case 1:\n          internalFormat = this._gl.LUMINANCE;\n          break;\n        case 2:\n          internalFormat = this._gl.LUMINANCE_ALPHA;\n          break;\n        case 6:\n          internalFormat = this._gl.RED;\n          break;\n        case 7:\n          internalFormat = this._gl.RG;\n          break;\n        case 4:\n          internalFormat = useSRGBBuffer ? this._glSRGBExtensionValues.SRGB : this._gl.RGB;\n          break;\n        case 5:\n          internalFormat = useSRGBBuffer ? this._glSRGBExtensionValues.SRGB8_ALPHA8 : this._gl.RGBA;\n          break;\n      }\n      if (this._webGLVersion > 1) {\n        switch (format) {\n          case 8:\n            internalFormat = this._gl.RED_INTEGER;\n            break;\n          case 9:\n            internalFormat = this._gl.RG_INTEGER;\n            break;\n          case 10:\n            internalFormat = this._gl.RGB_INTEGER;\n            break;\n          case 11:\n            internalFormat = this._gl.RGBA_INTEGER;\n            break;\n        }\n      }\n      return internalFormat;\n    }\n    /**\n     * @internal\n     */\n  }, {\n    key: \"_getRGBABufferInternalSizedFormat\",\n    value: function _getRGBABufferInternalSizedFormat(type, format) {\n      var useSRGBBuffer = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n      if (this._webGLVersion === 1) {\n        if (format !== undefined) {\n          switch (format) {\n            case 0:\n              return this._gl.ALPHA;\n            case 1:\n              return this._gl.LUMINANCE;\n            case 2:\n              return this._gl.LUMINANCE_ALPHA;\n            case 4:\n              return useSRGBBuffer ? this._glSRGBExtensionValues.SRGB : this._gl.RGB;\n          }\n        }\n        return this._gl.RGBA;\n      }\n      switch (type) {\n        case 3:\n          switch (format) {\n            case 6:\n              return this._gl.R8_SNORM;\n            case 7:\n              return this._gl.RG8_SNORM;\n            case 4:\n              return this._gl.RGB8_SNORM;\n            case 8:\n              return this._gl.R8I;\n            case 9:\n              return this._gl.RG8I;\n            case 10:\n              return this._gl.RGB8I;\n            case 11:\n              return this._gl.RGBA8I;\n            default:\n              return this._gl.RGBA8_SNORM;\n          }\n        case 0:\n          switch (format) {\n            case 6:\n              return this._gl.R8;\n            case 7:\n              return this._gl.RG8;\n            case 4:\n              return useSRGBBuffer ? this._glSRGBExtensionValues.SRGB8 : this._gl.RGB8;\n            // By default. Other possibilities are RGB565, SRGB8.\n            case 5:\n              return useSRGBBuffer ? this._glSRGBExtensionValues.SRGB8_ALPHA8 : this._gl.RGBA8;\n            // By default. Other possibilities are RGB5_A1, RGBA4, SRGB8_ALPHA8.\n            case 8:\n              return this._gl.R8UI;\n            case 9:\n              return this._gl.RG8UI;\n            case 10:\n              return this._gl.RGB8UI;\n            case 11:\n              return this._gl.RGBA8UI;\n            case 0:\n              return this._gl.ALPHA;\n            case 1:\n              return this._gl.LUMINANCE;\n            case 2:\n              return this._gl.LUMINANCE_ALPHA;\n            default:\n              return this._gl.RGBA8;\n          }\n        case 4:\n          switch (format) {\n            case 8:\n              return this._gl.R16I;\n            case 9:\n              return this._gl.RG16I;\n            case 10:\n              return this._gl.RGB16I;\n            case 11:\n              return this._gl.RGBA16I;\n            default:\n              return this._gl.RGBA16I;\n          }\n        case 5:\n          switch (format) {\n            case 8:\n              return this._gl.R16UI;\n            case 9:\n              return this._gl.RG16UI;\n            case 10:\n              return this._gl.RGB16UI;\n            case 11:\n              return this._gl.RGBA16UI;\n            default:\n              return this._gl.RGBA16UI;\n          }\n        case 6:\n          switch (format) {\n            case 8:\n              return this._gl.R32I;\n            case 9:\n              return this._gl.RG32I;\n            case 10:\n              return this._gl.RGB32I;\n            case 11:\n              return this._gl.RGBA32I;\n            default:\n              return this._gl.RGBA32I;\n          }\n        case 7:\n          // Refers to UNSIGNED_INT\n          switch (format) {\n            case 8:\n              return this._gl.R32UI;\n            case 9:\n              return this._gl.RG32UI;\n            case 10:\n              return this._gl.RGB32UI;\n            case 11:\n              return this._gl.RGBA32UI;\n            default:\n              return this._gl.RGBA32UI;\n          }\n        case 1:\n          switch (format) {\n            case 6:\n              return this._gl.R32F;\n            // By default. Other possibility is R16F.\n            case 7:\n              return this._gl.RG32F;\n            // By default. Other possibility is RG16F.\n            case 4:\n              return this._gl.RGB32F;\n            // By default. Other possibilities are RGB16F, R11F_G11F_B10F, RGB9_E5.\n            case 5:\n              return this._gl.RGBA32F;\n            // By default. Other possibility is RGBA16F.\n            default:\n              return this._gl.RGBA32F;\n          }\n        case 2:\n          switch (format) {\n            case 6:\n              return this._gl.R16F;\n            case 7:\n              return this._gl.RG16F;\n            case 4:\n              return this._gl.RGB16F;\n            // By default. Other possibilities are R11F_G11F_B10F, RGB9_E5.\n            case 5:\n              return this._gl.RGBA16F;\n            default:\n              return this._gl.RGBA16F;\n          }\n        case 10:\n          return this._gl.RGB565;\n        case 13:\n          return this._gl.R11F_G11F_B10F;\n        case 14:\n          return this._gl.RGB9_E5;\n        case 8:\n          return this._gl.RGBA4;\n        case 9:\n          return this._gl.RGB5_A1;\n        case 11:\n          switch (format) {\n            case 5:\n              return this._gl.RGB10_A2;\n            // By default. Other possibility is RGB5_A1.\n            case 11:\n              return this._gl.RGB10_A2UI;\n            default:\n              return this._gl.RGB10_A2;\n          }\n      }\n      return useSRGBBuffer ? this._glSRGBExtensionValues.SRGB8_ALPHA8 : this._gl.RGBA8;\n    }\n    /**\n     * @internal\n     */\n  }, {\n    key: \"_getRGBAMultiSampleBufferFormat\",\n    value: function _getRGBAMultiSampleBufferFormat(type) {\n      var format = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 5;\n      switch (type) {\n        case 1:\n          switch (format) {\n            case 6:\n              return this._gl.R32F;\n            default:\n              return this._gl.RGBA32F;\n          }\n        case 2:\n          switch (format) {\n            case 6:\n              return this._gl.R16F;\n            default:\n              return this._gl.RGBA16F;\n          }\n      }\n      return this._gl.RGBA8;\n    }\n    /**\n     * @internal\n     */\n  }, {\n    key: \"_loadFile\",\n    value: function _loadFile(url, onSuccess, onProgress, offlineProvider, useArrayBuffer, onError) {\n      var _this7 = this;\n      var request = ThinEngine._FileToolsLoadFile(url, onSuccess, onProgress, offlineProvider, useArrayBuffer, onError);\n      this._activeRequests.push(request);\n      request.onCompleteObservable.add(function (request) {\n        _this7._activeRequests.splice(_this7._activeRequests.indexOf(request), 1);\n      });\n      return request;\n    }\n    /**\n     * Loads a file from a url\n     * @param url url to load\n     * @param onSuccess callback called when the file successfully loads\n     * @param onProgress callback called while file is loading (if the server supports this mode)\n     * @param offlineProvider defines the offline provider for caching\n     * @param useArrayBuffer defines a boolean indicating that date must be returned as ArrayBuffer\n     * @param onError callback called when the file fails to load\n     * @returns a file request object\n     * @internal\n     */\n  }, {\n    key: \"readPixels\",\n    value:\n    /**\n     * Reads pixels from the current frame buffer. Please note that this function can be slow\n     * @param x defines the x coordinate of the rectangle where pixels must be read\n     * @param y defines the y coordinate of the rectangle where pixels must be read\n     * @param width defines the width of the rectangle where pixels must be read\n     * @param height defines the height of the rectangle where pixels must be read\n     * @param hasAlpha defines whether the output should have alpha or not (defaults to true)\n     * @param flushRenderer true to flush the renderer from the pending commands before reading the pixels\n     * @returns a ArrayBufferView promise (Uint8Array) containing RGBA colors\n     */\n    function readPixels(x, y, width, height) {\n      var hasAlpha = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : true;\n      var flushRenderer = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : true;\n      var numChannels = hasAlpha ? 4 : 3;\n      var format = hasAlpha ? this._gl.RGBA : this._gl.RGB;\n      var data = new Uint8Array(height * width * numChannels);\n      if (flushRenderer) {\n        this.flushFramebuffer();\n      }\n      this._gl.readPixels(x, y, width, height, format, this._gl.UNSIGNED_BYTE, data);\n      return Promise.resolve(data);\n    }\n    /**\n     * Gets a Promise<boolean> indicating if the engine can be instantiated (ie. if a webGL context can be found)\n     */\n  }, {\n    key: \"getHostDocument\",\n    value:\n    /**\n     * Gets host document\n     * @returns the host document object\n     */\n    function getHostDocument() {\n      if (this._renderingCanvas && this._renderingCanvas.ownerDocument) {\n        return this._renderingCanvas.ownerDocument;\n      }\n      return IsDocumentAvailable() ? document : null;\n    }\n  }], [{\n    key: \"NpmPackage\",\n    get:\n    /**\n     * Returns the current npm package of the sdk\n     */\n    // Not mixed with Version for tooling purpose.\n    function get() {\n      return \"babylonjs@6.4.0\";\n    }\n    /**\n     * Returns the current version of the framework\n     */\n  }, {\n    key: \"Version\",\n    get: function get() {\n      return \"6.4.0\";\n    }\n  }, {\n    key: \"ShadersRepository\",\n    get: function get() {\n      return Effect.ShadersRepository;\n    },\n    set: function set(value) {\n      Effect.ShadersRepository = value;\n    }\n  }, {\n    key: \"_CreateCanvas\",\n    value: function _CreateCanvas(width, height) {\n      if (typeof document === \"undefined\") {\n        return new OffscreenCanvas(width, height);\n      }\n      var canvas = document.createElement(\"canvas\");\n      canvas.width = width;\n      canvas.height = height;\n      return canvas;\n    }\n  }, {\n    key: \"_ConcatenateShader\",\n    value: function _ConcatenateShader(source, defines) {\n      var shaderVersion = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : \"\";\n      return shaderVersion + (defines ? defines + \"\\n\" : \"\") + source;\n    }\n  }, {\n    key: \"_FileToolsLoadImage\",\n    value: function _FileToolsLoadImage(input, onLoad, onError, offlineProvider, mimeType, imageBitmapOptions) {\n      throw _WarnImport(\"FileTools\");\n    }\n  }, {\n    key: \"_FileToolsLoadFile\",\n    value: function _FileToolsLoadFile(url, onSuccess, onProgress, offlineProvider, useArrayBuffer, onError) {\n      throw _WarnImport(\"FileTools\");\n    }\n  }, {\n    key: \"IsSupportedAsync\",\n    get: function get() {\n      return Promise.resolve(this.isSupported());\n    }\n    /**\n     * Gets a boolean indicating if the engine can be instantiated (ie. if a webGL context can be found)\n     */\n  }, {\n    key: \"IsSupported\",\n    get: function get() {\n      return this.isSupported(); // Backward compat\n    }\n    /**\n     * Gets a boolean indicating if the engine can be instantiated (ie. if a webGL context can be found)\n     * @returns true if the engine can be created\n     * @ignorenaming\n     */\n    // eslint-disable-next-line @typescript-eslint/naming-convention\n  }, {\n    key: \"isSupported\",\n    value: function isSupported() {\n      if (this._HasMajorPerformanceCaveat !== null) {\n        return !this._HasMajorPerformanceCaveat; // We know it is performant so WebGL is supported\n      }\n\n      if (this._IsSupported === null) {\n        try {\n          var tempcanvas = this._CreateCanvas(1, 1);\n          var gl = tempcanvas.getContext(\"webgl\") || tempcanvas.getContext(\"experimental-webgl\");\n          this._IsSupported = gl != null && !!window.WebGLRenderingContext;\n        } catch (e) {\n          this._IsSupported = false;\n        }\n      }\n      return this._IsSupported;\n    }\n    /**\n     * Gets a boolean indicating if the engine can be instantiated on a performant device (ie. if a webGL context can be found and it does not use a slow implementation)\n     */\n  }, {\n    key: \"HasMajorPerformanceCaveat\",\n    get: function get() {\n      if (this._HasMajorPerformanceCaveat === null) {\n        try {\n          var tempcanvas = this._CreateCanvas(1, 1);\n          var gl = tempcanvas.getContext(\"webgl\", {\n            failIfMajorPerformanceCaveat: true\n          }) || tempcanvas.getContext(\"experimental-webgl\", {\n            failIfMajorPerformanceCaveat: true\n          });\n          this._HasMajorPerformanceCaveat = !gl;\n        } catch (e) {\n          this._HasMajorPerformanceCaveat = false;\n        }\n      }\n      return this._HasMajorPerformanceCaveat;\n    }\n    /**\n     * Find the next highest power of two.\n     * @param x Number to start search from.\n     * @returns Next highest power of two.\n     */\n  }, {\n    key: \"CeilingPOT\",\n    value: function CeilingPOT(x) {\n      x--;\n      x |= x >> 1;\n      x |= x >> 2;\n      x |= x >> 4;\n      x |= x >> 8;\n      x |= x >> 16;\n      x++;\n      return x;\n    }\n    /**\n     * Find the next lowest power of two.\n     * @param x Number to start search from.\n     * @returns Next lowest power of two.\n     */\n  }, {\n    key: \"FloorPOT\",\n    value: function FloorPOT(x) {\n      x = x | x >> 1;\n      x = x | x >> 2;\n      x = x | x >> 4;\n      x = x | x >> 8;\n      x = x | x >> 16;\n      return x - (x >> 1);\n    }\n    /**\n     * Find the nearest power of two.\n     * @param x Number to start search from.\n     * @returns Next nearest power of two.\n     */\n  }, {\n    key: \"NearestPOT\",\n    value: function NearestPOT(x) {\n      var c = ThinEngine.CeilingPOT(x);\n      var f = ThinEngine.FloorPOT(x);\n      return c - x > x - f ? f : c;\n    }\n    /**\n     * Get the closest exponent of two\n     * @param value defines the value to approximate\n     * @param max defines the maximum value to return\n     * @param mode defines how to define the closest value\n     * @returns closest exponent of two of the given value\n     */\n  }, {\n    key: \"GetExponentOfTwo\",\n    value: function GetExponentOfTwo(value, max) {\n      var mode = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 2;\n      var pot;\n      switch (mode) {\n        case 1:\n          pot = ThinEngine.FloorPOT(value);\n          break;\n        case 2:\n          pot = ThinEngine.NearestPOT(value);\n          break;\n        case 3:\n        default:\n          pot = ThinEngine.CeilingPOT(value);\n          break;\n      }\n      return Math.min(pot, max);\n    }\n    /**\n     * Queue a new function into the requested animation frame pool (ie. this function will be executed by the browser (or the javascript engine) for the next frame)\n     * @param func - the function to be called\n     * @param requester - the object that will request the next frame. Falls back to window.\n     * @returns frame number\n     */\n  }, {\n    key: \"QueueNewFrame\",\n    value: function QueueNewFrame(func, requester) {\n      // Note that there is kind of a typing issue here, as `setTimeout` might return something else than a number (NodeJs returns a NodeJS.Timeout object).\n      // Also if the global `requestAnimationFrame`'s returnType is number, `requester.requestPostAnimationFrame` and `requester.requestAnimationFrame` types\n      // are `any`.\n      if (!IsWindowObjectExist()) {\n        if (typeof requestAnimationFrame === \"function\") {\n          return requestAnimationFrame(func);\n        }\n      } else {\n        var _ref2 = requester || window,\n          requestPostAnimationFrame = _ref2.requestPostAnimationFrame,\n          _requestAnimationFrame = _ref2.requestAnimationFrame;\n        if (typeof requestPostAnimationFrame === \"function\") {\n          return requestPostAnimationFrame(func);\n        }\n        if (typeof _requestAnimationFrame === \"function\") {\n          return _requestAnimationFrame(func);\n        }\n      }\n      // fallback to the global `setTimeout`.\n      // In most cases (aka in the browser), `window` is the global object, so instead of calling `window.setTimeout` we could call the global `setTimeout`.\n      return setTimeout(func, 16);\n    }\n  }]);\n  return ThinEngine;\n}();\n/** Use this array to turn off some WebGL2 features on known buggy browsers version */\nThinEngine.ExceptionList = [{\n  key: \"Chrome/63.0\",\n  capture: \"63\\\\.0\\\\.3239\\\\.(\\\\d+)\",\n  captureConstraint: 108,\n  targets: [\"uniformBuffer\"]\n}, {\n  key: \"Firefox/58\",\n  capture: null,\n  captureConstraint: null,\n  targets: [\"uniformBuffer\"]\n}, {\n  key: \"Firefox/59\",\n  capture: null,\n  captureConstraint: null,\n  targets: [\"uniformBuffer\"]\n}, {\n  key: \"Chrome/72.+?Mobile\",\n  capture: null,\n  captureConstraint: null,\n  targets: [\"vao\"]\n}, {\n  key: \"Chrome/73.+?Mobile\",\n  capture: null,\n  captureConstraint: null,\n  targets: [\"vao\"]\n}, {\n  key: \"Chrome/74.+?Mobile\",\n  capture: null,\n  captureConstraint: null,\n  targets: [\"vao\"]\n}, {\n  key: \"Mac OS.+Chrome/71\",\n  capture: null,\n  captureConstraint: null,\n  targets: [\"vao\"]\n}, {\n  key: \"Mac OS.+Chrome/72\",\n  capture: null,\n  captureConstraint: null,\n  targets: [\"vao\"]\n}, {\n  key: \"Mac OS.+Chrome\",\n  capture: null,\n  captureConstraint: null,\n  targets: [\"uniformBuffer\"]\n},\n// desktop osx safari 15.4\n{\n  key: \".*AppleWebKit.*(15.4).*Safari\",\n  capture: null,\n  captureConstraint: null,\n  targets: [\"antialias\", \"maxMSAASamples\"]\n},\n// mobile browsers using safari 15.4 on ios\n{\n  key: \".*(15.4).*AppleWebKit.*Safari\",\n  capture: null,\n  captureConstraint: null,\n  targets: [\"antialias\", \"maxMSAASamples\"]\n}];\n/** @internal */\nThinEngine._TextureLoaders = [];\n// Updatable statics so stick with vars here\n/**\n * Gets or sets the epsilon value used by collision engine\n */\nThinEngine.CollisionsEpsilon = 0.001;\n// Statics\nThinEngine._IsSupported = null;\nThinEngine._HasMajorPerformanceCaveat = null;"],"names":["_createForOfIteratorHelper","o","allowArrayLike","it","Symbol","iterator","Array","isArray","minLen","_arrayLikeToArray","n","Object","prototype","toString","call","slice","constructor","name","from","test","_unsupportedIterableToArray","length","i","F","s","done","value","e","_e2","f","TypeError","err","normalCompletion","didErr","step","next","_e3","return","arr","len","arr2","BufferPointer","this","ThinEngine","canvasOrContext","antialias","options","adaptToDeviceRatio","_a","_b","_c","_d","_e","_f","_g","_h","_j","_k","_l","_this","_name","_isDisposed","forcePOTTextures","isFullscreen","cullBackFaces","renderEvenInBackground","preventCacheWipeBetweenFrames","validateShaderPrograms","_useReverseDepthBuffer","isNDCHalfZRange","hasOriginBottomLeft","disableUniformBuffers","onDisposeObservable","_frameId","_uniformBuffers","_storageBuffers","_webGLVersion","_windowIsBackground","_highPrecisionShadersAllowed","_badOS","_badDesktopOS","_renderingQueueLaunched","_activeRenderLoops","onContextLostObservable","onContextRestoredObservable","_contextWasLost","_doNotHandleContextLost","disableVertexArrayObjects","_colorWrite","_colorWriteChanged","_depthCullingState","_stencilStateComposer","_stencilState","_alphaState","_alphaMode","_alphaEquation","_internalTexturesCache","_renderTargetWrapperCache","_activeChannel","_currentTextureChannel","_boundTexturesCache","_compiledEffects","_vertexAttribArraysEnabled","_uintIndicesCurrentlySet","_currentBoundBuffer","_currentFramebuffer","_dummyFramebuffer","_currentBufferPointers","_currentInstanceLocations","_currentInstanceBuffers","_vaoRecordInProgress","_mustWipeVertexAttributes","_nextFreeTextureSlots","_maxSimultaneousTextures","_maxMSAASamplesOverride","_activeRequests","_lastDevicePixelRatio","_transformTextureUrl","hostInformation","isMobile","premultipliedAlpha","onBeforeTextureInitObservable","_isWebGPU","_snapshotRenderingMode","_viewportCached","x","y","z","w","_unpackFlipYCached","enableUnpackFlipYCached","_boundUniforms","startTime","canvas","_creationOptions","stencilGlobal","useHighPrecisionMatrix","deterministicLockstep","lockstepMaxSteps","timeStep","audioEngine","stencil","_audioContext","audioEngineOptions","audioContext","_audioDestination","audioDestination","useExactSrgbConversions","doNotHandleContextLost","_isStencilEnable","devicePixelRatio","window","limitDeviceRatio","_hardwareScalingLevel","Math","min","getContext","_renderingCanvas","undefined","preserveDrawingBuffer","xrCompatible","navigator","userAgent","_setupMobileChecks","_step","ua","_iterator","ExceptionList","exception","key","targets","RegExp","capture","captureConstraint","constraint","matches","exec","parseInt","_step2","_iterator2","_onContextLost","evt","preventDefault","notifyObservers","_onContextRestored","_restoreEngineAfterContextLost","_initGLContext","bind","addEventListener","powerPreference","disableWebGL2Support","_gl","_shaderPlatformName","deleteQuery","Error","renderbufferStorageMultisample","attributes","getContextAttributes","pixelStorei","UNPACK_COLORSPACE_CONVERSION_WEBGL","NONE","useHighPrecisionFloats","resize","_initFeatures","_caps","maxVertexAttribs","_shaderProcessor","webGLVersion","versionToLog","concat","Version","console","log","description","setAttribute","get","parallelShaderCompile","set","shaderLanguage","useReverse","depthFunc","highPrecisionShaderSupported","dimensions","_framebufferDimensionsObject","_cachedViewport","_emptyTexture","createRawTexture","Uint8Array","_emptyTexture3D","createRawTexture3D","_emptyTexture2DArray","createRawTexture2DArray","_emptyCubeTexture","faceData","cubeData","createRawCubeTexture","activate","mode","snapshotRendering","width","height","_CreateCanvas","document","createElement","_this2","_checkForMobile","currentUA","indexOf","initEngine","_this3","setTimeout","_callee","depthTest","depthMask","stencilTest","_context","prev","wipeCaches","_rebuildEffects","_rebuildComputeEffects","_rebuildBuffers","_rebuildInternalTextures","_rebuildRenderTargetWrappers","stop","_step3","_iterator3","_rebuild","_step4","_iterator4","effect","_pipelineContext","_wasPreviouslyReady","_prepareEffect","isReady","_step5","_iterator5","_step6","_iterator6","maxTexturesImageUnits","getParameter","MAX_TEXTURE_IMAGE_UNITS","maxCombinedTexturesImageUnits","MAX_COMBINED_TEXTURE_IMAGE_UNITS","maxVertexTextureImageUnits","MAX_VERTEX_TEXTURE_IMAGE_UNITS","maxTextureSize","MAX_TEXTURE_SIZE","maxSamples","MAX_SAMPLES","maxCubemapTextureSize","MAX_CUBE_MAP_TEXTURE_SIZE","maxRenderTextureSize","MAX_RENDERBUFFER_SIZE","MAX_VERTEX_ATTRIBS","maxVaryingVectors","MAX_VARYING_VECTORS","maxFragmentUniformVectors","MAX_FRAGMENT_UNIFORM_VECTORS","maxVertexUniformVectors","MAX_VERTEX_UNIFORM_VECTORS","getExtension","standardDerivatives","maxAnisotropy","astc","bptc","s3tc","s3tc_srgb","pvrtc","etc1","etc2","textureAnisotropicFilterExtension","uintIndices","fragmentDepthSupported","timerQuery","supportOcclusionQuery","canUseTimestampForTimerQuery","drawBuffersExtension","maxMSAASamples","colorBufferFloat","textureFloat","textureHalfFloat","textureHalfFloatRender","textureFloatLinearFiltering","textureFloatRender","textureHalfFloatLinearFiltering","vertexArrayObject","instancedArrays","textureLOD","texelFetch","blendMinMax","multiview","oculusMultiview","depthTextureExtension","canUseGLInstanceID","canUseGLVertexID","supportComputeShaders","supportSRGBBuffers","supportTransformFeedbacks","textureMaxLevel","texture2DArrayMaxLayerCount","MAX_ARRAY_TEXTURE_LAYERS","disableMorphTargetTexture","_glVersion","VERSION","rendererInfo","_glRenderer","UNMASKED_RENDERER_WEBGL","_glVendor","UNMASKED_VENDOR_WEBGL","VENDOR","RENDERER","HALF_FLOAT_OES","RGBA16F","RGBA32F","DEPTH24_STENCIL8","getQuery","getQueryEXT","TIMESTAMP_EXT","QUERY_COUNTER_BITS_EXT","MAX_TEXTURE_MAX_ANISOTROPY_EXT","_canRenderToFloatFramebuffer","COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR","COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT","COMPRESSED_SRGB_S3TC_DXT1_EXT","COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT","COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT","COMPRESSED_SRGB8_ETC2","COMPRESSED_SRGB8_ALPHA8_ETC2_EAC","_canRenderToHalfFloatFramebuffer","drawBuffers","drawBuffersWEBGL","DRAW_FRAMEBUFFER","FRAMEBUFFER","UNSIGNED_INT_24_8","UNSIGNED_INT_24_8_WEBGL","vertexArrayObjectExtension","createVertexArray","createVertexArrayOES","bindVertexArray","bindVertexArrayOES","deleteVertexArray","deleteVertexArrayOES","instanceExtension","drawArraysInstanced","drawArraysInstancedANGLE","drawElementsInstanced","drawElementsInstancedANGLE","vertexAttribDivisor","vertexAttribDivisorANGLE","getShaderPrecisionFormat","vertexhighp","VERTEX_SHADER","HIGH_FLOAT","fragmenthighp","FRAGMENT_SHADER","precision","blendMinMaxExtension","MAX","MAX_EXT","MIN","MIN_EXT","_glSRGBExtensionValues","SRGB","WebGL2RenderingContext","SRGB8","SRGB8_ALPHA8","sRGBExtension","SRGB_EXT","SRGB_ALPHA_EXT","forceSRGBBufferSupportState","LEQUAL","slot","push","_features","forceBitmapOverHTMLImageElement","supportRenderAndCopyToLodForFloatTextures","supportDepthStencilTexture","supportShadowSamplers","uniformBufferHardCheckMatrix","allowTexturePrefiltering","trackUbosInFrame","checkUbosContentBeforeUpload","supportCSM","basisNeedsPOT","support3DTextures","needTypeSuffixInShaderConstants","supportMSAA","supportSSAO2","supportExtendedTextureFormats","supportSwitchCaseInShader","supportSyncTextureRead","needsInvertingBitmap","useUBOBindingCache","needShaderCodeInlining","needToAlwaysBindUniformBuffers","supportRenderPasses","supportSpriteInstancing","_collectUbosUpdatedInFrame","_workingCanvas","createCanvas","context","_workingContext","hasOwnProperty","getGlInfo","vendor","renderer","version","level","renderFunction","index","splice","shouldRender","beginFrame","endFrame","_frameHandler","_queueNewFrame","_boundRenderFunction","getHostWindow","ownerDocument","defaultView","arguments","_currentRenderTarget","framebufferWidth","drawingBufferWidth","framebufferHeight","drawingBufferHeight","bindedRenderFunction","requester","QueueNewFrame","_renderLoop","color","backBuffer","depth","useStencilGlobalOnly","stencilStateComposer","applyStates","clearColor","r","g","b","a","COLOR_BUFFER_BIT","useReverseDepthBuffer","GEQUAL","clearDepth","DEPTH_BUFFER_BIT","clearStencil","STENCIL_BUFFER_BIT","clear","viewport","requiredWidth","requiredHeight","getRenderWidth","getRenderHeight","_viewport","flushFramebuffer","forceSetSize","changeRatio","boundingRect","getBoundingClientRect","clientWidth","clientHeight","innerWidth","innerHeight","setSize","rtWrapper","faceIndex","forceFullscreenViewport","lodLevel","layer","webglRTWrapper","unBindFramebuffer","_bindUnboundFramebuffer","_MSAAFramebuffer","_framebuffer","gl","isMulti","is2DArray","framebufferTextureLayer","COLOR_ATTACHMENT0","texture","_hardwareTexture","underlyingResource","isCube","framebufferTexture2D","TEXTURE_CUBE_MAP_POSITIVE_X","depthStencilTexture","_depthStencilTexture","attachment","_depthStencilTextureWithStencil","DEPTH_STENCIL_ATTACHMENT","DEPTH_ATTACHMENT","TEXTURE_2D","setViewport","pow","culling","zOffset","force","reverseSide","zOffsetUnits","cull","cullFace","BACK","FRONT","setZOffset","setZOffsetUnits","frontFace","CW","CCW","stencilMaterial","enable","framebuffer","bindFramebuffer","_bindTextureDirectly","generateMipmap","disableGenerateMipMaps","onBeforeUnbind","unBindMultiColorAttachmentFramebuffer","READ_FRAMEBUFFER","blitFramebuffer","NEAREST","generateMipMaps","generateMipmaps","flush","bindArrayBuffer","_cachedVertexBuffers","data","_createVertexBuffer","STATIC_DRAW","usage","vbo","createBuffer","dataBuffer","bufferData","ARRAY_BUFFER","Float32Array","_resetVertexBufferBinding","references","DYNAMIC_DRAW","bindIndexBuffer","_cachedIndexBuffer","indices","updatable","_normalizeIndexData","ELEMENT_ARRAY_BUFFER","_resetIndexBufferBinding","is32Bits","BYTES_PER_ELEMENT","Uint32Array","Uint16Array","buffer","_unbindVertexArrayObject","_bindBuffer","pipelineContext","blockName","program","uniformLocation","getUniformBlockIndex","uniformBlockBinding","target","bindBuffer","bufferSubData","indx","size","type","normalized","stride","offset","pointer","changed","active","UNSIGNED_INT","INT","vertexAttribIPointer","vertexAttribPointer","indexBuffer","vertexBuffers","overrideVertexBuffers","getAttributesNames","unbindAllAttributes","order","getAttributeLocation","ai","vertexBuffer","enableVertexAttribArray","getBuffer","_vertexAttribPointer","getSize","byteStride","byteOffset","getIsInstanced","getInstanceDivisor","vao","_bindVertexBuffersAttributes","_cachedVertexArrayObject","vertexDeclaration","vertexStrideSize","_cachedEffectForVertexBuffers","attributesCount","getAttributesCount","FLOAT","_bindIndexBufferWithCache","boundBuffer","ul","instancesBuffer","offsetLocation","_deleteBuffer","deleteBuffer","offsetLocations","bindInstancesBuffer","attributesInfo","computeStride","attributeSize","_i","_ai","_currentEffect","getAttributeLocationByName","attributeName","attributeType","divisor","attributeLocation","disableInstanceAttribute","shouldClean","disableAttributeByIndex","disableVertexAttribArray","useTriangles","indexStart","indexCount","instancesCount","drawElementsType","verticesStart","verticesCount","drawArraysType","fillMode","_reportDrawCall","drawMode","_drawMode","indexFormat","UNSIGNED_SHORT","mult","drawElements","drawArrays","TRIANGLES","POINTS","LINES","LINE_LOOP","LINE_STRIP","TRIANGLE_STRIP","TRIANGLE_FAN","_key","getPipelineContext","_deletePipelineContext","webGLPipelineContext","__SPECTOR_rebuildProgram","deleteProgram","defines","baseName","attributesNamesOrOptions","uniformsNamesOrEngine","samplers","fallbacks","onCompiled","onError","indexParameters","vertex","vertexElement","vertexToken","vertexSource","fragment","fragmentElement","fragmentToken","fragmentSource","globalDefines","_getGlobalDefines","fullDefines","compiledEffect","source","shaderVersion","_compileRawShader","_ConcatenateShader","shader","createShader","error","NO_ERROR","tempError","getError","isContextLost","shaderSource","compileShader","getShaderSource","vertexCode","fragmentCode","transformFeedbackVaryings","vertexShader","fragmentShader","_createShaderProgram","_compileShader","code","shaderProcessingContext","engine","isParallelCompiled","shaderProgram","createProgram","attachShader","linkProgram","_finalizePipelineContext","getProgramParameter","LINK_STATUS","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","vertexCompilationError","_log","fragmentCompilationError","getProgramInfoLog","programLinkError","validateProgram","VALIDATE_STATUS","_error","programValidationError","deleteShader","vertexSourceCode","fragmentSourceCode","createAsRaw","rawVertexSourceCode","rawFragmentSourceCode","rebuildRebind","webGLRenderingState","createRawShaderProgram","createShaderProgram","COMPLETION_STATUS_KHR","action","oldHandler","uniformsNames","results","getUniformLocation","attributesNames","getAttribLocation","bindSamplers","onBind","_onBindObservable","uniform","uniform1i","uniform2i","uniform3i","uniform4i","array","uniform1iv","uniform2iv","uniform3iv","uniform4iv","uniform1ui","uniform2ui","uniform3ui","uniform4ui","uniform1uiv","uniform2uiv","uniform3uiv","uniform4uiv","uniform1fv","uniform2fv","uniform3fv","uniform4fv","matrices","uniformMatrix4fv","matrix","uniformMatrix3fv","uniformMatrix2fv","uniform1f","uniform2f","uniform3f","uniform4f","apply","colorMask","bruteForce","_currentProgram","resetTextureCache","reset","UNPACK_PREMULTIPLY_ALPHA_WEBGL","samplingMode","magFilter","minFilter","LINEAR","LINEAR_MIPMAP_NEAREST","LINEAR_MIPMAP_LINEAR","NEAREST_MIPMAP_LINEAR","NEAREST_MIPMAP_NEAREST","mag","createTexture","_createTexture","label","format","useSRGBBuffer","samples","isWebGPU","layers","filters","_getSamplingParameters","TEXTURE_2D_ARRAY","sizedFormat","_getRGBABufferInternalSizedFormat","internalFormat","_getInternalFormat","textureType","_getWebGLTextureType","texImage3D","texImage2D","texParameteri","TEXTURE_MAG_FILTER","TEXTURE_MIN_FILTER","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","_useSRGBBuffer","baseWidth","baseHeight","noMipmap","url","invertY","scene","_this4","onLoad","prepareTexture","prepareTextureProcessFunction","fallback","forcedExtension","mimeType","loaderOptions","fromData","substr","fromBlob","isBase64","substring","originalUrl","_originalUrl","lastDot","lastIndexOf","extension","toLowerCase","loader","split","_step7","_iterator7","_TextureLoaders","availableLoader","canLoad","addPendingData","_getUseSRGBBuffer","_buffer","onLoadObserver","onLoadedObservable","add","onInternalError","message","removePendingData","remove","_createTextureBase","onErrorObservable","callback","loadData","loadMipmap","isCompressed","loadFailed","ArrayBuffer","isView","_loadFile","offlineProvider","request","responseURL","onload","img","decoding","close","_FileToolsLoadImage","imageOrientation","Blob","_this5","_prepareWebGLTexture","potWidth","potHeight","continuationCallback","isPot","RGBA","RGB","texelFormat","UNSIGNED_BYTE","_supportsHardwareTextureRescaling","_prepareWorkingCanvas","drawImage","_rescaleTexture","_releaseTexture","destination","onComplete","UNPACK_FLIP_Y_WEBGL","UNPACK_ALIGNMENT","TEXTURE_CUBE_MAP","is3D","TEXTURE_3D","isMultiview","_getTextureTarget","useMipMaps","_setTextureParameterInteger","wrapU","wrapV","wrapR","_getTextureWrapMode","_cachedWrapU","_cachedWrapV","TEXTURE_WRAP_R","_cachedWrapR","internalTexture","generateStencil","bilinearFiltering","comparisonFunction","_comparisonFunction","samplingParameters","TEXTURE_COMPARE_FUNC","TEXTURE_COMPARE_MODE","COMPARE_REF_TO_TEXTURE","lod","compressedTexImage2D","imageData","babylonInternalFormat","useTextureWidthAndHeight","_unpackFlipY","lodMaxWidth","round","LOG2E","lodMaxHeight","max","xOffset","yOffset","targetForBinding","texSubImage2D","bindTarget","_uploadDataToTextureDirectly","processFunction","_this6","getCaps","needPOTTextures","GetExponentOfTwo","_prepareWebGLTextureContinuation","generateStencilBuffer","generateDepthBuffer","_createRenderBuffer","DEPTH_STENCIL","depthFormat","DEPTH_COMPONENT16","DEPTH_COMPONENT32F","STENCIL_INDEX8","STENCIL_ATTACHMENT","msInternalFormat","unbindBuffer","renderBuffer","createRenderbuffer","_updateRenderBuffer","bindRenderbuffer","RENDERBUFFER","renderbufferStorage","framebufferRenderbuffer","_deleteTexture","unbindAllTextures","_lodTextureHigh","dispose","_lodTextureMid","_lodTextureLow","_irradianceTexture","deleteTexture","useProgram","_setProgram","getSamplers","getUniform","activeTexture","TEXTURE0","forTextureDataUpdate","wasPreviouslyBound","isTextureForRendering","_associatedChannel","_activateCurrentTexture","bindTexture","_bindSamplerUniformToChannel","channel","_setTexture","sourceSlot","_currentState","REPEAT","MIRRORED_REPEAT","isPartOfTextureArray","video","videoInternalTexture","getInternalTexture","update","delayLoadState","delayLoad","emptyCubeTexture","emptyTexture3D","emptyTexture2DArray","emptyTexture","needToBind","_cachedCoordinatesMode","coordinatesMode","textureWrapMode","_setAnisotropicLevel","anisotropicFilteringLevel","textures","_textureUnits","Int32Array","anisotropicFilterExtension","_cachedAnisotropicFilteringLevel","_setTextureParameterFloat","TEXTURE_MAX_ANISOTROPY_EXT","parameter","texParameterf","_i2","stopRenderLoop","deleteFramebuffer","releaseEffects","releaseComputeEffects","removeEventListener","_step8","_iterator8","abort","_canRenderToFramebuffer","successful","fb","createFramebuffer","status","checkFramebufferStatus","FRAMEBUFFER_COMPLETE","readFormat","readType","readPixels","UNSIGNED_SHORT_4_4_4_4","UNSIGNED_SHORT_5_5_5_1","UNSIGNED_SHORT_5_6_5","BYTE","SHORT","HALF_FLOAT","UNSIGNED_INT_2_10_10_10_REV","UNSIGNED_INT_10F_11F_11F_REV","UNSIGNED_INT_5_9_9_9_REV","FLOAT_32_UNSIGNED_INT_24_8_REV","ALPHA","LUMINANCE","LUMINANCE_ALPHA","RED","RG","RED_INTEGER","RG_INTEGER","RGB_INTEGER","RGBA_INTEGER","R8_SNORM","RG8_SNORM","RGB8_SNORM","R8I","RG8I","RGB8I","RGBA8I","RGBA8_SNORM","R8","RG8","RGB8","RGBA8","R8UI","RG8UI","RGB8UI","RGBA8UI","R16I","RG16I","RGB16I","RGBA16I","R16UI","RG16UI","RGB16UI","RGBA16UI","R32I","RG32I","RGB32I","RGBA32I","R32UI","RG32UI","RGB32UI","RGBA32UI","R32F","RG32F","RGB32F","R16F","RG16F","RGB16F","RGB565","R11F_G11F_B10F","RGB9_E5","RGBA4","RGB5_A1","RGB10_A2","RGB10_A2UI","onSuccess","onProgress","useArrayBuffer","_this7","_FileToolsLoadFile","onCompleteObservable","hasAlpha","flushRenderer","numChannels","Promise","resolve","OffscreenCanvas","input","imageBitmapOptions","isSupported","_HasMajorPerformanceCaveat","_IsSupported","tempcanvas","WebGLRenderingContext","failIfMajorPerformanceCaveat","c","CeilingPOT","FloorPOT","pot","NearestPOT","func","_ref2","requestPostAnimationFrame","_requestAnimationFrame","requestAnimationFrame","CollisionsEpsilon"],"sourceRoot":""}